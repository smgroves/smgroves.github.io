<!DOCTYPE html> <html lang="en"> <head><meta http-equiv="refresh" content="3; url=/"/> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Data Science Essentials | Sarah M. Groves</title> <meta name="author" content="Sarah M. Groves"/> <meta name="description" content="Final Project for Data Science Essentials Course"/> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"/> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"/> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="" id="highlight_theme_light"/> <link rel="shortcut icon" href="/assets/img/favicon-32x32.png"/> <link rel="stylesheet" href="/assets/css/main.css"> <link rel="canonical" href="https://smgroves.github.io/projects/data-science-essentials/"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark"/> <script src="/assets/js/theme.js"></script> <script src="/assets/js/dark_mode.js"></script> <title>Data Science Essentials | blank</title> <meta name="generator" content="Jekyll v4.4.1"/> <meta property="og:title" content="Data Science Essentials"/> <meta property="og:locale" content="en"/> <meta name="description" content="Final Project for Data Science Essentials Course"/> <meta property="og:description" content="Final Project for Data Science Essentials Course"/> <link rel="canonical" href="https://smgroves.github.io/projects/data-science-essentials/"/> <meta property="og:url" content="https://smgroves.github.io/projects/data-science-essentials/"/> <meta property="og:site_name" content="blank"/> <meta property="og:type" content="article"/> <meta property="article:published_time" content="2025-04-23T19:45:09+00:00"/> <meta name="twitter:card" content="summary"/> <meta property="twitter:title" content="Data Science Essentials"/> <script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2025-04-23T19:45:09+00:00","datePublished":"2025-04-23T19:45:09+00:00","description":"Final Project for Data Science Essentials Course","headline":"Data Science Essentials","mainEntityOfPage":{"@type":"WebPage","@id":"https://smgroves.github.io/projects/data-science-essentials/"},"url":"https://smgroves.github.io/projects/data-science-essentials/"}</script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"><span class="font-weight-bold">Sarah </span>M. Groves</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about</a> </li> <li class="nav-item "> <a class="nav-link" href="/blog/">scicomm</a> </li> <li class="nav-item "> <a class="nav-link" href="/notebooks/">notebooks</a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications</a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">projects</a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv</a> </li> <li class="nav-item "> <a class="nav-link" href="/courses/">courses</a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fas fa-moon"></i> <i class="fas fa-sun"></i> </button> </li> </ul> </div> </div> </nav> </header> <div class="container mt-5"> <div class="post"> <header class="post-header"> <h1 class="post-title">Data Science Essentials</h1> <p class="post-description">Final Project for Data Science Essentials Course</p> </header> <article> <p><strong>TN Med Helper</strong> is a fictional company whose mission is to ensure access to healthcare for all Tennesseans. TN Med Helper has approached your data science consultancy for help identifying communities in Tennessee that need the most help in expanding access to healthcare.</p> <p>In this project, we will use the <a href="https://data.cms.gov/mapping-medicare-disparities" target="_blank" rel="noopener noreferrer">Medicare Disparities</a> data as a starting point for identifying such communities. Specifically, you will be provided with datasets containing the percent of Medicare beneficiaries who had an annual wellness visit (annual_wellness.csv), the number of all-cause hospitilizations per 1000 beneficiaries (hospitalizations.csv), and the number of emergency department visits per 1000 beneficiaries (emergency_department.csv). Over the next 8 weeks, you will work towards addressing the following three objectives.</p> <p>First, TN Med Helper is concerned about communities either lacking access to healthcare or losing access to healthcare. They are looking to expand telehealth technologies into the vulnerable communities, and need your help to priortize areas most needing attention. your first objective is to identify which counties in Tennessee have the most severe lack of access to healthcare (either due to lack of hospitals, physicians, or both). Once you have identified these counties, see if you can find any common demographic or economic characteristics for these areas.</p> <p>Second, TN Med Helper is interested in reducing the number of potentially preventable hospitalizations. Do areas that lack access to healthcare tend to have higher rates of emergency department visits or hospitalizations? Is there an association between the percentage of beneficiaries who had an annual wellness visit and rate of hospitalizations or emergency department visits?</p> <p>Finally, TN Med Helper is trying to identify specific subpopulations to focus more attention on. Using data from <a href="https://www.cdc.gov/brfss/index.html" target="_blank" rel="noopener noreferrer">the Behavioral Risk Factor Surveillance System</a>, build a model to predict whether an individual has not had a checkup in the last year. Apply this model to the counties you identified above to predict how likely it is that the average person from those counties has not had a checkup in the last year. Which groups within these counties might need to be focused on to maximize the impact of TN Med Helper’s efforts?</p> <p>Over the course of this class, you will build up your data analysis skills and work towards answering these questions. At the end of the project, teams will present their findings to <strong>TN Med Helper</strong>.</p> <h3 id="looking-at-the-data">Looking at the data</h3> <ul> <li>Annual wellness visits is a percentage (of beneficiaries).</li> <li>Emergency department visits is a number per 1000 beneficiaries.</li> <li>All-cause hospitalizations is number per 1000 beneficiaries.</li> </ul> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="kn">import</span> <span class="n">geopandas</span> <span class="k">as</span> <span class="n">gpd</span>
<span class="kn">import</span> <span class="n">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">import</span> <span class="n">seaborn</span> <span class="k">as</span> <span class="n">sns</span>
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">hospitalizations</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nf">read_csv</span><span class="p">(</span><span class="sh">"</span><span class="s">../data/Medicare_Disparities_by_Population/hospitalizations.csv</span><span class="sh">"</span><span class="p">)</span>
<span class="n">hospitalizations</span><span class="p">.</span><span class="nf">info</span><span class="p">()</span>
</code></pre></div></div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 3222 entries, 0 to 3221
Data columns (total 18 columns):
 #   Column               Non-Null Count  Dtype 
---  ------               --------------  ----- 
 0   year                 3222 non-null   int64 
 1   geography            3222 non-null   object
 2   measure              3222 non-null   object
 3   adjustment           3222 non-null   object
 4   analysis             3222 non-null   object
 5   domain               3222 non-null   object
 6   condition            3222 non-null   object
 7   primary_sex          3222 non-null   object
 8   primary_age          3222 non-null   object
 9   primary_dual         3222 non-null   object
 10  fips                 3222 non-null   int64 
 11  county               3205 non-null   object
 12  state                3222 non-null   object
 13  urban                3222 non-null   object
 14  primary_race         3222 non-null   object
 15  primary_eligibility  3222 non-null   object
 16  primary_denominator  3222 non-null   object
 17  analysis_value       3222 non-null   int64 
dtypes: int64(3), object(15)
memory usage: 453.2+ KB
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">annual_wellness</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nf">read_csv</span><span class="p">(</span><span class="sh">"</span><span class="s">../data/Medicare_Disparities_by_Population/annual_wellness.csv</span><span class="sh">"</span><span class="p">)</span>
<span class="n">annual_wellness</span><span class="p">.</span><span class="nf">info</span><span class="p">()</span>
</code></pre></div></div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 3220 entries, 0 to 3219
Data columns (total 18 columns):
 #   Column               Non-Null Count  Dtype 
---  ------               --------------  ----- 
 0   year                 3220 non-null   int64 
 1   geography            3220 non-null   object
 2   measure              3220 non-null   object
 3   adjustment           3220 non-null   object
 4   analysis             3220 non-null   object
 5   domain               3220 non-null   object
 6   condition            3220 non-null   object
 7   primary_sex          3220 non-null   object
 8   primary_age          3220 non-null   object
 9   primary_dual         3220 non-null   object
 10  fips                 3220 non-null   int64 
 11  county               3205 non-null   object
 12  state                3220 non-null   object
 13  urban                3220 non-null   object
 14  primary_race         3220 non-null   object
 15  primary_eligibility  3220 non-null   object
 16  primary_denominator  3220 non-null   object
 17  analysis_value       3220 non-null   int64 
dtypes: int64(3), object(15)
memory usage: 452.9+ KB
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">emergency_department</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nf">read_csv</span><span class="p">(</span><span class="sh">"</span><span class="s">../data/Medicare_Disparities_by_Population/emergency_department.csv</span><span class="sh">"</span><span class="p">)</span>
<span class="n">emergency_department</span><span class="p">.</span><span class="nf">info</span><span class="p">()</span>
</code></pre></div></div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 3220 entries, 0 to 3219
Data columns (total 18 columns):
 #   Column               Non-Null Count  Dtype 
---  ------               --------------  ----- 
 0   year                 3220 non-null   int64 
 1   geography            3220 non-null   object
 2   measure              3220 non-null   object
 3   adjustment           3220 non-null   object
 4   analysis             3220 non-null   object
 5   domain               3220 non-null   object
 6   condition            3220 non-null   object
 7   primary_sex          3220 non-null   object
 8   primary_age          3220 non-null   object
 9   primary_dual         3220 non-null   object
 10  fips                 3220 non-null   int64 
 11  county               3205 non-null   object
 12  state                3220 non-null   object
 13  urban                3220 non-null   object
 14  primary_race         3220 non-null   object
 15  primary_eligibility  3220 non-null   object
 16  primary_denominator  3220 non-null   object
 17  analysis_value       3220 non-null   int64 
dtypes: int64(3), object(15)
memory usage: 452.9+ KB
</code></pre></div></div> <p>All three data structures are the same, with the same column names (unfortunately). I will merge them, and rename the columns that I want to keep from each.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">emergency_department</span><span class="p">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">hospitalizations</span><span class="p">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</code></pre></div></div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>year                    True
geography               True
measure                False
adjustment              True
analysis                True
domain                  True
condition              False
primary_sex             True
primary_age             True
primary_dual            True
fips                    True
county                  True
state                   True
urban                   True
primary_race            True
primary_eligibility     True
primary_denominator    False
analysis_value         False
Name: 1, dtype: bool
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">emer_dict</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">emergency_department</span><span class="p">:</span>
    <span class="n">emer_dict</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nf">set</span><span class="p">(</span><span class="n">emergency_department</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">emer_dict</span><span class="p">[</span><span class="sh">'</span><span class="s">fips</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">emer_dict</span><span class="p">[</span><span class="sh">'</span><span class="s">county</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">emer_dict</span><span class="p">[</span><span class="sh">'</span><span class="s">state</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">emer_dict</span><span class="p">[</span><span class="sh">'</span><span class="s">analysis_value</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">emer_dict</span>
</code></pre></div></div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{'year': {2019},
 'geography': {'County'},
 'measure': {'Emergency department visit rate'},
 'adjustment': {'Unsmoothed actual'},
 'analysis': {'Base measure'},
 'domain': {'Primary chronic conditions'},
 'condition': {'All Emergency Department Visits'},
 'primary_sex': {'All'},
 'primary_age': {'All'},
 'primary_dual': {'Dual &amp; non-dual'},
 'fips': [],
 'county': [],
 'state': [],
 'urban': {'Rural', 'Urban'},
 'primary_race': {'All'},
 'primary_eligibility': {'All'},
 'primary_denominator': {'undefined'},
 'analysis_value': []}
</code></pre></div></div> <p>The comparison above shows which columns are unique to each dataframe: measure, condition, primary_denominator, and analysis_value. All other columns except urban only have one value.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">hospitalizations</span> <span class="o">=</span> <span class="n">hospitalizations</span><span class="p">[[</span><span class="sh">'</span><span class="s">fips</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">measure</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">primary_denominator</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">analysis_value</span><span class="sh">'</span><span class="p">]]</span>
<span class="n">emergency_department</span> <span class="o">=</span> <span class="n">emergency_department</span><span class="p">[[</span><span class="sh">'</span><span class="s">fips</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">measure</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">primary_denominator</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">analysis_value</span><span class="sh">'</span><span class="p">]]</span>
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">hospitalizations</span><span class="p">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="sh">'</span><span class="s">fips</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">measure_hosp</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">primary_denominator_hosp</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">analysis_value_hosp</span><span class="sh">'</span><span class="p">]</span>
<span class="n">emergency_department</span><span class="p">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="sh">'</span><span class="s">fips</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">measure_emer</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">primary_denominator_emer</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">analysis_value_emer</span><span class="sh">'</span><span class="p">]</span>

</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">annual_wellness</span><span class="p">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">annual_wellness</span><span class="p">.</span><span class="n">columns</span><span class="p">.</span><span class="nb">str</span><span class="p">.</span><span class="nf">replace</span><span class="p">(</span><span class="sh">"</span><span class="s">analysis_value</span><span class="sh">"</span><span class="p">,</span><span class="sh">"</span><span class="s">analysis_value_well</span><span class="sh">"</span><span class="p">)</span>
<span class="n">annual_wellness</span><span class="p">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">annual_wellness</span><span class="p">.</span><span class="n">columns</span><span class="p">.</span><span class="nb">str</span><span class="p">.</span><span class="nf">replace</span><span class="p">(</span><span class="sh">"</span><span class="s">measure</span><span class="sh">"</span><span class="p">,</span><span class="sh">"</span><span class="s">measure_well</span><span class="sh">"</span><span class="p">)</span>
<span class="n">annual_wellness</span><span class="p">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">annual_wellness</span><span class="p">.</span><span class="n">columns</span><span class="p">.</span><span class="nb">str</span><span class="p">.</span><span class="nf">replace</span><span class="p">(</span><span class="sh">"</span><span class="s">primary_denominator</span><span class="sh">"</span><span class="p">,</span><span class="sh">"</span><span class="s">primary_denominator_well</span><span class="sh">"</span><span class="p">)</span>
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">disparities</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nf">merge</span><span class="p">(</span><span class="n">left</span> <span class="o">=</span> <span class="n">annual_wellness</span><span class="p">,</span> <span class="n">left_on</span> <span class="o">=</span> <span class="sh">'</span><span class="s">fips</span><span class="sh">'</span><span class="p">,</span>
         <span class="n">right</span> <span class="o">=</span> <span class="n">hospitalizations</span><span class="p">,</span> <span class="n">right_on</span> <span class="o">=</span> <span class="sh">'</span><span class="s">fips</span><span class="sh">'</span><span class="p">)</span>
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">disparities</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nf">merge</span><span class="p">(</span><span class="n">left</span> <span class="o">=</span> <span class="n">disparities</span><span class="p">,</span> <span class="n">left_on</span> <span class="o">=</span> <span class="sh">'</span><span class="s">fips</span><span class="sh">'</span><span class="p">,</span>
         <span class="n">right</span> <span class="o">=</span> <span class="n">emergency_department</span><span class="p">,</span> <span class="n">right_on</span> <span class="o">=</span> <span class="sh">'</span><span class="s">fips</span><span class="sh">'</span><span class="p">)</span>
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">disparities</span><span class="p">.</span><span class="nf">info</span><span class="p">()</span>
</code></pre></div></div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
Int64Index: 3220 entries, 0 to 3219
Data columns (total 24 columns):
 #   Column                    Non-Null Count  Dtype 
---  ------                    --------------  ----- 
 0   year                      3220 non-null   int64 
 1   geography                 3220 non-null   object
 2   measure_well              3220 non-null   object
 3   adjustment                3220 non-null   object
 4   analysis                  3220 non-null   object
 5   domain                    3220 non-null   object
 6   condition                 3220 non-null   object
 7   primary_sex               3220 non-null   object
 8   primary_age               3220 non-null   object
 9   primary_dual              3220 non-null   object
 10  fips                      3220 non-null   int64 
 11  county                    3205 non-null   object
 12  state                     3220 non-null   object
 13  urban                     3220 non-null   object
 14  primary_race              3220 non-null   object
 15  primary_eligibility       3220 non-null   object
 16  primary_denominator_well  3220 non-null   object
 17  analysis_value_well       3220 non-null   int64 
 18  measure_hosp              3220 non-null   object
 19  primary_denominator_hosp  3220 non-null   object
 20  analysis_value_hosp       3220 non-null   int64 
 21  measure_emer              3220 non-null   object
 22  primary_denominator_emer  3220 non-null   object
 23  analysis_value_emer       3220 non-null   int64 
dtypes: int64(5), object(19)
memory usage: 628.9+ KB
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">print</span><span class="p">(</span><span class="nf">set</span><span class="p">(</span><span class="n">disparities</span><span class="p">.</span><span class="n">adjustment</span><span class="p">),</span><span class="nf">set</span><span class="p">(</span><span class="n">disparities</span><span class="p">.</span><span class="n">analysis</span><span class="p">),</span><span class="nf">set</span><span class="p">(</span><span class="n">disparities</span><span class="p">.</span><span class="n">domain</span><span class="p">),</span><span class="nf">set</span><span class="p">(</span><span class="n">disparities</span><span class="p">.</span><span class="n">condition</span><span class="p">))</span>
</code></pre></div></div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{'Unsmoothed actual'} {'Base measure'} {'Preventive Services'} {'Annual Wellness Visit'}
</code></pre></div></div> <p>Each of the columns above only has one value, so I am going to remove them.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">disparities</span> <span class="o">=</span> <span class="n">disparities</span><span class="p">.</span><span class="nf">drop</span><span class="p">([</span><span class="sh">'</span><span class="s">adjustment</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">analysis</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">domain</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">condition</span><span class="sh">'</span><span class="p">],</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">disparities</span><span class="p">.</span><span class="nf">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</code></pre></div></div> <div> <style scoped="">.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</style> <table border="1" class="dataframe"> <thead> <tr style="text-align: right;"> <th></th> <th>year</th> <th>geography</th> <th>measure_well</th> <th>primary_sex</th> <th>primary_age</th> <th>primary_dual</th> <th>fips</th> <th>county</th> <th>state</th> <th>urban</th> <th>primary_race</th> <th>primary_eligibility</th> <th>primary_denominator_well</th> <th>analysis_value_well</th> <th>measure_hosp</th> <th>primary_denominator_hosp</th> <th>analysis_value_hosp</th> <th>measure_emer</th> <th>primary_denominator_emer</th> <th>analysis_value_emer</th> </tr> </thead> <tbody> <tr> <th>0</th> <td>2019</td> <td>County</td> <td>Preventive Services</td> <td>All</td> <td>All</td> <td>Dual &amp; non-dual</td> <td>1001</td> <td>Autauga County</td> <td>ALABAMA</td> <td>Urban</td> <td>All</td> <td>All</td> <td>1,000-4,999</td> <td>29</td> <td>Hospitalization</td> <td>5,000-9,999</td> <td>299</td> <td>Emergency department visit rate</td> <td>undefined</td> <td>723</td> </tr> <tr> <th>1</th> <td>2019</td> <td>County</td> <td>Preventive Services</td> <td>All</td> <td>All</td> <td>Dual &amp; non-dual</td> <td>1003</td> <td>Baldwin County</td> <td>ALABAMA</td> <td>Rural</td> <td>All</td> <td>All</td> <td>10,000+</td> <td>29</td> <td>Hospitalization</td> <td>10,000+</td> <td>268</td> <td>Emergency department visit rate</td> <td>undefined</td> <td>601</td> </tr> </tbody> </table> </div> <p>Lastly, I will narrow down the list to only counties in TN.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">disparities</span> <span class="o">=</span> <span class="n">disparities</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">disparities</span><span class="p">.</span><span class="n">state</span> <span class="o">==</span> <span class="sh">'</span><span class="s">TENNESSEE</span><span class="sh">'</span><span class="p">]</span>
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">disparities</span><span class="p">.</span><span class="nf">info</span><span class="p">()</span>
</code></pre></div></div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
Int64Index: 95 entries, 2428 to 2522
Data columns (total 20 columns):
 #   Column                    Non-Null Count  Dtype 
---  ------                    --------------  ----- 
 0   year                      95 non-null     int64 
 1   geography                 95 non-null     object
 2   measure_well              95 non-null     object
 3   primary_sex               95 non-null     object
 4   primary_age               95 non-null     object
 5   primary_dual              95 non-null     object
 6   fips                      95 non-null     int64 
 7   county                    95 non-null     object
 8   state                     95 non-null     object
 9   urban                     95 non-null     object
 10  primary_race              95 non-null     object
 11  primary_eligibility       95 non-null     object
 12  primary_denominator_well  95 non-null     object
 13  analysis_value_well       95 non-null     int64 
 14  measure_hosp              95 non-null     object
 15  primary_denominator_hosp  95 non-null     object
 16  analysis_value_hosp       95 non-null     int64 
 17  measure_emer              95 non-null     object
 18  primary_denominator_emer  95 non-null     object
 19  analysis_value_emer       95 non-null     int64 
dtypes: int64(5), object(15)
memory usage: 15.6+ KB
</code></pre></div></div> <p>As before, we have all 95 counties in TN.</p> <h2 id="question-1-identify-which-counties-in-tn-have-the-most-severe-lack-of-access-to-healthcare">Question 1: Identify which counties in TN have the most severe lack of access to healthcare.</h2> <h3 id="which-counties-have-low-numbers-of-physicians">Which counties have low numbers of physicians?</h3> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">physicians</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nf">read_csv</span><span class="p">(</span><span class="sh">'</span><span class="s">../data/primary_care_physicians.csv</span><span class="sh">'</span><span class="p">)</span>
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">physicians</span> <span class="o">=</span> <span class="n">physicians</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">physicians</span><span class="p">.</span><span class="n">state</span> <span class="o">==</span> <span class="sh">'</span><span class="s">Tennessee</span><span class="sh">'</span><span class="p">]</span>
<span class="n">physicians</span><span class="p">.</span><span class="n">shape</span>
</code></pre></div></div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(95, 4)
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">population</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nf">read_csv</span><span class="p">(</span><span class="sh">'</span><span class="s">../data/population_by_county.csv</span><span class="sh">'</span><span class="p">)</span>
<span class="n">population</span><span class="p">.</span><span class="nf">head</span><span class="p">()</span>
</code></pre></div></div> <div> <style scoped="">.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</style> <table border="1" class="dataframe"> <thead> <tr style="text-align: right;"> <th></th> <th>FIPS</th> <th>population</th> <th>county</th> <th>state</th> <th>urban</th> </tr> </thead> <tbody> <tr> <th>0</th> <td>17051</td> <td>21565</td> <td>Fayette County</td> <td>ILLINOIS</td> <td>Rural</td> </tr> <tr> <th>1</th> <td>17107</td> <td>29003</td> <td>Logan County</td> <td>ILLINOIS</td> <td>Rural</td> </tr> <tr> <th>2</th> <td>17165</td> <td>23994</td> <td>Saline County</td> <td>ILLINOIS</td> <td>Rural</td> </tr> <tr> <th>3</th> <td>17097</td> <td>701473</td> <td>Lake County</td> <td>ILLINOIS</td> <td>Urban</td> </tr> <tr> <th>4</th> <td>17127</td> <td>14219</td> <td>Massac County</td> <td>ILLINOIS</td> <td>Rural</td> </tr> </tbody> </table> </div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">physicians</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nf">merge</span><span class="p">(</span><span class="n">left</span> <span class="o">=</span> <span class="n">physicians</span><span class="p">,</span> <span class="n">right</span> <span class="o">=</span> <span class="n">population</span><span class="p">[[</span><span class="sh">'</span><span class="s">FIPS</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">population</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">urban</span><span class="sh">'</span><span class="p">]],</span> <span class="n">left_on</span><span class="o">=</span><span class="sh">'</span><span class="s">FIPS</span><span class="sh">'</span><span class="p">,</span> <span class="n">right_on</span> <span class="o">=</span> <span class="sh">'</span><span class="s">FIPS</span><span class="sh">'</span><span class="p">)</span>
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">physicians</span><span class="p">[</span><span class="sh">'</span><span class="s">urban</span><span class="sh">'</span><span class="p">].</span><span class="nf">value_counts</span><span class="p">()</span>
</code></pre></div></div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Rural    57
Urban    38
Name: urban, dtype: int64
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">physicians</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">physicians</span><span class="p">.</span><span class="n">population</span><span class="o">/</span><span class="n">physicians</span><span class="p">.</span><span class="n">primary_care_physicians</span> <span class="o">&lt;</span> <span class="mi">1500</span><span class="p">,</span><span class="sh">'</span><span class="s">supply</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="sh">'</span><span class="s">adequate</span><span class="sh">'</span>
<span class="n">physicians</span><span class="p">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">physicians</span><span class="p">.</span><span class="n">population</span><span class="o">/</span><span class="n">physicians</span><span class="p">.</span><span class="n">primary_care_physicians</span> <span class="o">&gt;</span> <span class="mi">1500</span><span class="p">)</span> <span class="o">&amp;</span>
               <span class="p">(</span><span class="n">physicians</span><span class="p">.</span><span class="n">population</span><span class="o">/</span><span class="n">physicians</span><span class="p">.</span><span class="n">primary_care_physicians</span> <span class="o">&lt;</span> <span class="mi">3500</span><span class="p">),</span><span class="sh">'</span><span class="s">supply</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="sh">'</span><span class="s">moderately adequate</span><span class="sh">'</span>
<span class="n">physicians</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">physicians</span><span class="p">.</span><span class="n">population</span><span class="o">/</span><span class="n">physicians</span><span class="p">.</span><span class="n">primary_care_physicians</span> <span class="o">&gt;</span> <span class="mi">3500</span><span class="p">,</span><span class="sh">'</span><span class="s">supply</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="sh">'</span><span class="s">low inadequate</span><span class="sh">'</span>
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">physicians</span> <span class="o">=</span> <span class="n">physicians</span><span class="p">.</span><span class="nf">rename</span><span class="p">({</span><span class="sh">'</span><span class="s">supply</span><span class="sh">'</span><span class="p">:</span><span class="sh">'</span><span class="s">shadac_category</span><span class="sh">'</span><span class="p">},</span> <span class="n">axis</span> <span class="o">=</span> <span class="sh">'</span><span class="s">columns</span><span class="sh">'</span><span class="p">)</span>
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="n">pd</span><span class="p">.</span><span class="nf">crosstab</span><span class="p">(</span><span class="n">physicians</span><span class="p">.</span><span class="n">urban</span><span class="p">,</span> <span class="n">physicians</span><span class="p">.</span><span class="n">shadac_category</span><span class="p">,</span> <span class="n">normalize</span><span class="o">=</span><span class="sh">'</span><span class="s">index</span><span class="sh">'</span><span class="p">).</span><span class="nf">plot</span><span class="p">(</span><span class="n">kind</span> <span class="o">=</span> <span class="sh">'</span><span class="s">bar</span><span class="sh">'</span><span class="p">,</span> <span class="n">stacked</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">xticks</span><span class="p">(</span><span class="n">rotation</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">legend</span><span class="p">(</span><span class="n">bbox_to_anchor</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">),</span> <span class="n">loc</span> <span class="o">=</span> <span class="sh">'</span><span class="s">upper left</span><span class="sh">'</span><span class="p">);</span>   <span class="c1"># move the legend to the right side of the plot
</span><span class="n">plt</span><span class="p">.</span><span class="nf">title</span><span class="p">(</span><span class="sh">"</span><span class="s">SHADAC Category by Type of County</span><span class="sh">"</span><span class="p">)</span>
</code></pre></div></div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Text(0.5, 1.0, 'SHADAC Category by Type of County')
</code></pre></div></div> <div class="img"> <img src="/assets/img/bb/data-science-project/output_33_1.png" style="height: 100%; width: 100%; object-fit: contain"> </div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">physicians</span>
</code></pre></div></div> <div> <style scoped="">.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</style> <table border="1" class="dataframe"> <thead> <tr style="text-align: right;"> <th></th> <th>FIPS</th> <th>state</th> <th>county</th> <th>primary_care_physicians</th> <th>population</th> <th>urban</th> <th>shadac_category</th> </tr> </thead> <tbody> <tr> <th>0</th> <td>47001</td> <td>Tennessee</td> <td>Anderson</td> <td>39.0</td> <td>76061</td> <td>Urban</td> <td>moderately adequate</td> </tr> <tr> <th>1</th> <td>47003</td> <td>Tennessee</td> <td>Bedford</td> <td>15.0</td> <td>48292</td> <td>Rural</td> <td>moderately adequate</td> </tr> <tr> <th>2</th> <td>47005</td> <td>Tennessee</td> <td>Benton</td> <td>3.0</td> <td>16140</td> <td>Rural</td> <td>low inadequate</td> </tr> <tr> <th>3</th> <td>47007</td> <td>Tennessee</td> <td>Bledsoe</td> <td>1.0</td> <td>14836</td> <td>Rural</td> <td>low inadequate</td> </tr> <tr> <th>4</th> <td>47009</td> <td>Tennessee</td> <td>Blount</td> <td>90.0</td> <td>129927</td> <td>Urban</td> <td>adequate</td> </tr> <tr> <th>...</th> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> </tr> <tr> <th>90</th> <td>47181</td> <td>Tennessee</td> <td>Wayne</td> <td>5.0</td> <td>16693</td> <td>Rural</td> <td>moderately adequate</td> </tr> <tr> <th>91</th> <td>47183</td> <td>Tennessee</td> <td>Weakley</td> <td>18.0</td> <td>33510</td> <td>Rural</td> <td>moderately adequate</td> </tr> <tr> <th>92</th> <td>47185</td> <td>Tennessee</td> <td>White</td> <td>9.0</td> <td>26800</td> <td>Rural</td> <td>moderately adequate</td> </tr> <tr> <th>93</th> <td>47187</td> <td>Tennessee</td> <td>Williamson</td> <td>338.0</td> <td>225389</td> <td>Urban</td> <td>adequate</td> </tr> <tr> <th>94</th> <td>47189</td> <td>Tennessee</td> <td>Wilson</td> <td>43.0</td> <td>136666</td> <td>Urban</td> <td>moderately adequate</td> </tr> </tbody> </table> <p>95 rows × 7 columns</p> </div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">unemployment</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nf">read_csv</span><span class="p">(</span><span class="sh">'</span><span class="s">../data/tn_unemployment.csv</span><span class="sh">'</span><span class="p">)</span>
<span class="n">unemployment</span><span class="p">.</span><span class="nf">head</span><span class="p">()</span>
</code></pre></div></div> <div> <style scoped="">.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</style> <table border="1" class="dataframe"> <thead> <tr style="text-align: right;"> <th></th> <th>laus_code</th> <th>State</th> <th>County</th> <th>Name</th> <th>Period</th> <th>LF</th> <th>Employed</th> <th>Unemployed</th> <th>unemployment_rate</th> </tr> </thead> <tbody> <tr> <th>0</th> <td>CN4700100000000</td> <td>47</td> <td>1</td> <td>Anderson County, TN</td> <td>Mar-21</td> <td>34704</td> <td>33010</td> <td>1694</td> <td>4.9</td> </tr> <tr> <th>1</th> <td>CN4700300000000</td> <td>47</td> <td>3</td> <td>Bedford County, TN</td> <td>Mar-21</td> <td>20623</td> <td>19550</td> <td>1073</td> <td>5.2</td> </tr> <tr> <th>2</th> <td>CN4700500000000</td> <td>47</td> <td>5</td> <td>Benton County, TN</td> <td>Mar-21</td> <td>6723</td> <td>6305</td> <td>418</td> <td>6.2</td> </tr> <tr> <th>3</th> <td>CN4700700000000</td> <td>47</td> <td>7</td> <td>Bledsoe County, TN</td> <td>Mar-21</td> <td>4252</td> <td>3947</td> <td>305</td> <td>7.2</td> </tr> <tr> <th>4</th> <td>CN4700900000000</td> <td>47</td> <td>9</td> <td>Blount County, TN</td> <td>Mar-21</td> <td>64098</td> <td>61119</td> <td>2979</td> <td>4.6</td> </tr> </tbody> </table> </div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">unemployment</span><span class="p">.</span><span class="n">Name</span> <span class="o">=</span> <span class="n">unemployment</span><span class="p">.</span><span class="n">Name</span><span class="p">.</span><span class="nb">str</span><span class="p">.</span><span class="nf">split</span><span class="p">(</span><span class="sh">'</span><span class="s"> County, TN</span><span class="sh">'</span><span class="p">,</span> <span class="n">expand</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">physicians</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nf">merge</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="n">unemployment</span><span class="p">[[</span><span class="sh">'</span><span class="s">laus_code</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">Name</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">Employed</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">Unemployed</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">unemployment_rate</span><span class="sh">'</span><span class="p">]],</span> <span class="n">left_on</span><span class="o">=</span><span class="sh">'</span><span class="s">Name</span><span class="sh">'</span><span class="p">,</span>
        <span class="n">right</span> <span class="o">=</span> <span class="n">physicians</span><span class="p">[[</span><span class="sh">'</span><span class="s">FIPS</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">county</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">primary_care_physicians</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">population</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">urban</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">shadac_category</span><span class="sh">'</span><span class="p">]],</span> <span class="n">right_on</span><span class="o">=</span><span class="sh">'</span><span class="s">county</span><span class="sh">'</span><span class="p">)</span>
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">physicians</span>
</code></pre></div></div> <div> <style scoped="">.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</style> <table border="1" class="dataframe"> <thead> <tr style="text-align: right;"> <th></th> <th>laus_code</th> <th>Name</th> <th>Employed</th> <th>Unemployed</th> <th>unemployment_rate</th> <th>FIPS</th> <th>county</th> <th>primary_care_physicians</th> <th>population</th> <th>urban</th> <th>shadac_category</th> </tr> </thead> <tbody> <tr> <th>0</th> <td>CN4700100000000</td> <td>Anderson</td> <td>33010</td> <td>1694</td> <td>4.9</td> <td>47001</td> <td>Anderson</td> <td>39.0</td> <td>76061</td> <td>Urban</td> <td>moderately adequate</td> </tr> <tr> <th>1</th> <td>CN4700300000000</td> <td>Bedford</td> <td>19550</td> <td>1073</td> <td>5.2</td> <td>47003</td> <td>Bedford</td> <td>15.0</td> <td>48292</td> <td>Rural</td> <td>moderately adequate</td> </tr> <tr> <th>2</th> <td>CN4700500000000</td> <td>Benton</td> <td>6305</td> <td>418</td> <td>6.2</td> <td>47005</td> <td>Benton</td> <td>3.0</td> <td>16140</td> <td>Rural</td> <td>low inadequate</td> </tr> <tr> <th>3</th> <td>CN4700700000000</td> <td>Bledsoe</td> <td>3947</td> <td>305</td> <td>7.2</td> <td>47007</td> <td>Bledsoe</td> <td>1.0</td> <td>14836</td> <td>Rural</td> <td>low inadequate</td> </tr> <tr> <th>4</th> <td>CN4700900000000</td> <td>Blount</td> <td>61119</td> <td>2979</td> <td>4.6</td> <td>47009</td> <td>Blount</td> <td>90.0</td> <td>129927</td> <td>Urban</td> <td>adequate</td> </tr> <tr> <th>...</th> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> </tr> <tr> <th>90</th> <td>CN4718100000000</td> <td>Wayne</td> <td>6074</td> <td>342</td> <td>5.3</td> <td>47181</td> <td>Wayne</td> <td>5.0</td> <td>16693</td> <td>Rural</td> <td>moderately adequate</td> </tr> <tr> <th>91</th> <td>CN4718300000000</td> <td>Weakley</td> <td>14783</td> <td>711</td> <td>4.6</td> <td>47183</td> <td>Weakley</td> <td>18.0</td> <td>33510</td> <td>Rural</td> <td>moderately adequate</td> </tr> <tr> <th>92</th> <td>CN4718500000000</td> <td>White</td> <td>11484</td> <td>601</td> <td>5.0</td> <td>47185</td> <td>White</td> <td>9.0</td> <td>26800</td> <td>Rural</td> <td>moderately adequate</td> </tr> <tr> <th>93</th> <td>CN4718700000000</td> <td>Williamson</td> <td>125213</td> <td>4271</td> <td>3.3</td> <td>47187</td> <td>Williamson</td> <td>338.0</td> <td>225389</td> <td>Urban</td> <td>adequate</td> </tr> <tr> <th>94</th> <td>CN4718900000000</td> <td>Wilson</td> <td>74347</td> <td>3079</td> <td>4.0</td> <td>47189</td> <td>Wilson</td> <td>43.0</td> <td>136666</td> <td>Urban</td> <td>moderately adequate</td> </tr> </tbody> </table> <p>95 rows × 11 columns</p> </div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">seaborn</span> <span class="k">as</span> <span class="n">sns</span>
<span class="n">sns</span><span class="p">.</span><span class="nf">boxplot</span><span class="p">(</span><span class="n">physicians</span><span class="p">.</span><span class="n">urban</span><span class="p">,</span><span class="n">physicians</span><span class="p">.</span><span class="n">unemployment_rate</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">xticks</span><span class="p">(</span><span class="n">rotation</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">title</span><span class="p">(</span><span class="sh">"</span><span class="s">Unemployment by Type of County</span><span class="sh">"</span><span class="p">)</span>
</code></pre></div></div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/Users/smgroves/Documents/anaconda3/envs/geo_dse/lib/python3.9/site-packages/seaborn/_decorators.py:36: FutureWarning: Pass the following variables as keyword args: x, y. From version 0.12, the only valid positional argument will be `data`, and passing other arguments without an explicit keyword will result in an error or misinterpretation.
  warnings.warn(





Text(0.5, 1.0, 'Unemployment by Type of County')
</code></pre></div></div> <div class="img"> <img src="/assets/img/bb/data-science-project/output_39_2.png" style="height: 100%; width: 100%; object-fit: contain"> </div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">physicians</span><span class="p">[</span><span class="sh">'</span><span class="s">pcp_per_100k</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">physicians</span><span class="p">.</span><span class="n">primary_care_physicians</span><span class="o">/</span><span class="n">physicians</span><span class="p">.</span><span class="n">population</span><span class="o">*</span><span class="mi">100000</span>
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sns</span><span class="p">.</span><span class="nf">lmplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">physicians</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="sh">'</span><span class="s">pcp_per_100k</span><span class="sh">'</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="sh">'</span><span class="s">unemployment_rate</span><span class="sh">'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">ylabel</span> <span class="o">=</span> <span class="sh">"</span><span class="s">PCP per 100k residents</span><span class="sh">"</span>
<span class="n">plt</span><span class="p">.</span><span class="n">xlabel</span> <span class="o">=</span> <span class="sh">"</span><span class="s">Unemployment Rate</span><span class="sh">"</span>
</code></pre></div></div> <div class="img"> <img src="/assets/img/bb/data-science-project/output_41_0.png" style="height: 100%; width: 100%; object-fit: contain"> </div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">physicians</span><span class="p">[[</span><span class="sh">'</span><span class="s">unemployment_rate</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">pcp_per_100k</span><span class="sh">'</span><span class="p">]].</span><span class="nf">corr</span><span class="p">()</span>
</code></pre></div></div> <div> <style scoped="">.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</style> <table border="1" class="dataframe"> <thead> <tr style="text-align: right;"> <th></th> <th>unemployment_rate</th> <th>pcp_per_100k</th> </tr> </thead> <tbody> <tr> <th>unemployment_rate</th> <td>1.000000</td> <td>-0.335333</td> </tr> <tr> <th>pcp_per_100k</th> <td>-0.335333</td> <td>1.000000</td> </tr> </tbody> </table> </div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">disparities</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nf">merge</span><span class="p">(</span><span class="n">left</span> <span class="o">=</span> <span class="n">disparities</span><span class="p">,</span> <span class="n">left_on</span> <span class="o">=</span> <span class="sh">'</span><span class="s">fips</span><span class="sh">'</span><span class="p">,</span>
         <span class="n">right</span> <span class="o">=</span> <span class="n">physicians</span><span class="p">,</span> <span class="n">right_on</span> <span class="o">=</span> <span class="sh">'</span><span class="s">FIPS</span><span class="sh">'</span><span class="p">)</span>
</code></pre></div></div> <p>Now get rid of repetitive columns:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">disparities</span><span class="p">.</span><span class="nf">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</code></pre></div></div> <div> <style scoped="">.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</style> <table border="1" class="dataframe"> <thead> <tr style="text-align: right;"> <th></th> <th>year</th> <th>geography</th> <th>measure_well</th> <th>primary_sex</th> <th>primary_age</th> <th>primary_dual</th> <th>fips</th> <th>county_x</th> <th>state</th> <th>urban_x</th> <th>...</th> <th>Employed</th> <th>Unemployed</th> <th>unemployment_rate</th> <th>FIPS</th> <th>county_y</th> <th>primary_care_physicians</th> <th>population</th> <th>urban_y</th> <th>shadac_category</th> <th>pcp_per_100k</th> </tr> </thead> <tbody> <tr> <th>0</th> <td>2019</td> <td>County</td> <td>Preventive Services</td> <td>All</td> <td>All</td> <td>Dual &amp; non-dual</td> <td>47001</td> <td>Anderson County</td> <td>TENNESSEE</td> <td>Urban</td> <td>...</td> <td>33010</td> <td>1694</td> <td>4.9</td> <td>47001</td> <td>Anderson</td> <td>39.0</td> <td>76061</td> <td>Urban</td> <td>moderately adequate</td> <td>51.274635</td> </tr> <tr> <th>1</th> <td>2019</td> <td>County</td> <td>Preventive Services</td> <td>All</td> <td>All</td> <td>Dual &amp; non-dual</td> <td>47003</td> <td>Bedford County</td> <td>TENNESSEE</td> <td>Rural</td> <td>...</td> <td>19550</td> <td>1073</td> <td>5.2</td> <td>47003</td> <td>Bedford</td> <td>15.0</td> <td>48292</td> <td>Rural</td> <td>moderately adequate</td> <td>31.061045</td> </tr> </tbody> </table> <p>2 rows × 32 columns</p> </div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">disparities</span><span class="p">.</span><span class="nf">info</span><span class="p">()</span>
</code></pre></div></div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
Int64Index: 95 entries, 0 to 94
Data columns (total 32 columns):
 #   Column                    Non-Null Count  Dtype  
---  ------                    --------------  -----  
 0   year                      95 non-null     int64  
 1   geography                 95 non-null     object 
 2   measure_well              95 non-null     object 
 3   primary_sex               95 non-null     object 
 4   primary_age               95 non-null     object 
 5   primary_dual              95 non-null     object 
 6   fips                      95 non-null     int64  
 7   county_x                  95 non-null     object 
 8   state                     95 non-null     object 
 9   urban_x                   95 non-null     object 
 10  primary_race              95 non-null     object 
 11  primary_eligibility       95 non-null     object 
 12  primary_denominator_well  95 non-null     object 
 13  analysis_value_well       95 non-null     int64  
 14  measure_hosp              95 non-null     object 
 15  primary_denominator_hosp  95 non-null     object 
 16  analysis_value_hosp       95 non-null     int64  
 17  measure_emer              95 non-null     object 
 18  primary_denominator_emer  95 non-null     object 
 19  analysis_value_emer       95 non-null     int64  
 20  laus_code                 95 non-null     object 
 21  Name                      95 non-null     object 
 22  Employed                  95 non-null     int64  
 23  Unemployed                95 non-null     int64  
 24  unemployment_rate         95 non-null     float64
 25  FIPS                      95 non-null     int64  
 26  county_y                  95 non-null     object 
 27  primary_care_physicians   95 non-null     float64
 28  population                95 non-null     int64  
 29  urban_y                   95 non-null     object 
 30  shadac_category           95 non-null     object 
 31  pcp_per_100k              95 non-null     float64
dtypes: float64(3), int64(9), object(20)
memory usage: 24.5+ KB
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">disparities</span> <span class="o">=</span> <span class="n">disparities</span><span class="p">.</span><span class="nf">drop</span><span class="p">([</span><span class="sh">'</span><span class="s">geography</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">county_x</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">urban_x</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">fips</span><span class="sh">'</span><span class="p">],</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">disparities</span><span class="p">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">disparities</span><span class="p">.</span><span class="n">FIPS</span>
<span class="n">disparities</span><span class="p">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">disparities</span><span class="p">.</span><span class="n">columns</span><span class="p">.</span><span class="nb">str</span><span class="p">.</span><span class="nf">replace</span><span class="p">(</span><span class="sh">'</span><span class="s">county_y</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">county</span><span class="sh">'</span><span class="p">)</span>
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">disparities</span><span class="p">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">disparities</span><span class="p">.</span><span class="n">columns</span><span class="p">.</span><span class="nb">str</span><span class="p">.</span><span class="nf">replace</span><span class="p">(</span><span class="sh">'</span><span class="s">urban_y</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">urban</span><span class="sh">'</span><span class="p">)</span>
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">print</span><span class="p">(</span><span class="nf">set</span><span class="p">(</span><span class="n">disparities</span><span class="p">.</span><span class="n">measure_well</span><span class="p">),</span><span class="nf">set</span><span class="p">(</span><span class="n">disparities</span><span class="p">.</span><span class="n">measure_emer</span><span class="p">),</span><span class="nf">set</span><span class="p">(</span><span class="n">disparities</span><span class="p">.</span><span class="n">measure_hosp</span><span class="p">))</span>
</code></pre></div></div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{'Preventive Services'} {'Emergency department visit rate'} {'Hospitalization'}
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">disparities</span> <span class="o">=</span> <span class="n">disparities</span><span class="p">.</span><span class="nf">drop</span><span class="p">([</span><span class="sh">'</span><span class="s">measure_well</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">measure_emer</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">measure_hosp</span><span class="sh">'</span><span class="p">],</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>

</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">disparities</span><span class="p">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</code></pre></div></div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>year                                       2019
primary_sex                                 All
primary_age                                 All
primary_dual                    Dual &amp; non-dual
state                                 TENNESSEE
primary_race                                All
primary_eligibility                         All
primary_denominator_well            5,000-9,999
analysis_value_well                          35
primary_denominator_hosp                10,000+
analysis_value_hosp                         267
primary_denominator_emer              undefined
analysis_value_emer                         617
laus_code                       CN4700100000000
Name                                   Anderson
Employed                                  33010
Unemployed                                 1694
unemployment_rate                           4.9
FIPS                                      47001
county                                 Anderson
primary_care_physicians                    39.0
population                                76061
urban                                     Urban
shadac_category             moderately adequate
pcp_per_100k                          51.274635
Name: 47001, dtype: object
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">disparities</span><span class="p">.</span><span class="nf">to_csv</span><span class="p">(</span><span class="sh">"</span><span class="s">../data/disparities.csv</span><span class="sh">"</span><span class="p">)</span>
</code></pre></div></div> <h2 id="analyzing-disparities-in-access-physicians">Analyzing disparities in access: physicians</h2> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">disparities</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nf">read_csv</span><span class="p">(</span><span class="sh">'</span><span class="s">../data/disparities.csv</span><span class="sh">'</span><span class="p">,</span> <span class="n">index_col</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">hospitals</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nf">read_csv</span><span class="p">(</span><span class="sh">'</span><span class="s">../data/Hospitals.csv</span><span class="sh">'</span><span class="p">)</span>
<span class="n">hospitals</span> <span class="o">=</span> <span class="n">hospitals</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">hospitals</span><span class="p">.</span><span class="n">STATE</span> <span class="o">==</span><span class="sh">'</span><span class="s">TN</span><span class="sh">'</span><span class="p">]</span>
<span class="n">hospitals</span><span class="p">.</span><span class="n">COUNTYFIPS</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nf">to_numeric</span><span class="p">(</span><span class="n">hospitals</span><span class="p">[</span><span class="sh">'</span><span class="s">COUNTYFIPS</span><span class="sh">'</span><span class="p">])</span>
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">disparities</span><span class="p">.</span><span class="nf">corr</span><span class="p">().</span><span class="n">style</span><span class="p">.</span><span class="nf">background_gradient</span><span class="p">(</span><span class="sh">'</span><span class="s">viridis</span><span class="sh">'</span><span class="p">)</span>
</code></pre></div></div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/Users/smgroves/Documents/anaconda3/envs/geo_dse/lib/python3.9/site-packages/pandas/io/formats/style.py:2813: RuntimeWarning: All-NaN slice encountered
  smin = np.nanmin(gmap) if vmin is None else vmin
/Users/smgroves/Documents/anaconda3/envs/geo_dse/lib/python3.9/site-packages/pandas/io/formats/style.py:2814: RuntimeWarning: All-NaN slice encountered
  smax = np.nanmax(gmap) if vmax is None else vmax
</code></pre></div></div> <style type="text/css">#T_edc25_row0_col0,#T_edc25_row0_col1,#T_edc25_row0_col2,#T_edc25_row0_col3,#T_edc25_row0_col4,#T_edc25_row0_col5,#T_edc25_row0_col6,#T_edc25_row0_col7,#T_edc25_row0_col8,#T_edc25_row0_col9,#T_edc25_row0_col10,#T_edc25_row1_col0,#T_edc25_row2_col0,#T_edc25_row3_col0,#T_edc25_row4_col0,#T_edc25_row5_col0,#T_edc25_row6_col0,#T_edc25_row7_col0,#T_edc25_row8_col0,#T_edc25_row9_col0,#T_edc25_row10_col0{background-color:#000;color:#f1f1f1}#T_edc25_row1_col1,#T_edc25_row2_col2,#T_edc25_row3_col3,#T_edc25_row4_col4,#T_edc25_row5_col5,#T_edc25_row6_col6,#T_edc25_row7_col7,#T_edc25_row8_col8,#T_edc25_row9_col9,#T_edc25_row10_col10{background-color:#fde725;color:#000}#T_edc25_row1_col2,#T_edc25_row1_col3,#T_edc25_row2_col1,#T_edc25_row3_col1,#T_edc25_row3_col5,#T_edc25_row3_col8,#T_edc25_row3_col9,#T_edc25_row3_col10,#T_edc25_row6_col4,#T_edc25_row6_col7,#T_edc25_row10_col6{background-color:#440154;color:#f1f1f1}#T_edc25_row1_col4{background-color:#29798e;color:#f1f1f1}#T_edc25_row1_col5{background-color:#34618d;color:#f1f1f1}#T_edc25_row1_col6{background-color:#440256;color:#f1f1f1}#T_edc25_row1_col7{background-color:#472c7a;color:#f1f1f1}#T_edc25_row1_col8{background-color:#26818e;color:#f1f1f1}#T_edc25_row1_col9{background-color:#2b758e;color:#f1f1f1}#T_edc25_row1_col10{background-color:#2ab07f;color:#f1f1f1}#T_edc25_row2_col3,#T_edc25_row3_col2{background-color:#52c569;color:#000}#T_edc25_row2_col4{background-color:#482071;color:#f1f1f1}#T_edc25_row2_col5{background-color:#48186a;color:#f1f1f1}#T_edc25_row2_col6{background-color:#24868e;color:#f1f1f1}#T_edc25_row2_col7,#T_edc25_row7_col6{background-color:#443b84;color:#f1f1f1}#T_edc25_row2_col8,#T_edc25_row2_col9{background-color:#481a6c;color:#f1f1f1}#T_edc25_row2_col10{background-color:#481769;color:#f1f1f1}#T_edc25_row3_col4,#T_edc25_row6_col9{background-color:#450559;color:#f1f1f1}#T_edc25_row3_col6{background-color:#25ac82;color:#f1f1f1}#T_edc25_row3_col7{background-color:#481467;color:#f1f1f1}#T_edc25_row4_col1{background-color:#1f948c;color:#f1f1f1}#T_edc25_row4_col2,#T_edc25_row9_col2{background-color:#39558c;color:#f1f1f1}#T_edc25_row4_col3{background-color:#414487;color:#f1f1f1}#T_edc25_row4_col5,#T_edc25_row5_col4,#T_edc25_row8_col9,#T_edc25_row9_col8{background-color:#ece51b;color:#000}#T_edc25_row4_col6,#T_edc25_row6_col1{background-color:#482576;color:#f1f1f1}#T_edc25_row4_col7,#T_edc25_row5_col7,#T_edc25_row8_col7,#T_edc25_row9_col7{background-color:#433d84;color:#f1f1f1}#T_edc25_row4_col8,#T_edc25_row8_col4{background-color:#eae51a;color:#000}#T_edc25_row4_col9,#T_edc25_row9_col4{background-color:#fbe723;color:#000}#T_edc25_row4_col10,#T_edc25_row9_col10{background-color:#2db27d;color:#f1f1f1}#T_edc25_row5_col1{background-color:#238a8d;color:#f1f1f1}#T_edc25_row5_col2{background-color:#365d8d;color:#f1f1f1}#T_edc25_row5_col3,#T_edc25_row7_col8,#T_edc25_row8_col2{background-color:#3c508b;color:#f1f1f1}#T_edc25_row5_col6{background-color:#424186;color:#f1f1f1}#T_edc25_row5_col8{background-color:#dde318;color:#000}#T_edc25_row5_col9,#T_edc25_row9_col5{background-color:#f6e620;color:#000}#T_edc25_row5_col10{background-color:#21a685;color:#f1f1f1}#T_edc25_row6_col2{background-color:#20928c;color:#f1f1f1}#T_edc25_row6_col3{background-color:#2fb47c;color:#f1f1f1}#T_edc25_row6_col5{background-color:#471063;color:#f1f1f1}#T_edc25_row6_col8{background-color:#470d60;color:#f1f1f1}#T_edc25_row6_col10{background-color:#471164;color:#f1f1f1}#T_edc25_row7_col1{background-color:#2f6b8e;color:#f1f1f1}#T_edc25_row7_col2{background-color:#2c738e;color:#f1f1f1}#T_edc25_row7_col3{background-color:#355e8d;color:#f1f1f1}#T_edc25_row7_col4{background-color:#3c4f8a;color:#f1f1f1}#T_edc25_row7_col5,#T_edc25_row8_col3,#T_edc25_row10_col7{background-color:#424086;color:#f1f1f1}#T_edc25_row7_col9{background-color:#3e4a89;color:#f1f1f1}#T_edc25_row7_col10{background-color:#2e6e8e;color:#f1f1f1}#T_edc25_row8_col1{background-color:#1f9a8a;color:#f1f1f1}#T_edc25_row8_col5{background-color:#dae319;color:#000}#T_edc25_row8_col6{background-color:#472e7c;color:#f1f1f1}#T_edc25_row8_col10{background-color:#54c568;color:#000}#T_edc25_row9_col1{background-color:#20938c;color:#f1f1f1}#T_edc25_row9_col3{background-color:#404688;color:#f1f1f1}#T_edc25_row9_col6{background-color:#472f7d;color:#f1f1f1}#T_edc25_row10_col1{background-color:#31b57b;color:#f1f1f1}#T_edc25_row10_col2{background-color:#482979;color:#f1f1f1}#T_edc25_row10_col3{background-color:#481668;color:#f1f1f1}#T_edc25_row10_col4{background-color:#20a486;color:#f1f1f1}#T_edc25_row10_col5{background-color:#218f8d;color:#f1f1f1}#T_edc25_row10_col8{background-color:#3fbc73;color:#f1f1f1}#T_edc25_row10_col9{background-color:#1fa287;color:#f1f1f1}</style> <table id="T_edc25_"> <thead> <tr> <th class="blank level0"> </th> <th class="col_heading level0 col0">year</th> <th class="col_heading level0 col1">analysis_value_well</th> <th class="col_heading level0 col2">analysis_value_hosp</th> <th class="col_heading level0 col3">analysis_value_emer</th> <th class="col_heading level0 col4">Employed</th> <th class="col_heading level0 col5">Unemployed</th> <th class="col_heading level0 col6">unemployment_rate</th> <th class="col_heading level0 col7">FIPS.1</th> <th class="col_heading level0 col8">primary_care_physicians</th> <th class="col_heading level0 col9">population</th> <th class="col_heading level0 col10">pcp_per_100k</th> </tr> </thead> <tbody> <tr> <th id="T_edc25_level0_row0" class="row_heading level0 row0">year</th> <td id="T_edc25_row0_col0" class="data row0 col0">nan</td> <td id="T_edc25_row0_col1" class="data row0 col1">nan</td> <td id="T_edc25_row0_col2" class="data row0 col2">nan</td> <td id="T_edc25_row0_col3" class="data row0 col3">nan</td> <td id="T_edc25_row0_col4" class="data row0 col4">nan</td> <td id="T_edc25_row0_col5" class="data row0 col5">nan</td> <td id="T_edc25_row0_col6" class="data row0 col6">nan</td> <td id="T_edc25_row0_col7" class="data row0 col7">nan</td> <td id="T_edc25_row0_col8" class="data row0 col8">nan</td> <td id="T_edc25_row0_col9" class="data row0 col9">nan</td> <td id="T_edc25_row0_col10" class="data row0 col10">nan</td> </tr> <tr> <th id="T_edc25_level0_row1" class="row_heading level0 row1">analysis_value_well</th> <td id="T_edc25_row1_col0" class="data row1 col0">nan</td> <td id="T_edc25_row1_col1" class="data row1 col1">1.000000</td> <td id="T_edc25_row1_col2" class="data row1 col2">-0.480732</td> <td id="T_edc25_row1_col3" class="data row1 col3">-0.480607</td> <td id="T_edc25_row1_col4" class="data row1 col4">0.288357</td> <td id="T_edc25_row1_col5" class="data row1 col5">0.221078</td> <td id="T_edc25_row1_col6" class="data row1 col6">-0.325228</td> <td id="T_edc25_row1_col7" class="data row1 col7">0.032489</td> <td id="T_edc25_row1_col8" class="data row1 col8">0.319609</td> <td id="T_edc25_row1_col9" class="data row1 col9">0.281995</td> <td id="T_edc25_row1_col10" class="data row1 col10">0.488941</td> </tr> <tr> <th id="T_edc25_level0_row2" class="row_heading level0 row2">analysis_value_hosp</th> <td id="T_edc25_row2_col0" class="data row2 col0">nan</td> <td id="T_edc25_row2_col1" class="data row2 col1">-0.480732</td> <td id="T_edc25_row2_col2" class="data row2 col2">1.000000</td> <td id="T_edc25_row2_col3" class="data row2 col3">0.599412</td> <td id="T_edc25_row2_col4" class="data row2 col4">-0.093001</td> <td id="T_edc25_row2_col5" class="data row2 col5">-0.049513</td> <td id="T_edc25_row2_col6" class="data row2 col6">0.275980</td> <td id="T_edc25_row2_col7" class="data row2 col7">0.085773</td> <td id="T_edc25_row2_col8" class="data row2 col8">-0.121397</td> <td id="T_edc25_row2_col9" class="data row2 col9">-0.091323</td> <td id="T_edc25_row2_col10" class="data row2 col10">-0.308934</td> </tr> <tr> <th id="T_edc25_level0_row3" class="row_heading level0 row3">analysis_value_emer</th> <td id="T_edc25_row3_col0" class="data row3 col0">nan</td> <td id="T_edc25_row3_col1" class="data row3 col1">-0.480607</td> <td id="T_edc25_row3_col2" class="data row3 col2">0.599412</td> <td id="T_edc25_row3_col3" class="data row3 col3">1.000000</td> <td id="T_edc25_row3_col4" class="data row3 col4">-0.179994</td> <td id="T_edc25_row3_col5" class="data row3 col5">-0.121924</td> <td id="T_edc25_row3_col6" class="data row3 col6">0.484027</td> <td id="T_edc25_row3_col7" class="data row3 col7">-0.044881</td> <td id="T_edc25_row3_col8" class="data row3 col8">-0.202044</td> <td id="T_edc25_row3_col9" class="data row3 col9">-0.172820</td> <td id="T_edc25_row3_col10" class="data row3 col10">-0.396181</td> </tr> <tr> <th id="T_edc25_level0_row4" class="row_heading level0 row4">Employed</th> <td id="T_edc25_row4_col0" class="data row4 col0">nan</td> <td id="T_edc25_row4_col1" class="data row4 col1">0.288357</td> <td id="T_edc25_row4_col2" class="data row4 col2">-0.093001</td> <td id="T_edc25_row4_col3" class="data row4 col3">-0.179994</td> <td id="T_edc25_row4_col4" class="data row4 col4">1.000000</td> <td id="T_edc25_row4_col5" class="data row4 col5">0.965032</td> <td id="T_edc25_row4_col6" class="data row4 col6">-0.196023</td> <td id="T_edc25_row4_col7" class="data row4 col7">0.089982</td> <td id="T_edc25_row4_col8" class="data row4 col8">0.961056</td> <td id="T_edc25_row4_col9" class="data row4 col9">0.992966</td> <td id="T_edc25_row4_col10" class="data row4 col10">0.502287</td> </tr> <tr> <th id="T_edc25_level0_row5" class="row_heading level0 row5">Unemployed</th> <td id="T_edc25_row5_col0" class="data row5 col0">nan</td> <td id="T_edc25_row5_col1" class="data row5 col1">0.221078</td> <td id="T_edc25_row5_col2" class="data row5 col2">-0.049513</td> <td id="T_edc25_row5_col3" class="data row5 col3">-0.121924</td> <td id="T_edc25_row5_col4" class="data row5 col4">0.965032</td> <td id="T_edc25_row5_col5" class="data row5 col5">1.000000</td> <td id="T_edc25_row5_col6" class="data row5 col6">-0.077655</td> <td id="T_edc25_row5_col7" class="data row5 col7">0.091267</td> <td id="T_edc25_row5_col8" class="data row5 col8">0.934610</td> <td id="T_edc25_row5_col9" class="data row5 col9">0.985295</td> <td id="T_edc25_row5_col10" class="data row5 col10">0.432351</td> </tr> <tr> <th id="T_edc25_level0_row6" class="row_heading level0 row6">unemployment_rate</th> <td id="T_edc25_row6_col0" class="data row6 col0">nan</td> <td id="T_edc25_row6_col1" class="data row6 col1">-0.325228</td> <td id="T_edc25_row6_col2" class="data row6 col2">0.275980</td> <td id="T_edc25_row6_col3" class="data row6 col3">0.484027</td> <td id="T_edc25_row6_col4" class="data row6 col4">-0.196023</td> <td id="T_edc25_row6_col5" class="data row6 col5">-0.077655</td> <td id="T_edc25_row6_col6" class="data row6 col6">1.000000</td> <td id="T_edc25_row6_col7" class="data row6 col7">-0.104688</td> <td id="T_edc25_row6_col8" class="data row6 col8">-0.159979</td> <td id="T_edc25_row6_col9" class="data row6 col9">-0.156259</td> <td id="T_edc25_row6_col10" class="data row6 col10">-0.335333</td> </tr> <tr> <th id="T_edc25_level0_row7" class="row_heading level0 row7">FIPS.1</th> <td id="T_edc25_row7_col0" class="data row7 col0">nan</td> <td id="T_edc25_row7_col1" class="data row7 col1">0.032489</td> <td id="T_edc25_row7_col2" class="data row7 col2">0.085773</td> <td id="T_edc25_row7_col3" class="data row7 col3">-0.044881</td> <td id="T_edc25_row7_col4" class="data row7 col4">0.089982</td> <td id="T_edc25_row7_col5" class="data row7 col5">0.091267</td> <td id="T_edc25_row7_col6" class="data row7 col6">-0.104688</td> <td id="T_edc25_row7_col7" class="data row7 col7">1.000000</td> <td id="T_edc25_row7_col8" class="data row7 col8">0.093030</td> <td id="T_edc25_row7_col9" class="data row7 col9">0.091808</td> <td id="T_edc25_row7_col10" class="data row7 col10">0.103152</td> </tr> <tr> <th id="T_edc25_level0_row8" class="row_heading level0 row8">primary_care_physicians</th> <td id="T_edc25_row8_col0" class="data row8 col0">nan</td> <td id="T_edc25_row8_col1" class="data row8 col1">0.319609</td> <td id="T_edc25_row8_col2" class="data row8 col2">-0.121397</td> <td id="T_edc25_row8_col3" class="data row8 col3">-0.202044</td> <td id="T_edc25_row8_col4" class="data row8 col4">0.961056</td> <td id="T_edc25_row8_col5" class="data row8 col5">0.934610</td> <td id="T_edc25_row8_col6" class="data row8 col6">-0.159979</td> <td id="T_edc25_row8_col7" class="data row8 col7">0.093030</td> <td id="T_edc25_row8_col8" class="data row8 col8">1.000000</td> <td id="T_edc25_row8_col9" class="data row8 col9">0.964170</td> <td id="T_edc25_row8_col10" class="data row8 col10">0.624601</td> </tr> <tr> <th id="T_edc25_level0_row9" class="row_heading level0 row9">population</th> <td id="T_edc25_row9_col0" class="data row9 col0">nan</td> <td id="T_edc25_row9_col1" class="data row9 col1">0.281995</td> <td id="T_edc25_row9_col2" class="data row9 col2">-0.091323</td> <td id="T_edc25_row9_col3" class="data row9 col3">-0.172820</td> <td id="T_edc25_row9_col4" class="data row9 col4">0.992966</td> <td id="T_edc25_row9_col5" class="data row9 col5">0.985295</td> <td id="T_edc25_row9_col6" class="data row9 col6">-0.156259</td> <td id="T_edc25_row9_col7" class="data row9 col7">0.091808</td> <td id="T_edc25_row9_col8" class="data row9 col8">0.964170</td> <td id="T_edc25_row9_col9" class="data row9 col9">1.000000</td> <td id="T_edc25_row9_col10" class="data row9 col10">0.501609</td> </tr> <tr> <th id="T_edc25_level0_row10" class="row_heading level0 row10">pcp_per_100k</th> <td id="T_edc25_row10_col0" class="data row10 col0">nan</td> <td id="T_edc25_row10_col1" class="data row10 col1">0.488941</td> <td id="T_edc25_row10_col2" class="data row10 col2">-0.308934</td> <td id="T_edc25_row10_col3" class="data row10 col3">-0.396181</td> <td id="T_edc25_row10_col4" class="data row10 col4">0.502287</td> <td id="T_edc25_row10_col5" class="data row10 col5">0.432351</td> <td id="T_edc25_row10_col6" class="data row10 col6">-0.335333</td> <td id="T_edc25_row10_col7" class="data row10 col7">0.103152</td> <td id="T_edc25_row10_col8" class="data row10 col8">0.624601</td> <td id="T_edc25_row10_col9" class="data row10 col9">0.501609</td> <td id="T_edc25_row10_col10" class="data row10 col10">1.000000</td> </tr> </tbody> </table> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">disparities</span><span class="p">.</span><span class="n">columns</span>
</code></pre></div></div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Index(['year', 'primary_sex', 'primary_age', 'primary_dual', 'state',
       'primary_race', 'primary_eligibility', 'primary_denominator_well',
       'analysis_value_well', 'primary_denominator_hosp',
       'analysis_value_hosp', 'primary_denominator_emer',
       'analysis_value_emer', 'laus_code', 'Name', 'Employed', 'Unemployed',
       'unemployment_rate', 'FIPS.1', 'county', 'primary_care_physicians',
       'population', 'urban', 'shadac_category', 'pcp_per_100k'],
      dtype='object')
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">seaborn</span> <span class="k">as</span> <span class="n">sns</span>
<span class="n">sns</span><span class="p">.</span><span class="nf">pairplot</span><span class="p">(</span><span class="n">disparities</span><span class="p">[[</span><span class="sh">'</span><span class="s">analysis_value_well</span><span class="sh">'</span><span class="p">,</span> 
                          <span class="sh">'</span><span class="s">analysis_value_hosp</span><span class="sh">'</span><span class="p">,</span> 
                          <span class="sh">'</span><span class="s">analysis_value_emer</span><span class="sh">'</span><span class="p">,</span>
                          <span class="sh">'</span><span class="s">unemployment_rate</span><span class="sh">'</span><span class="p">,</span>
                          <span class="sh">'</span><span class="s">population</span><span class="sh">'</span><span class="p">,</span>
                          <span class="sh">'</span><span class="s">pcp_per_100k</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">urban</span><span class="sh">'</span>
                         <span class="p">]],</span> <span class="n">hue</span> <span class="o">=</span> <span class="sh">'</span><span class="s">urban</span><span class="sh">'</span><span class="p">)</span>
</code></pre></div></div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;seaborn.axisgrid.PairGrid at 0x19f0b01c0&gt;
</code></pre></div></div> <div class="img"> <img src="/assets/img/bb/data-science-project/output_58_1.png" style="height: 100%; width: 100%; object-fit: contain"> </div> <p>First, we will look at primary care physicians by county. We already did this, so we will summarize in plots below.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sns</span><span class="p">.</span><span class="nf">boxplot</span><span class="p">(</span><span class="n">disparities</span><span class="p">.</span><span class="n">shadac_category</span><span class="p">,</span> <span class="n">disparities</span><span class="p">.</span><span class="n">pcp_per_100k</span><span class="p">)</span>
</code></pre></div></div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/Users/smgroves/Documents/anaconda3/envs/geo_dse/lib/python3.9/site-packages/seaborn/_decorators.py:36: FutureWarning: Pass the following variables as keyword args: x, y. From version 0.12, the only valid positional argument will be `data`, and passing other arguments without an explicit keyword will result in an error or misinterpretation.
  warnings.warn(





&lt;AxesSubplot:xlabel='shadac_category', ylabel='pcp_per_100k'&gt;
</code></pre></div></div> <div class="img"> <img src="/assets/img/bb/data-science-project/output_60_2.png" style="height: 100%; width: 100%; object-fit: contain"> </div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">disparities</span><span class="p">.</span><span class="n">shadac_category</span><span class="p">.</span><span class="nf">value_counts</span><span class="p">()</span>
</code></pre></div></div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>moderately adequate    50
low inadequate         31
adequate               14
Name: shadac_category, dtype: int64
</code></pre></div></div> <p>There are 31 counties considered low inadequate (&gt;3500 residents per physician).</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">low_shadac</span> <span class="o">=</span> <span class="n">disparities</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">disparities</span><span class="p">.</span><span class="n">shadac_category</span> <span class="o">==</span> <span class="sh">'</span><span class="s">low inadequate</span><span class="sh">'</span><span class="p">]</span>
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">low_shadac</span><span class="p">.</span><span class="nf">sort_values</span><span class="p">(</span><span class="sh">'</span><span class="s">pcp_per_100k</span><span class="sh">'</span><span class="p">).</span><span class="nf">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</code></pre></div></div> <div> <style scoped="">.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</style> <table border="1" class="dataframe"> <thead> <tr style="text-align: right;"> <th></th> <th>year</th> <th>primary_sex</th> <th>primary_age</th> <th>primary_dual</th> <th>state</th> <th>primary_race</th> <th>primary_eligibility</th> <th>primary_denominator_well</th> <th>analysis_value_well</th> <th>primary_denominator_hosp</th> <th>...</th> <th>Employed</th> <th>Unemployed</th> <th>unemployment_rate</th> <th>FIPS.1</th> <th>county</th> <th>primary_care_physicians</th> <th>population</th> <th>urban</th> <th>shadac_category</th> <th>pcp_per_100k</th> </tr> <tr> <th>FIPS</th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> </tr> </thead> <tbody> <tr> <th>47175</th> <td>2019</td> <td>All</td> <td>All</td> <td>Dual &amp; non-dual</td> <td>TENNESSEE</td> <td>All</td> <td>All</td> <td>500-999</td> <td>31</td> <td>500-999</td> <td>...</td> <td>1884</td> <td>137</td> <td>6.8</td> <td>47175</td> <td>Van Buren</td> <td>0.0</td> <td>5760</td> <td>Rural</td> <td>low inadequate</td> <td>0.000000</td> </tr> <tr> <th>47033</th> <td>2019</td> <td>All</td> <td>All</td> <td>Dual &amp; non-dual</td> <td>TENNESSEE</td> <td>All</td> <td>All</td> <td>1,000-4,999</td> <td>25</td> <td>1,000-4,999</td> <td>...</td> <td>6494</td> <td>344</td> <td>5.0</td> <td>47033</td> <td>Crockett</td> <td>0.0</td> <td>14399</td> <td>Rural</td> <td>low inadequate</td> <td>0.000000</td> </tr> <tr> <th>47061</th> <td>2019</td> <td>All</td> <td>All</td> <td>Dual &amp; non-dual</td> <td>TENNESSEE</td> <td>All</td> <td>All</td> <td>1,000-4,999</td> <td>34</td> <td>1,000-4,999</td> <td>...</td> <td>4655</td> <td>322</td> <td>6.5</td> <td>47061</td> <td>Grundy</td> <td>0.0</td> <td>13344</td> <td>Rural</td> <td>low inadequate</td> <td>0.000000</td> </tr> <tr> <th>47095</th> <td>2019</td> <td>All</td> <td>All</td> <td>Dual &amp; non-dual</td> <td>TENNESSEE</td> <td>All</td> <td>All</td> <td>500-999</td> <td>20</td> <td>1,000-4,999</td> <td>...</td> <td>1537</td> <td>157</td> <td>9.3</td> <td>47095</td> <td>Lake</td> <td>0.0</td> <td>7401</td> <td>Rural</td> <td>low inadequate</td> <td>0.000000</td> </tr> <tr> <th>47007</th> <td>2019</td> <td>All</td> <td>All</td> <td>Dual &amp; non-dual</td> <td>TENNESSEE</td> <td>All</td> <td>All</td> <td>1,000-4,999</td> <td>19</td> <td>1,000-4,999</td> <td>...</td> <td>3947</td> <td>305</td> <td>7.2</td> <td>47007</td> <td>Bledsoe</td> <td>1.0</td> <td>14836</td> <td>Rural</td> <td>low inadequate</td> <td>6.740361</td> </tr> <tr> <th>47161</th> <td>2019</td> <td>All</td> <td>All</td> <td>Dual &amp; non-dual</td> <td>TENNESSEE</td> <td>All</td> <td>All</td> <td>1,000-4,999</td> <td>39</td> <td>1,000-4,999</td> <td>...</td> <td>5146</td> <td>305</td> <td>5.6</td> <td>47161</td> <td>Stewart</td> <td>1.0</td> <td>13427</td> <td>Urban</td> <td>low inadequate</td> <td>7.447680</td> </tr> <tr> <th>47097</th> <td>2019</td> <td>All</td> <td>All</td> <td>Dual &amp; non-dual</td> <td>TENNESSEE</td> <td>All</td> <td>All</td> <td>1,000-4,999</td> <td>36</td> <td>1,000-4,999</td> <td>...</td> <td>9075</td> <td>658</td> <td>6.8</td> <td>47097</td> <td>Lauderdale</td> <td>2.0</td> <td>25989</td> <td>Rural</td> <td>low inadequate</td> <td>7.695564</td> </tr> <tr> <th>47129</th> <td>2019</td> <td>All</td> <td>All</td> <td>Dual &amp; non-dual</td> <td>TENNESSEE</td> <td>All</td> <td>All</td> <td>1,000-4,999</td> <td>23</td> <td>1,000-4,999</td> <td>...</td> <td>7327</td> <td>455</td> <td>5.8</td> <td>47129</td> <td>Morgan</td> <td>3.0</td> <td>21545</td> <td>Rural</td> <td>low inadequate</td> <td>13.924344</td> </tr> <tr> <th>47117</th> <td>2019</td> <td>All</td> <td>All</td> <td>Dual &amp; non-dual</td> <td>TENNESSEE</td> <td>All</td> <td>All</td> <td>1,000-4,999</td> <td>20</td> <td>1,000-4,999</td> <td>...</td> <td>14422</td> <td>735</td> <td>4.8</td> <td>47117</td> <td>Marshall</td> <td>5.0</td> <td>32965</td> <td>Rural</td> <td>low inadequate</td> <td>15.167602</td> </tr> <tr> <th>47067</th> <td>2019</td> <td>All</td> <td>All</td> <td>Dual &amp; non-dual</td> <td>TENNESSEE</td> <td>All</td> <td>All</td> <td>500-999</td> <td>27</td> <td>500-999</td> <td>...</td> <td>1997</td> <td>144</td> <td>6.7</td> <td>47067</td> <td>Hancock</td> <td>1.0</td> <td>6587</td> <td>Rural</td> <td>low inadequate</td> <td>15.181418</td> </tr> </tbody> </table> <p>10 rows × 25 columns</p> </div> <p>There are 31 counties with low access to physicians, by SHADAC category. <b>In particular, 4 counties have 0 physicians: Van Buren, Crockett, Grundy, and Lake.</b> All four are rural, though Crockett and Grundy have almost 15,000 residents.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
</code></pre></div></div> <h3 id="analyzing-disparities-in-access-hospitals">Analyzing disparities in access: hospitals</h3> <p>We would like to add hospitals per 100K residents for each county to disparities. To do this, we need to get hospitals.COUNTY and disparities.county in the same format, and then we can add up the # of hospitals (plus associated variables) for each county by population.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">hospitals</span><span class="p">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</code></pre></div></div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>X                                           -9409026.0792
Y                                            4210878.1252
OBJECTID                                              517
ID                                               14737331
NAME                 STARR REGIONAL MEDICAL CENTER ETOWAH
ADDRESS                             886 HIGHWAY 411 NORTH
CITY                                               ETOWAH
STATE                                                  TN
ZIP                                                 37331
ZIP4                                        NOT AVAILABLE
TELEPHONE                                  (423) 263-3600
TYPE                                   GENERAL ACUTE CARE
STATUS                                               OPEN
POPULATION                                             72
COUNTY                                             MCMINN
COUNTYFIPS                                          47107
COUNTRY                                               USA
LATITUDE                                        35.345099
LONGITUDE                                      -84.522719
NAICS_CODE                                         622110
NAICS_DESC         GENERAL MEDICAL AND SURGICAL HOSPITALS
SOURCE        https://apps.health.tn.gov/facilitylistings
SOURCEDATE                            2019/08/10 00:00:00
VAL_METHOD                                        IMAGERY
VAL_DATE                              2014/02/10 00:00:00
WEBSITE                     http://www.starrregional.com/
STATE_ID                                    NOT AVAILABLE
ALT_NAME                          WOODS MEMORIAL HOSPITAL
ST_FIPS                                                47
OWNER                                          NON-PROFIT
TTL_STAFF                                            -999
BEDS                                                   72
TRAUMA                                          LEVEL III
HELIPAD                                                 Y
Name: 515, dtype: object
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">hospitals</span><span class="p">.</span><span class="n">COUNTYFIPS</span><span class="p">.</span><span class="nf">value_counts</span><span class="p">()</span>
</code></pre></div></div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>47157    23
47037    15
47065    13
47093    11
47179     7
         ..
47019     1
47177     1
47027     1
47159     1
47181     1
Name: COUNTYFIPS, Length: 80, dtype: int64
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="n">hospitals</span><span class="p">.</span><span class="n">COUNTYFIPS</span><span class="p">.</span><span class="nf">value_counts</span><span class="p">())):</span>
    <span class="n">ind</span> <span class="o">=</span> <span class="p">(</span><span class="n">hospitals</span><span class="p">.</span><span class="n">COUNTYFIPS</span><span class="p">.</span><span class="nf">value_counts</span><span class="p">().</span><span class="n">index</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="n">count</span> <span class="o">=</span> <span class="p">(</span><span class="n">hospitals</span><span class="p">.</span><span class="n">COUNTYFIPS</span><span class="p">.</span><span class="nf">value_counts</span><span class="p">()[</span><span class="n">ind</span><span class="p">])</span>
    <span class="n">disparities</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">ind</span><span class="p">,</span> <span class="sh">'</span><span class="s">num_hospitals</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">count</span>
</code></pre></div></div> <p>However, some of these hospitals are closed.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">set</span><span class="p">(</span><span class="n">hospitals</span><span class="p">.</span><span class="n">STATUS</span><span class="p">)</span>
</code></pre></div></div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{'CLOSED', 'OPEN'}
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">hospitals</span><span class="p">.</span><span class="nf">groupby</span><span class="p">(</span><span class="sh">'</span><span class="s">COUNTYFIPS</span><span class="sh">'</span><span class="p">).</span><span class="n">STATUS</span><span class="p">.</span><span class="nf">value_counts</span><span class="p">()</span>
</code></pre></div></div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>COUNTYFIPS  STATUS
47001       OPEN      1
47003       CLOSED    1
            OPEN      1
47005       OPEN      1
47007       OPEN      1
                     ..
47181       OPEN      1
47183       OPEN      2
47185       OPEN      1
47187       OPEN      2
47189       OPEN      2
Name: STATUS, Length: 89, dtype: int64
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="n">hospitals</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">hospitals</span><span class="p">.</span><span class="n">STATUS</span> <span class="o">==</span> <span class="sh">'</span><span class="s">OPEN</span><span class="sh">'</span><span class="p">].</span><span class="n">COUNTYFIPS</span><span class="p">.</span><span class="nf">value_counts</span><span class="p">())):</span>
    <span class="n">ind</span> <span class="o">=</span> <span class="p">(</span><span class="n">hospitals</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">hospitals</span><span class="p">.</span><span class="n">STATUS</span> <span class="o">==</span> <span class="sh">'</span><span class="s">OPEN</span><span class="sh">'</span><span class="p">].</span><span class="n">COUNTYFIPS</span><span class="p">.</span><span class="nf">value_counts</span><span class="p">().</span><span class="n">index</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="n">count</span> <span class="o">=</span> <span class="p">(</span><span class="n">hospitals</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">hospitals</span><span class="p">.</span><span class="n">STATUS</span> <span class="o">==</span> <span class="sh">'</span><span class="s">OPEN</span><span class="sh">'</span><span class="p">].</span><span class="n">COUNTYFIPS</span><span class="p">.</span><span class="nf">value_counts</span><span class="p">()[</span><span class="n">ind</span><span class="p">])</span>
    <span class="n">disparities</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">ind</span><span class="p">,</span> <span class="sh">'</span><span class="s">num_hospitals_open</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">count</span>
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">disparities</span>
</code></pre></div></div> <div> <style scoped="">.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</style> <table border="1" class="dataframe"> <thead> <tr style="text-align: right;"> <th></th> <th>year</th> <th>primary_sex</th> <th>primary_age</th> <th>primary_dual</th> <th>state</th> <th>primary_race</th> <th>primary_eligibility</th> <th>primary_denominator_well</th> <th>analysis_value_well</th> <th>primary_denominator_hosp</th> <th>...</th> <th>unemployment_rate</th> <th>FIPS.1</th> <th>county</th> <th>primary_care_physicians</th> <th>population</th> <th>urban</th> <th>shadac_category</th> <th>pcp_per_100k</th> <th>num_hospitals</th> <th>num_hospitals_open</th> </tr> <tr> <th>FIPS</th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> </tr> </thead> <tbody> <tr> <th>47001</th> <td>2019</td> <td>All</td> <td>All</td> <td>Dual &amp; non-dual</td> <td>TENNESSEE</td> <td>All</td> <td>All</td> <td>5,000-9,999</td> <td>35</td> <td>10,000+</td> <td>...</td> <td>4.9</td> <td>47001</td> <td>Anderson</td> <td>39.0</td> <td>76061</td> <td>Urban</td> <td>moderately adequate</td> <td>51.274635</td> <td>1.0</td> <td>1.0</td> </tr> <tr> <th>47003</th> <td>2019</td> <td>All</td> <td>All</td> <td>Dual &amp; non-dual</td> <td>TENNESSEE</td> <td>All</td> <td>All</td> <td>1,000-4,999</td> <td>46</td> <td>5,000-9,999</td> <td>...</td> <td>5.2</td> <td>47003</td> <td>Bedford</td> <td>15.0</td> <td>48292</td> <td>Rural</td> <td>moderately adequate</td> <td>31.061045</td> <td>2.0</td> <td>1.0</td> </tr> <tr> <th>47005</th> <td>2019</td> <td>All</td> <td>All</td> <td>Dual &amp; non-dual</td> <td>TENNESSEE</td> <td>All</td> <td>All</td> <td>1,000-4,999</td> <td>30</td> <td>1,000-4,999</td> <td>...</td> <td>6.2</td> <td>47005</td> <td>Benton</td> <td>3.0</td> <td>16140</td> <td>Rural</td> <td>low inadequate</td> <td>18.587361</td> <td>1.0</td> <td>1.0</td> </tr> <tr> <th>47007</th> <td>2019</td> <td>All</td> <td>All</td> <td>Dual &amp; non-dual</td> <td>TENNESSEE</td> <td>All</td> <td>All</td> <td>1,000-4,999</td> <td>19</td> <td>1,000-4,999</td> <td>...</td> <td>7.2</td> <td>47007</td> <td>Bledsoe</td> <td>1.0</td> <td>14836</td> <td>Rural</td> <td>low inadequate</td> <td>6.740361</td> <td>1.0</td> <td>1.0</td> </tr> <tr> <th>47009</th> <td>2019</td> <td>All</td> <td>All</td> <td>Dual &amp; non-dual</td> <td>TENNESSEE</td> <td>All</td> <td>All</td> <td>10,000+</td> <td>43</td> <td>10,000+</td> <td>...</td> <td>4.6</td> <td>47009</td> <td>Blount</td> <td>90.0</td> <td>129927</td> <td>Urban</td> <td>adequate</td> <td>69.269667</td> <td>2.0</td> <td>2.0</td> </tr> <tr> <th>...</th> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> </tr> <tr> <th>47181</th> <td>2019</td> <td>All</td> <td>All</td> <td>Dual &amp; non-dual</td> <td>TENNESSEE</td> <td>All</td> <td>All</td> <td>1,000-4,999</td> <td>15</td> <td>1,000-4,999</td> <td>...</td> <td>5.3</td> <td>47181</td> <td>Wayne</td> <td>5.0</td> <td>16693</td> <td>Rural</td> <td>moderately adequate</td> <td>29.952675</td> <td>1.0</td> <td>1.0</td> </tr> <tr> <th>47183</th> <td>2019</td> <td>All</td> <td>All</td> <td>Dual &amp; non-dual</td> <td>TENNESSEE</td> <td>All</td> <td>All</td> <td>1,000-4,999</td> <td>30</td> <td>5,000-9,999</td> <td>...</td> <td>4.6</td> <td>47183</td> <td>Weakley</td> <td>18.0</td> <td>33510</td> <td>Rural</td> <td>moderately adequate</td> <td>53.715309</td> <td>2.0</td> <td>2.0</td> </tr> <tr> <th>47185</th> <td>2019</td> <td>All</td> <td>All</td> <td>Dual &amp; non-dual</td> <td>TENNESSEE</td> <td>All</td> <td>All</td> <td>1,000-4,999</td> <td>35</td> <td>5,000-9,999</td> <td>...</td> <td>5.0</td> <td>47185</td> <td>White</td> <td>9.0</td> <td>26800</td> <td>Rural</td> <td>moderately adequate</td> <td>33.582090</td> <td>1.0</td> <td>1.0</td> </tr> <tr> <th>47187</th> <td>2019</td> <td>All</td> <td>All</td> <td>Dual &amp; non-dual</td> <td>TENNESSEE</td> <td>All</td> <td>All</td> <td>10,000+</td> <td>48</td> <td>10,000+</td> <td>...</td> <td>3.3</td> <td>47187</td> <td>Williamson</td> <td>338.0</td> <td>225389</td> <td>Urban</td> <td>adequate</td> <td>149.962953</td> <td>2.0</td> <td>2.0</td> </tr> <tr> <th>47189</th> <td>2019</td> <td>All</td> <td>All</td> <td>Dual &amp; non-dual</td> <td>TENNESSEE</td> <td>All</td> <td>All</td> <td>10,000+</td> <td>45</td> <td>10,000+</td> <td>...</td> <td>4.0</td> <td>47189</td> <td>Wilson</td> <td>43.0</td> <td>136666</td> <td>Urban</td> <td>moderately adequate</td> <td>31.463568</td> <td>2.0</td> <td>2.0</td> </tr> </tbody> </table> <p>95 rows × 27 columns</p> </div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sns</span><span class="p">.</span><span class="nf">scatterplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">disparities</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="sh">'</span><span class="s">pcp_per_100k</span><span class="sh">'</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="sh">'</span><span class="s">num_hospitals_open</span><span class="sh">'</span><span class="p">,</span> <span class="n">hue</span> <span class="o">=</span> <span class="sh">'</span><span class="s">urban</span><span class="sh">'</span><span class="p">)</span>
</code></pre></div></div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;AxesSubplot:xlabel='pcp_per_100k', ylabel='num_hospitals_open'&gt;
</code></pre></div></div> <div class="img"> <img src="/assets/img/bb/data-science-project/output_77_1.png" style="height: 100%; width: 100%; object-fit: contain"> </div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">disparities</span> <span class="o">=</span> <span class="n">disparities</span><span class="p">.</span><span class="nf">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">disparities</span><span class="p">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">disparities</span><span class="p">.</span><span class="n">pcp_per_100k</span> <span class="o">&lt;</span> <span class="mi">15</span><span class="p">)</span> <span class="o">&amp;</span>
                <span class="p">(</span><span class="n">disparities</span><span class="p">.</span><span class="n">num_hospitals_open</span> <span class="o">&lt;</span> <span class="mi">2</span> <span class="p">)][</span><span class="sh">'</span><span class="s">county</span><span class="sh">'</span><span class="p">]</span>
</code></pre></div></div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>FIPS
47007       Bledsoe
47033      Crockett
47061        Grundy
47095          Lake
47097    Lauderdale
47129        Morgan
47161       Stewart
47175     Van Buren
Name: county, dtype: object
</code></pre></div></div> <p>The counties above are the ones with fewer than 2 open hospitals and fewer than 15 pcp per 100k</p> <p>Lastly, we can take a look at number of beds. We need to fillna (-999) with 0 so it doesn’t mess up the counts.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">hospitals</span><span class="p">.</span><span class="n">BEDS</span> <span class="o">=</span> <span class="n">hospitals</span><span class="p">.</span><span class="n">BEDS</span><span class="p">.</span><span class="nf">replace</span><span class="p">(</span><span class="o">-</span><span class="mi">999</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="n">hospitals</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">hospitals</span><span class="p">.</span><span class="n">STATUS</span> <span class="o">==</span> <span class="sh">'</span><span class="s">OPEN</span><span class="sh">'</span><span class="p">].</span><span class="n">COUNTYFIPS</span><span class="p">.</span><span class="nf">value_counts</span><span class="p">())):</span>
    <span class="n">ind</span> <span class="o">=</span> <span class="p">(</span><span class="n">hospitals</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">hospitals</span><span class="p">.</span><span class="n">STATUS</span> <span class="o">==</span> <span class="sh">'</span><span class="s">OPEN</span><span class="sh">'</span><span class="p">].</span><span class="n">COUNTYFIPS</span><span class="p">.</span><span class="nf">value_counts</span><span class="p">().</span><span class="n">index</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="n">count</span> <span class="o">=</span> <span class="p">(</span><span class="n">hospitals</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">hospitals</span><span class="p">.</span><span class="n">STATUS</span> <span class="o">==</span> <span class="sh">'</span><span class="s">OPEN</span><span class="sh">'</span><span class="p">].</span><span class="nf">groupby</span><span class="p">(</span><span class="sh">'</span><span class="s">COUNTYFIPS</span><span class="sh">'</span><span class="p">).</span><span class="n">BEDS</span><span class="p">.</span><span class="nf">mean</span><span class="p">()[</span><span class="n">ind</span><span class="p">])</span>
    <span class="n">disparities</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">ind</span><span class="p">,</span> <span class="sh">'</span><span class="s">mean_beds</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">count</span>
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="n">hospitals</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">hospitals</span><span class="p">.</span><span class="n">STATUS</span> <span class="o">==</span> <span class="sh">'</span><span class="s">OPEN</span><span class="sh">'</span><span class="p">].</span><span class="n">COUNTYFIPS</span><span class="p">.</span><span class="nf">value_counts</span><span class="p">())):</span>
    <span class="n">ind</span> <span class="o">=</span> <span class="p">(</span><span class="n">hospitals</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">hospitals</span><span class="p">.</span><span class="n">STATUS</span> <span class="o">==</span> <span class="sh">'</span><span class="s">OPEN</span><span class="sh">'</span><span class="p">].</span><span class="n">COUNTYFIPS</span><span class="p">.</span><span class="nf">value_counts</span><span class="p">().</span><span class="n">index</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="n">count</span> <span class="o">=</span> <span class="p">(</span><span class="n">hospitals</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">hospitals</span><span class="p">.</span><span class="n">STATUS</span> <span class="o">==</span> <span class="sh">'</span><span class="s">OPEN</span><span class="sh">'</span><span class="p">].</span><span class="nf">groupby</span><span class="p">(</span><span class="sh">'</span><span class="s">COUNTYFIPS</span><span class="sh">'</span><span class="p">).</span><span class="n">BEDS</span><span class="p">.</span><span class="nf">sum</span><span class="p">()[</span><span class="n">ind</span><span class="p">])</span>
    <span class="n">disparities</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">ind</span><span class="p">,</span> <span class="sh">'</span><span class="s">num_beds</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">count</span>

</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">disparities</span><span class="p">.</span><span class="n">num_beds</span> <span class="o">=</span> <span class="n">disparities</span><span class="p">.</span><span class="n">num_beds</span><span class="p">.</span><span class="nf">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sns</span><span class="p">.</span><span class="nf">scatterplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">disparities</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">disparities</span><span class="p">.</span><span class="n">urban</span> <span class="o">==</span> <span class="sh">'</span><span class="s">Rural</span><span class="sh">'</span><span class="p">],</span> <span class="n">x</span> <span class="o">=</span> <span class="sh">'</span><span class="s">num_hospitals_open</span><span class="sh">'</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="sh">'</span><span class="s">num_beds</span><span class="sh">'</span><span class="p">)</span><span class="c1">#, hue = 'urban')
</span></code></pre></div></div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;AxesSubplot:xlabel='num_hospitals_open', ylabel='num_beds'&gt;
</code></pre></div></div> <div class="img"> <img src="/assets/img/bb/data-science-project/output_86_1.png" style="height: 100%; width: 100%; object-fit: contain"> </div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sns</span><span class="p">.</span><span class="nf">scatterplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">disparities</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="sh">'</span><span class="s">pcp_per_100k</span><span class="sh">'</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="sh">'</span><span class="s">num_beds</span><span class="sh">'</span><span class="p">,</span> <span class="n">hue</span> <span class="o">=</span> <span class="sh">'</span><span class="s">urban</span><span class="sh">'</span><span class="p">)</span>
</code></pre></div></div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;AxesSubplot:xlabel='pcp_per_100k', ylabel='num_beds'&gt;
</code></pre></div></div> <div class="img"> <img src="/assets/img/bb/data-science-project/output_87_1.png" style="height: 100%; width: 100%; object-fit: contain"> </div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">disparities</span><span class="p">.</span><span class="nf">to_csv</span><span class="p">(</span><span class="sh">'</span><span class="s">../data/disparities.csv</span><span class="sh">'</span><span class="p">)</span>
</code></pre></div></div> <h3 id="plotting-disparities">Plotting disparities</h3> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">median_income</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nf">read_excel</span><span class="p">(</span><span class="sh">'</span><span class="s">../data/est18all.xls</span><span class="sh">'</span><span class="p">,</span>
              <span class="n">sheet_name</span> <span class="o">=</span> <span class="sh">'</span><span class="s">est18ALL</span><span class="sh">'</span><span class="p">,</span>
             <span class="n">header</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
             <span class="n">usecols</span> <span class="o">=</span> <span class="sh">'</span><span class="s">C,D,W</span><span class="sh">'</span><span class="p">)</span>
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">median_income</span><span class="p">.</span><span class="nf">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</code></pre></div></div> <div> <style scoped="">.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</style> <table border="1" class="dataframe"> <thead> <tr style="text-align: right;"> <th></th> <th>Postal Code</th> <th>Name</th> <th>Median Household Income</th> </tr> </thead> <tbody> <tr> <th>0</th> <td>US</td> <td>United States</td> <td>61937</td> </tr> <tr> <th>1</th> <td>AL</td> <td>Alabama</td> <td>49881</td> </tr> </tbody> </table> </div> <p>For this map, we only need the counties located in Tennessee.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">median_income</span> <span class="o">=</span> <span class="n">median_income</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">median_income</span><span class="p">[</span><span class="sh">'</span><span class="s">Postal Code</span><span class="sh">'</span><span class="p">]</span> <span class="o">==</span> <span class="sh">'</span><span class="s">TN</span><span class="sh">'</span><span class="p">]</span>
<span class="n">median_income</span><span class="p">.</span><span class="nf">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</code></pre></div></div> <div> <style scoped="">.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</style> <table border="1" class="dataframe"> <thead> <tr style="text-align: right;"> <th></th> <th>Postal Code</th> <th>Name</th> <th>Median Household Income</th> </tr> </thead> <tbody> <tr> <th>2471</th> <td>TN</td> <td>Tennessee</td> <td>52366</td> </tr> <tr> <th>2472</th> <td>TN</td> <td>Anderson County</td> <td>50672</td> </tr> </tbody> </table> </div> <p>We can remove the first row.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">median_income</span> <span class="o">=</span> <span class="n">median_income</span><span class="p">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
<span class="n">median_income</span><span class="p">.</span><span class="nf">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</code></pre></div></div> <div> <style scoped="">.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</style> <table border="1" class="dataframe"> <thead> <tr style="text-align: right;"> <th></th> <th>Postal Code</th> <th>Name</th> <th>Median Household Income</th> </tr> </thead> <tbody> <tr> <th>2472</th> <td>TN</td> <td>Anderson County</td> <td>50672</td> </tr> <tr> <th>2473</th> <td>TN</td> <td>Bedford County</td> <td>49860</td> </tr> </tbody> </table> </div> <p>Now, let’s read in our counties shapefiles. This one was obtained from http://www.tngis.org/administrative-boundaries.htm</p> <p>This creates a geopandas DataFrame, which is like a pandas DataFrame, but has geometry associated with it.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">counties</span> <span class="o">=</span> <span class="n">gpd</span><span class="p">.</span><span class="nf">read_file</span><span class="p">(</span><span class="sh">'</span><span class="s">../data/county/tncounty.shp</span><span class="sh">'</span><span class="p">)</span>
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">counties</span><span class="p">.</span><span class="nf">head</span><span class="p">()</span>
</code></pre></div></div> <div> <style scoped="">.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</style> <table border="1" class="dataframe"> <thead> <tr style="text-align: right;"> <th></th> <th>OBJECTID</th> <th>NAME</th> <th>KEY</th> <th>SHAPE_AREA</th> <th>SHAPE_LEN</th> <th>geometry</th> </tr> </thead> <tbody> <tr> <th>0</th> <td>76</td> <td>Chester</td> <td>47023</td> <td>8.049024e+09</td> <td>520461.080124</td> <td>POLYGON ((1137985.762 344601.643, 1137965.070 ...</td> </tr> <tr> <th>1</th> <td>77</td> <td>Wayne</td> <td>47181</td> <td>2.050741e+10</td> <td>666520.678598</td> <td>POLYGON ((1365052.057 391716.806, 1365746.554 ...</td> </tr> <tr> <th>2</th> <td>78</td> <td>Tipton</td> <td>47167</td> <td>1.319125e+10</td> <td>865093.887634</td> <td>MULTIPOLYGON (((886814.330 400456.525, 886774....</td> </tr> <tr> <th>3</th> <td>79</td> <td>Hamilton</td> <td>47065</td> <td>1.604776e+10</td> <td>652926.001078</td> <td>POLYGON ((2274954.438 239788.911, 2274090.610 ...</td> </tr> <tr> <th>4</th> <td>80</td> <td>Stewart</td> <td>47161</td> <td>1.375003e+10</td> <td>490090.336180</td> <td>POLYGON ((1382472.783 743972.302, 1382445.171 ...</td> </tr> </tbody> </table> </div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">median_income</span><span class="p">[</span><span class="sh">'</span><span class="s">NAME</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">median_income</span><span class="p">[</span><span class="sh">'</span><span class="s">Name</span><span class="sh">'</span><span class="p">].</span><span class="nb">str</span><span class="p">[:</span><span class="o">-</span><span class="mi">7</span><span class="p">]</span>
<span class="n">counties</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nf">merge</span><span class="p">(</span><span class="n">left</span> <span class="o">=</span> <span class="n">counties</span><span class="p">,</span>
                    <span class="n">right</span> <span class="o">=</span> <span class="n">median_income</span><span class="p">[[</span><span class="sh">'</span><span class="s">NAME</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Median Household Income</span><span class="sh">'</span><span class="p">]])</span>
<span class="n">counties</span><span class="p">[</span><span class="sh">'</span><span class="s">Median Household Income</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nf">to_numeric</span><span class="p">(</span><span class="n">counties</span><span class="p">[</span><span class="sh">'</span><span class="s">Median Household Income</span><span class="sh">'</span><span class="p">])</span>
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">matplotlib.lines</span> <span class="kn">import</span> <span class="n">Line2D</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>

<span class="n">counties</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">column</span> <span class="o">=</span> <span class="sh">'</span><span class="s">Median Household Income</span><span class="sh">'</span><span class="p">,</span> 
              <span class="n">edgecolor</span> <span class="o">=</span> <span class="sh">'</span><span class="s">black</span><span class="sh">'</span><span class="p">,</span>
              <span class="n">legend</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span>
              <span class="n">cmap</span> <span class="o">=</span> <span class="sh">'</span><span class="s">Blues</span><span class="sh">'</span><span class="p">,</span>
              <span class="n">scheme</span><span class="o">=</span><span class="sh">"</span><span class="s">NaturalBreaks</span><span class="sh">"</span><span class="p">,</span>
              <span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span><span class="p">)</span>

<span class="n">leg</span> <span class="o">=</span> <span class="n">ax</span><span class="p">.</span><span class="nf">get_legend</span><span class="p">()</span>

<span class="c1"># Adjust the formatting of the legend
</span><span class="n">labels</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">n</span> <span class="o">=</span> <span class="nf">len</span><span class="p">(</span><span class="n">leg</span><span class="p">.</span><span class="nf">get_texts</span><span class="p">())</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">lbl</span> <span class="ow">in</span> <span class="nf">enumerate</span><span class="p">(</span><span class="n">leg</span><span class="p">.</span><span class="nf">get_texts</span><span class="p">()):</span>
    <span class="n">label_text</span> <span class="o">=</span> <span class="n">lbl</span><span class="p">.</span><span class="nf">get_text</span><span class="p">()</span>
    <span class="n">lower</span> <span class="o">=</span> <span class="nf">float</span><span class="p">(</span><span class="n">label_text</span><span class="p">.</span><span class="nf">split</span><span class="p">()[</span><span class="mi">0</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">upper</span> <span class="o">=</span> <span class="nf">float</span><span class="p">(</span><span class="n">label_text</span><span class="p">.</span><span class="nf">split</span><span class="p">()[</span><span class="mi">1</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">new_text</span> <span class="o">=</span> <span class="sh">"</span><span class="s">Below </span><span class="sh">"</span> <span class="o">+</span> <span class="sh">"</span><span class="s">\${:,.0f}</span><span class="sh">"</span><span class="p">.</span><span class="nf">format</span><span class="p">(</span><span class="n">upper</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">i</span> <span class="o">==</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">new_text</span> <span class="o">=</span> <span class="sh">"</span><span class="s">Above </span><span class="sh">"</span> <span class="o">+</span> <span class="sh">"</span><span class="s">\${:,.0f}</span><span class="sh">"</span><span class="p">.</span><span class="nf">format</span><span class="p">(</span><span class="n">lower</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">new_text</span> <span class="o">=</span> <span class="sh">"</span><span class="s">\${:,.0f}</span><span class="sh">"</span><span class="p">.</span><span class="nf">format</span><span class="p">(</span><span class="n">lower</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="sh">"</span><span class="s"> - </span><span class="sh">"</span> <span class="o">+</span> <span class="sh">"</span><span class="s">\${:,.0f}</span><span class="sh">"</span><span class="p">.</span><span class="nf">format</span><span class="p">(</span><span class="n">upper</span><span class="p">)</span>
        
    <span class="n">labels</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">new_text</span><span class="p">)</span>

<span class="c1"># Adjust the marker appearance
# Extract the old markers and then modify by setting the edgecolor and edgewidth
</span><span class="n">markers</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">leg</span><span class="p">.</span><span class="nf">get_lines</span><span class="p">():</span>
    <span class="n">marker</span> <span class="o">=</span> <span class="nc">Line2D</span><span class="p">([</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">],</span> <span class="n">marker</span> <span class="o">=</span> <span class="sh">'</span><span class="s">o</span><span class="sh">'</span><span class="p">,</span> 
                    <span class="n">markersize</span> <span class="o">=</span> <span class="n">line</span><span class="p">.</span><span class="nf">get_markersize</span><span class="p">(),</span> 
                    <span class="n">color</span> <span class="o">=</span> <span class="n">line</span><span class="p">.</span><span class="nf">get_markerfacecolor</span><span class="p">(),</span>
                    <span class="n">linestyle</span> <span class="o">=</span> <span class="sh">'</span><span class="s">None</span><span class="sh">'</span><span class="p">,</span>
                    <span class="n">markeredgecolor</span> <span class="o">=</span> <span class="sh">'</span><span class="s">black</span><span class="sh">'</span><span class="p">,</span>
                    <span class="n">markeredgewidth</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">markers</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">marker</span><span class="p">)</span>

<span class="c1"># Redraw the legend with the new labels and markers
</span><span class="n">plt</span><span class="p">.</span><span class="nf">legend</span><span class="p">(</span><span class="n">markers</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">leg</span> <span class="o">=</span> <span class="n">ax</span><span class="p">.</span><span class="nf">get_legend</span><span class="p">()</span>
<span class="n">leg</span><span class="p">.</span><span class="nf">set_bbox_to_anchor</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">))</span>
    
<span class="n">plt</span><span class="p">.</span><span class="nf">title</span><span class="p">(</span><span class="sh">'</span><span class="s">Median Household Income by County, 2018</span><span class="sh">'</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">18</span><span class="p">)</span>

<span class="n">ax</span><span class="p">.</span><span class="nf">axis</span><span class="p">(</span><span class="sh">'</span><span class="s">off</span><span class="sh">'</span><span class="p">);</span>
</code></pre></div></div> <div class="img"> <img src="/assets/img/bb/data-science-project/output_100_0.png" style="height: 100%; width: 100%; object-fit: contain"> </div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">counties</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nf">merge</span><span class="p">(</span><span class="n">left</span> <span class="o">=</span> <span class="n">counties</span><span class="p">,</span> <span class="n">left_on</span> <span class="o">=</span> <span class="sh">'</span><span class="s">NAME</span><span class="sh">'</span><span class="p">,</span>
         <span class="n">right</span> <span class="o">=</span> <span class="n">disparities</span><span class="p">,</span> <span class="n">right_on</span> <span class="o">=</span> <span class="sh">'</span><span class="s">county</span><span class="sh">'</span><span class="p">)</span>
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">counties</span>
</code></pre></div></div> <div> <style scoped="">.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</style> <table border="1" class="dataframe"> <thead> <tr style="text-align: right;"> <th></th> <th>OBJECTID</th> <th>NAME</th> <th>KEY</th> <th>SHAPE_AREA</th> <th>SHAPE_LEN</th> <th>geometry</th> <th>Median Household Income</th> <th>year</th> <th>primary_sex</th> <th>primary_age</th> <th>...</th> <th>county</th> <th>primary_care_physicians</th> <th>population</th> <th>urban</th> <th>shadac_category</th> <th>pcp_per_100k</th> <th>num_hospitals</th> <th>num_hospitals_open</th> <th>mean_beds</th> <th>num_beds</th> </tr> </thead> <tbody> <tr> <th>0</th> <td>76</td> <td>Chester</td> <td>47023</td> <td>8.049024e+09</td> <td>520461.080124</td> <td>POLYGON ((1137985.762 344601.643, 1137965.070 ...</td> <td>47508</td> <td>2019</td> <td>All</td> <td>All</td> <td>...</td> <td>Chester</td> <td>4.0</td> <td>17190</td> <td>Urban</td> <td>low inadequate</td> <td>23.269343</td> <td>0.0</td> <td>0.0</td> <td>NaN</td> <td>0.0</td> </tr> <tr> <th>1</th> <td>77</td> <td>Wayne</td> <td>47181</td> <td>2.050741e+10</td> <td>666520.678598</td> <td>POLYGON ((1365052.057 391716.806, 1365746.554 ...</td> <td>38879</td> <td>2019</td> <td>All</td> <td>All</td> <td>...</td> <td>Wayne</td> <td>5.0</td> <td>16693</td> <td>Rural</td> <td>moderately adequate</td> <td>29.952675</td> <td>1.0</td> <td>1.0</td> <td>80.0</td> <td>80.0</td> </tr> <tr> <th>2</th> <td>78</td> <td>Tipton</td> <td>47167</td> <td>1.319125e+10</td> <td>865093.887634</td> <td>MULTIPOLYGON (((886814.330 400456.525, 886774....</td> <td>60874</td> <td>2019</td> <td>All</td> <td>All</td> <td>...</td> <td>Tipton</td> <td>17.0</td> <td>61447</td> <td>Urban</td> <td>low inadequate</td> <td>27.666119</td> <td>1.0</td> <td>1.0</td> <td>100.0</td> <td>100.0</td> </tr> <tr> <th>3</th> <td>79</td> <td>Hamilton</td> <td>47065</td> <td>1.604776e+10</td> <td>652926.001078</td> <td>POLYGON ((2274954.438 239788.911, 2274090.610 ...</td> <td>57196</td> <td>2019</td> <td>All</td> <td>All</td> <td>...</td> <td>Hamilton</td> <td>403.0</td> <td>360919</td> <td>Urban</td> <td>adequate</td> <td>111.659403</td> <td>13.0</td> <td>12.0</td> <td>160.0</td> <td>1920.0</td> </tr> <tr> <th>4</th> <td>80</td> <td>Stewart</td> <td>47161</td> <td>1.375003e+10</td> <td>490090.336180</td> <td>POLYGON ((1382472.783 743972.302, 1382445.171 ...</td> <td>46565</td> <td>2019</td> <td>All</td> <td>All</td> <td>...</td> <td>Stewart</td> <td>1.0</td> <td>13427</td> <td>Urban</td> <td>low inadequate</td> <td>7.447680</td> <td>0.0</td> <td>0.0</td> <td>NaN</td> <td>0.0</td> </tr> <tr> <th>...</th> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> </tr> <tr> <th>90</th> <td>91</td> <td>McNairy</td> <td>47109</td> <td>1.563586e+10</td> <td>566369.132062</td> <td>POLYGON ((1137985.762 344601.643, 1139350.519 ...</td> <td>39859</td> <td>2019</td> <td>All</td> <td>All</td> <td>...</td> <td>McNairy</td> <td>9.0</td> <td>25844</td> <td>Rural</td> <td>moderately adequate</td> <td>34.824331</td> <td>0.0</td> <td>0.0</td> <td>NaN</td> <td>0.0</td> </tr> <tr> <th>91</th> <td>92</td> <td>Franklin</td> <td>47051</td> <td>1.605093e+10</td> <td>621176.096919</td> <td>POLYGON ((1873015.265 239618.144, 1872957.848 ...</td> <td>50201</td> <td>2019</td> <td>All</td> <td>All</td> <td>...</td> <td>Franklin</td> <td>27.0</td> <td>41725</td> <td>Rural</td> <td>moderately adequate</td> <td>64.709407</td> <td>2.0</td> <td>2.0</td> <td>86.5</td> <td>173.0</td> </tr> <tr> <th>92</th> <td>93</td> <td>Bradley</td> <td>47011</td> <td>9.241234e+09</td> <td>457372.233476</td> <td>POLYGON ((2274954.438 239788.911, 2275552.803 ...</td> <td>50427</td> <td>2019</td> <td>All</td> <td>All</td> <td>...</td> <td>Bradley</td> <td>55.0</td> <td>105749</td> <td>Urban</td> <td>moderately adequate</td> <td>52.009948</td> <td>2.0</td> <td>2.0</td> <td>174.0</td> <td>348.0</td> </tr> <tr> <th>93</th> <td>94</td> <td>Marion</td> <td>47115</td> <td>1.428734e+10</td> <td>529431.591556</td> <td>POLYGON ((2126056.390 236919.771, 2122873.509 ...</td> <td>50819</td> <td>2019</td> <td>All</td> <td>All</td> <td>...</td> <td>Marion</td> <td>12.0</td> <td>28538</td> <td>Urban</td> <td>moderately adequate</td> <td>42.049198</td> <td>1.0</td> <td>1.0</td> <td>68.0</td> <td>68.0</td> </tr> <tr> <th>94</th> <td>95</td> <td>Polk</td> <td>47139</td> <td>1.233228e+10</td> <td>479994.126988</td> <td>POLYGON ((2355580.184 332970.851, 2355673.384 ...</td> <td>41968</td> <td>2019</td> <td>All</td> <td>All</td> <td>...</td> <td>Polk</td> <td>8.0</td> <td>16814</td> <td>Urban</td> <td>moderately adequate</td> <td>47.579398</td> <td>1.0</td> <td>0.0</td> <td>NaN</td> <td>0.0</td> </tr> </tbody> </table> <p>95 rows × 36 columns</p> </div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">counties</span>
</code></pre></div></div> <div> <style scoped="">.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</style> <table border="1" class="dataframe"> <thead> <tr style="text-align: right;"> <th></th> <th>OBJECTID</th> <th>NAME</th> <th>KEY</th> <th>SHAPE_AREA</th> <th>SHAPE_LEN</th> <th>geometry</th> <th>Median Household Income</th> <th>year</th> <th>primary_sex</th> <th>primary_age</th> <th>...</th> <th>primary_care_physicians</th> <th>population</th> <th>urban</th> <th>shadac_category</th> <th>pcp_per_100k</th> <th>num_hospitals</th> <th>num_hospitals_open</th> <th>mean_beds</th> <th>num_beds</th> <th>num_hospitals_per_100k</th> </tr> </thead> <tbody> <tr> <th>0</th> <td>76</td> <td>Chester</td> <td>47023</td> <td>8.049024e+09</td> <td>520461.080124</td> <td>POLYGON ((1137985.762 344601.643, 1137965.070 ...</td> <td>47508</td> <td>2019</td> <td>All</td> <td>All</td> <td>...</td> <td>4.0</td> <td>17190</td> <td>Urban</td> <td>low inadequate</td> <td>23.269343</td> <td>0.0</td> <td>0.0</td> <td>NaN</td> <td>0.0</td> <td>0.000000</td> </tr> <tr> <th>1</th> <td>77</td> <td>Wayne</td> <td>47181</td> <td>2.050741e+10</td> <td>666520.678598</td> <td>POLYGON ((1365052.057 391716.806, 1365746.554 ...</td> <td>38879</td> <td>2019</td> <td>All</td> <td>All</td> <td>...</td> <td>5.0</td> <td>16693</td> <td>Rural</td> <td>moderately adequate</td> <td>29.952675</td> <td>1.0</td> <td>1.0</td> <td>80.0</td> <td>80.0</td> <td>5.990535</td> </tr> <tr> <th>2</th> <td>78</td> <td>Tipton</td> <td>47167</td> <td>1.319125e+10</td> <td>865093.887634</td> <td>MULTIPOLYGON (((886814.330 400456.525, 886774....</td> <td>60874</td> <td>2019</td> <td>All</td> <td>All</td> <td>...</td> <td>17.0</td> <td>61447</td> <td>Urban</td> <td>low inadequate</td> <td>27.666119</td> <td>1.0</td> <td>1.0</td> <td>100.0</td> <td>100.0</td> <td>1.627419</td> </tr> <tr> <th>3</th> <td>79</td> <td>Hamilton</td> <td>47065</td> <td>1.604776e+10</td> <td>652926.001078</td> <td>POLYGON ((2274954.438 239788.911, 2274090.610 ...</td> <td>57196</td> <td>2019</td> <td>All</td> <td>All</td> <td>...</td> <td>403.0</td> <td>360919</td> <td>Urban</td> <td>adequate</td> <td>111.659403</td> <td>13.0</td> <td>12.0</td> <td>160.0</td> <td>1920.0</td> <td>3.324846</td> </tr> <tr> <th>4</th> <td>80</td> <td>Stewart</td> <td>47161</td> <td>1.375003e+10</td> <td>490090.336180</td> <td>POLYGON ((1382472.783 743972.302, 1382445.171 ...</td> <td>46565</td> <td>2019</td> <td>All</td> <td>All</td> <td>...</td> <td>1.0</td> <td>13427</td> <td>Urban</td> <td>low inadequate</td> <td>7.447680</td> <td>0.0</td> <td>0.0</td> <td>NaN</td> <td>0.0</td> <td>0.000000</td> </tr> <tr> <th>...</th> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> </tr> <tr> <th>90</th> <td>91</td> <td>McNairy</td> <td>47109</td> <td>1.563586e+10</td> <td>566369.132062</td> <td>POLYGON ((1137985.762 344601.643, 1139350.519 ...</td> <td>39859</td> <td>2019</td> <td>All</td> <td>All</td> <td>...</td> <td>9.0</td> <td>25844</td> <td>Rural</td> <td>moderately adequate</td> <td>34.824331</td> <td>0.0</td> <td>0.0</td> <td>NaN</td> <td>0.0</td> <td>0.000000</td> </tr> <tr> <th>91</th> <td>92</td> <td>Franklin</td> <td>47051</td> <td>1.605093e+10</td> <td>621176.096919</td> <td>POLYGON ((1873015.265 239618.144, 1872957.848 ...</td> <td>50201</td> <td>2019</td> <td>All</td> <td>All</td> <td>...</td> <td>27.0</td> <td>41725</td> <td>Rural</td> <td>moderately adequate</td> <td>64.709407</td> <td>2.0</td> <td>2.0</td> <td>86.5</td> <td>173.0</td> <td>4.793289</td> </tr> <tr> <th>92</th> <td>93</td> <td>Bradley</td> <td>47011</td> <td>9.241234e+09</td> <td>457372.233476</td> <td>POLYGON ((2274954.438 239788.911, 2275552.803 ...</td> <td>50427</td> <td>2019</td> <td>All</td> <td>All</td> <td>...</td> <td>55.0</td> <td>105749</td> <td>Urban</td> <td>moderately adequate</td> <td>52.009948</td> <td>2.0</td> <td>2.0</td> <td>174.0</td> <td>348.0</td> <td>1.891271</td> </tr> <tr> <th>93</th> <td>94</td> <td>Marion</td> <td>47115</td> <td>1.428734e+10</td> <td>529431.591556</td> <td>POLYGON ((2126056.390 236919.771, 2122873.509 ...</td> <td>50819</td> <td>2019</td> <td>All</td> <td>All</td> <td>...</td> <td>12.0</td> <td>28538</td> <td>Urban</td> <td>moderately adequate</td> <td>42.049198</td> <td>1.0</td> <td>1.0</td> <td>68.0</td> <td>68.0</td> <td>3.504100</td> </tr> <tr> <th>94</th> <td>95</td> <td>Polk</td> <td>47139</td> <td>1.233228e+10</td> <td>479994.126988</td> <td>POLYGON ((2355580.184 332970.851, 2355673.384 ...</td> <td>41968</td> <td>2019</td> <td>All</td> <td>All</td> <td>...</td> <td>8.0</td> <td>16814</td> <td>Urban</td> <td>moderately adequate</td> <td>47.579398</td> <td>1.0</td> <td>0.0</td> <td>NaN</td> <td>0.0</td> <td>0.000000</td> </tr> </tbody> </table> <p>95 rows × 37 columns</p> </div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">matplotlib.lines</span> <span class="kn">import</span> <span class="n">Line2D</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>

<span class="n">counties</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">column</span> <span class="o">=</span> <span class="sh">'</span><span class="s">num_hospitals_per_100k</span><span class="sh">'</span><span class="p">,</span> 
              <span class="n">edgecolor</span> <span class="o">=</span> <span class="sh">'</span><span class="s">black</span><span class="sh">'</span><span class="p">,</span>
              <span class="n">legend</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span>
              <span class="n">cmap</span> <span class="o">=</span> <span class="sh">'</span><span class="s">Blues</span><span class="sh">'</span><span class="p">,</span>
              <span class="n">scheme</span><span class="o">=</span><span class="sh">"</span><span class="s">Quantiles</span><span class="sh">"</span><span class="p">,</span>
              <span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span><span class="p">,</span>
              <span class="c1"># missing_kwds={
</span>              <span class="c1"># "color": "lightgrey",
</span>              <span class="c1"># "edgecolor": "grey",
</span>              <span class="c1"># "label": "Missing values",
</span>              <span class="c1"># },
</span>              <span class="c1"># classification_kwds ={k : 10}
</span><span class="p">)</span>

<span class="n">leg</span> <span class="o">=</span> <span class="n">ax</span><span class="p">.</span><span class="nf">get_legend</span><span class="p">()</span>

<span class="c1"># Adjust the formatting of the legend
</span><span class="n">labels</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">n</span> <span class="o">=</span> <span class="nf">len</span><span class="p">(</span><span class="n">leg</span><span class="p">.</span><span class="nf">get_texts</span><span class="p">())</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">lbl</span> <span class="ow">in</span> <span class="nf">enumerate</span><span class="p">(</span><span class="n">leg</span><span class="p">.</span><span class="nf">get_texts</span><span class="p">()):</span>
    <span class="n">label_text</span> <span class="o">=</span> <span class="n">lbl</span><span class="p">.</span><span class="nf">get_text</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">label_text</span> <span class="o">==</span> <span class="sh">'</span><span class="s">Missing values</span><span class="sh">'</span><span class="p">:</span> 
        <span class="n">labels</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">label_text</span><span class="p">)</span>
        <span class="k">continue</span>
    <span class="n">lower</span> <span class="o">=</span> <span class="nf">float</span><span class="p">(</span><span class="n">label_text</span><span class="p">.</span><span class="nf">split</span><span class="p">()[</span><span class="mi">0</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">upper</span> <span class="o">=</span> <span class="nf">float</span><span class="p">(</span><span class="n">label_text</span><span class="p">.</span><span class="nf">split</span><span class="p">()[</span><span class="mi">1</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">new_text</span> <span class="o">=</span> <span class="sh">"</span><span class="s">Below </span><span class="sh">"</span> <span class="o">+</span> <span class="sh">"</span><span class="s">{:,.0f}</span><span class="sh">"</span><span class="p">.</span><span class="nf">format</span><span class="p">(</span><span class="n">upper</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">i</span> <span class="o">==</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">new_text</span> <span class="o">=</span> <span class="sh">"</span><span class="s">Above </span><span class="sh">"</span> <span class="o">+</span> <span class="sh">"</span><span class="s">{:,.0f}</span><span class="sh">"</span><span class="p">.</span><span class="nf">format</span><span class="p">(</span><span class="n">lower</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">new_text</span> <span class="o">=</span> <span class="sh">"</span><span class="s">{:,.0f}</span><span class="sh">"</span><span class="p">.</span><span class="nf">format</span><span class="p">(</span><span class="n">lower</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="sh">"</span><span class="s"> - </span><span class="sh">"</span> <span class="o">+</span> <span class="sh">"</span><span class="s">{:,.0f}</span><span class="sh">"</span><span class="p">.</span><span class="nf">format</span><span class="p">(</span><span class="n">upper</span><span class="p">)</span>
        
    <span class="n">labels</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">new_text</span><span class="p">)</span>

<span class="c1"># Adjust the marker appearance
# Extract the old markers and then modify by setting the edgecolor and edgewidth
</span><span class="n">markers</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">leg</span><span class="p">.</span><span class="nf">get_lines</span><span class="p">():</span>
    <span class="n">marker</span> <span class="o">=</span> <span class="nc">Line2D</span><span class="p">([</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">],</span> <span class="n">marker</span> <span class="o">=</span> <span class="sh">'</span><span class="s">o</span><span class="sh">'</span><span class="p">,</span> 
                    <span class="n">markersize</span> <span class="o">=</span> <span class="n">line</span><span class="p">.</span><span class="nf">get_markersize</span><span class="p">(),</span> 
                    <span class="n">color</span> <span class="o">=</span> <span class="n">line</span><span class="p">.</span><span class="nf">get_markerfacecolor</span><span class="p">(),</span>
                    <span class="n">linestyle</span> <span class="o">=</span> <span class="sh">'</span><span class="s">None</span><span class="sh">'</span><span class="p">,</span>
                    <span class="n">markeredgecolor</span> <span class="o">=</span> <span class="sh">'</span><span class="s">black</span><span class="sh">'</span><span class="p">,</span>
                    <span class="n">markeredgewidth</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">markers</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">marker</span><span class="p">)</span>

<span class="c1"># Redraw the legend with the new labels and markers
</span><span class="n">plt</span><span class="p">.</span><span class="nf">legend</span><span class="p">(</span><span class="n">markers</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">leg</span> <span class="o">=</span> <span class="n">ax</span><span class="p">.</span><span class="nf">get_legend</span><span class="p">()</span>
<span class="n">leg</span><span class="p">.</span><span class="nf">set_bbox_to_anchor</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">))</span>
    
<span class="n">plt</span><span class="p">.</span><span class="nf">title</span><span class="p">(</span><span class="sh">'</span><span class="s">Number of Hospitals per 100K Residents by County</span><span class="sh">'</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">18</span><span class="p">)</span>

<span class="n">ax</span><span class="p">.</span><span class="nf">axis</span><span class="p">(</span><span class="sh">'</span><span class="s">off</span><span class="sh">'</span><span class="p">);</span>
</code></pre></div></div> <div class="img"> <img src="/assets/img/bb/data-science-project/output_104_0.png" style="height: 100%; width: 100%; object-fit: contain"> </div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">matplotlib.lines</span> <span class="kn">import</span> <span class="n">Line2D</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>

<span class="n">counties</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">column</span> <span class="o">=</span> <span class="sh">'</span><span class="s">pcp_per_100k</span><span class="sh">'</span><span class="p">,</span> 
              <span class="n">edgecolor</span> <span class="o">=</span> <span class="sh">'</span><span class="s">black</span><span class="sh">'</span><span class="p">,</span>
              <span class="n">legend</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span>
              <span class="n">cmap</span> <span class="o">=</span> <span class="sh">'</span><span class="s">Blues</span><span class="sh">'</span><span class="p">,</span>
              <span class="n">scheme</span><span class="o">=</span><span class="sh">"</span><span class="s">Quantiles</span><span class="sh">"</span><span class="p">,</span>
              <span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span><span class="p">,</span>
              <span class="c1"># missing_kwds={
</span>              <span class="c1"># "color": "lightgrey",
</span>              <span class="c1"># "edgecolor": "grey",
</span>              <span class="c1"># "label": "Missing values",
</span>              <span class="c1"># },
</span>              <span class="c1"># classification_kwds ={k : 10}
</span><span class="p">)</span>

<span class="n">leg</span> <span class="o">=</span> <span class="n">ax</span><span class="p">.</span><span class="nf">get_legend</span><span class="p">()</span>

<span class="c1"># Adjust the formatting of the legend
</span><span class="n">labels</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">n</span> <span class="o">=</span> <span class="nf">len</span><span class="p">(</span><span class="n">leg</span><span class="p">.</span><span class="nf">get_texts</span><span class="p">())</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">lbl</span> <span class="ow">in</span> <span class="nf">enumerate</span><span class="p">(</span><span class="n">leg</span><span class="p">.</span><span class="nf">get_texts</span><span class="p">()):</span>
    <span class="n">label_text</span> <span class="o">=</span> <span class="n">lbl</span><span class="p">.</span><span class="nf">get_text</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">label_text</span> <span class="o">==</span> <span class="sh">'</span><span class="s">Missing values</span><span class="sh">'</span><span class="p">:</span> 
        <span class="n">labels</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">label_text</span><span class="p">)</span>
        <span class="k">continue</span>
    <span class="n">lower</span> <span class="o">=</span> <span class="nf">float</span><span class="p">(</span><span class="n">label_text</span><span class="p">.</span><span class="nf">split</span><span class="p">()[</span><span class="mi">0</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">upper</span> <span class="o">=</span> <span class="nf">float</span><span class="p">(</span><span class="n">label_text</span><span class="p">.</span><span class="nf">split</span><span class="p">()[</span><span class="mi">1</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">new_text</span> <span class="o">=</span> <span class="sh">"</span><span class="s">Below </span><span class="sh">"</span> <span class="o">+</span> <span class="sh">"</span><span class="s">{:,.0f}</span><span class="sh">"</span><span class="p">.</span><span class="nf">format</span><span class="p">(</span><span class="n">upper</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">i</span> <span class="o">==</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">new_text</span> <span class="o">=</span> <span class="sh">"</span><span class="s">Above </span><span class="sh">"</span> <span class="o">+</span> <span class="sh">"</span><span class="s">{:,.0f}</span><span class="sh">"</span><span class="p">.</span><span class="nf">format</span><span class="p">(</span><span class="n">lower</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">new_text</span> <span class="o">=</span> <span class="sh">"</span><span class="s">{:,.0f}</span><span class="sh">"</span><span class="p">.</span><span class="nf">format</span><span class="p">(</span><span class="n">lower</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="sh">"</span><span class="s"> - </span><span class="sh">"</span> <span class="o">+</span> <span class="sh">"</span><span class="s">{:,.0f}</span><span class="sh">"</span><span class="p">.</span><span class="nf">format</span><span class="p">(</span><span class="n">upper</span><span class="p">)</span>
        
    <span class="n">labels</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">new_text</span><span class="p">)</span>

<span class="c1"># Adjust the marker appearance
# Extract the old markers and then modify by setting the edgecolor and edgewidth
</span><span class="n">markers</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">leg</span><span class="p">.</span><span class="nf">get_lines</span><span class="p">():</span>
    <span class="n">marker</span> <span class="o">=</span> <span class="nc">Line2D</span><span class="p">([</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">],</span> <span class="n">marker</span> <span class="o">=</span> <span class="sh">'</span><span class="s">o</span><span class="sh">'</span><span class="p">,</span> 
                    <span class="n">markersize</span> <span class="o">=</span> <span class="n">line</span><span class="p">.</span><span class="nf">get_markersize</span><span class="p">(),</span> 
                    <span class="n">color</span> <span class="o">=</span> <span class="n">line</span><span class="p">.</span><span class="nf">get_markerfacecolor</span><span class="p">(),</span>
                    <span class="n">linestyle</span> <span class="o">=</span> <span class="sh">'</span><span class="s">None</span><span class="sh">'</span><span class="p">,</span>
                    <span class="n">markeredgecolor</span> <span class="o">=</span> <span class="sh">'</span><span class="s">black</span><span class="sh">'</span><span class="p">,</span>
                    <span class="n">markeredgewidth</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">markers</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">marker</span><span class="p">)</span>

<span class="c1"># Redraw the legend with the new labels and markers
</span><span class="n">plt</span><span class="p">.</span><span class="nf">legend</span><span class="p">(</span><span class="n">markers</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">leg</span> <span class="o">=</span> <span class="n">ax</span><span class="p">.</span><span class="nf">get_legend</span><span class="p">()</span>
<span class="n">leg</span><span class="p">.</span><span class="nf">set_bbox_to_anchor</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">))</span>
    
<span class="n">plt</span><span class="p">.</span><span class="nf">title</span><span class="p">(</span><span class="sh">'</span><span class="s">Number of PCP per 100K Residents by County</span><span class="sh">'</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">18</span><span class="p">)</span>

<span class="n">ax</span><span class="p">.</span><span class="nf">axis</span><span class="p">(</span><span class="sh">'</span><span class="s">off</span><span class="sh">'</span><span class="p">);</span>
</code></pre></div></div> <div class="img"> <img src="/assets/img/bb/data-science-project/output_105_0.png" style="height: 100%; width: 100%; object-fit: contain"> </div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sns</span><span class="p">.</span><span class="nf">scatterplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">counties</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="sh">'</span><span class="s">Median Household Income</span><span class="sh">'</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="sh">'</span><span class="s">num_beds</span><span class="sh">'</span><span class="p">,</span> <span class="n">hue</span> <span class="o">=</span> <span class="sh">'</span><span class="s">shadac_category</span><span class="sh">'</span><span class="p">)</span>
</code></pre></div></div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;AxesSubplot:xlabel='Median Household Income', ylabel='num_beds'&gt;
</code></pre></div></div> <div class="img"> <img src="/assets/img/bb/data-science-project/output_106_1.png" style="height: 100%; width: 100%; object-fit: contain"> </div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">counties</span><span class="p">[</span><span class="sh">'</span><span class="s">num_hospitals_per_100k</span><span class="sh">'</span><span class="p">]</span><span class="o">=</span><span class="n">counties</span><span class="p">.</span><span class="n">num_hospitals_open</span><span class="o">/</span><span class="n">counties</span><span class="p">.</span><span class="n">population</span><span class="o">*</span><span class="mi">100000</span>
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sns</span><span class="p">.</span><span class="nf">scatterplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">counties</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="sh">'</span><span class="s">Median Household Income</span><span class="sh">'</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="sh">'</span><span class="s">num_hospitals_open</span><span class="sh">'</span><span class="p">,</span> <span class="n">hue</span> <span class="o">=</span> <span class="sh">'</span><span class="s">shadac_category</span><span class="sh">'</span><span class="p">)</span>
</code></pre></div></div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;AxesSubplot:xlabel='Median Household Income', ylabel='num_hospitals_open'&gt;
</code></pre></div></div> <div class="img"> <img src="/assets/img/bb/data-science-project/output_108_1.png" style="height: 100%; width: 100%; object-fit: contain"> </div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sns</span><span class="p">.</span><span class="nf">scatterplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">counties</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="sh">'</span><span class="s">Median Household Income</span><span class="sh">'</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="sh">'</span><span class="s">num_hospitals_per_100k</span><span class="sh">'</span><span class="p">,</span> <span class="n">hue</span> <span class="o">=</span> <span class="sh">'</span><span class="s">urban</span><span class="sh">'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">ylabel</span><span class="p">(</span><span class="sh">"</span><span class="s">Number Open Hospitals per 100K Residents</span><span class="sh">"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">savefig</span><span class="p">(</span><span class="sh">'</span><span class="s">income_vs_hosp_urban.pdf</span><span class="sh">'</span><span class="p">)</span>
</code></pre></div></div> <div class="img"> <img src="/assets/img/bb/data-science-project/output_109_0.png" style="height: 100%; width: 100%; object-fit: contain"> </div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">disparities</span><span class="p">.</span><span class="nf">sort_values</span><span class="p">([</span><span class="sh">'</span><span class="s">pcp_per_100k</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">population</span><span class="sh">'</span><span class="p">],</span> <span class="n">ascending</span> <span class="o">=</span> <span class="p">[</span><span class="bp">True</span><span class="p">,</span><span class="bp">False</span><span class="p">])[[</span><span class="sh">'</span><span class="s">county</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">num_beds</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">num_hospitals</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">pcp_per_100k</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">population</span><span class="sh">'</span><span class="p">]][</span><span class="mi">0</span><span class="p">:</span><span class="mi">25</span><span class="p">]</span>
</code></pre></div></div> <div> <style scoped="">.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</style> <table border="1" class="dataframe"> <thead> <tr style="text-align: right;"> <th></th> <th>county</th> <th>num_beds</th> <th>num_hospitals</th> <th>pcp_per_100k</th> <th>population</th> </tr> <tr> <th>FIPS</th> <th></th> <th></th> <th></th> <th></th> <th></th> </tr> </thead> <tbody> <tr> <th>47033</th> <td>Crockett</td> <td>0.0</td> <td>0.0</td> <td>0.000000</td> <td>14399</td> </tr> <tr> <th>47061</th> <td>Grundy</td> <td>0.0</td> <td>0.0</td> <td>0.000000</td> <td>13344</td> </tr> <tr> <th>47095</th> <td>Lake</td> <td>0.0</td> <td>0.0</td> <td>0.000000</td> <td>7401</td> </tr> <tr> <th>47175</th> <td>Van Buren</td> <td>0.0</td> <td>0.0</td> <td>0.000000</td> <td>5760</td> </tr> <tr> <th>47007</th> <td>Bledsoe</td> <td>25.0</td> <td>1.0</td> <td>6.740361</td> <td>14836</td> </tr> <tr> <th>47161</th> <td>Stewart</td> <td>0.0</td> <td>0.0</td> <td>7.447680</td> <td>13427</td> </tr> <tr> <th>47097</th> <td>Lauderdale</td> <td>25.0</td> <td>1.0</td> <td>7.695564</td> <td>25989</td> </tr> <tr> <th>47129</th> <td>Morgan</td> <td>0.0</td> <td>0.0</td> <td>13.924344</td> <td>21545</td> </tr> <tr> <th>47117</th> <td>Marshall</td> <td>25.0</td> <td>1.0</td> <td>15.167602</td> <td>32965</td> </tr> <tr> <th>47067</th> <td>Hancock</td> <td>10.0</td> <td>1.0</td> <td>15.181418</td> <td>6587</td> </tr> <tr> <th>47173</th> <td>Union</td> <td>0.0</td> <td>0.0</td> <td>15.394089</td> <td>19488</td> </tr> <tr> <th>47127</th> <td>Moore</td> <td>0.0</td> <td>0.0</td> <td>15.678896</td> <td>6378</td> </tr> <tr> <th>47069</th> <td>Hardeman</td> <td>25.0</td> <td>1.0</td> <td>15.721416</td> <td>25443</td> </tr> <tr> <th>47101</th> <td>Lewis</td> <td>0.0</td> <td>0.0</td> <td>16.629251</td> <td>12027</td> </tr> <tr> <th>47111</th> <td>Macon</td> <td>25.0</td> <td>1.0</td> <td>16.777116</td> <td>23842</td> </tr> <tr> <th>47087</th> <td>Jackson</td> <td>0.0</td> <td>1.0</td> <td>17.120356</td> <td>11682</td> </tr> <tr> <th>47005</th> <td>Benton</td> <td>25.0</td> <td>1.0</td> <td>18.587361</td> <td>16140</td> </tr> <tr> <th>47123</th> <td>Monroe</td> <td>59.0</td> <td>1.0</td> <td>19.538034</td> <td>46064</td> </tr> <tr> <th>47169</th> <td>Trousdale</td> <td>25.0</td> <td>1.0</td> <td>19.548431</td> <td>10231</td> </tr> <tr> <th>47081</th> <td>Hickman</td> <td>25.0</td> <td>1.0</td> <td>20.150727</td> <td>24813</td> </tr> <tr> <th>47015</th> <td>Cannon</td> <td>60.0</td> <td>1.0</td> <td>21.159543</td> <td>14178</td> </tr> <tr> <th>47057</th> <td>Grainger</td> <td>0.0</td> <td>0.0</td> <td>21.644085</td> <td>23101</td> </tr> <tr> <th>47023</th> <td>Chester</td> <td>0.0</td> <td>0.0</td> <td>23.269343</td> <td>17190</td> </tr> <tr> <th>47083</th> <td>Houston</td> <td>25.0</td> <td>1.0</td> <td>24.497795</td> <td>8164</td> </tr> <tr> <th>47077</th> <td>Henderson</td> <td>45.0</td> <td>1.0</td> <td>25.020553</td> <td>27977</td> </tr> </tbody> </table> </div> <h3 id="what-happens-if-we-add-a-few-hospitals-in-tn">What happens if we add a few hospitals in TN?</h3> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sns</span><span class="p">.</span><span class="nf">kdeplot</span><span class="p">(</span><span class="n">disparities</span><span class="p">.</span><span class="n">num_hospitals_open</span><span class="p">,</span> <span class="n">hue</span> <span class="o">=</span> <span class="n">disparities</span><span class="p">.</span><span class="n">urban</span><span class="p">)</span>
</code></pre></div></div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;AxesSubplot:xlabel='num_hospitals_open', ylabel='Density'&gt;
</code></pre></div></div> <div class="img"> <img src="/assets/img/bb/data-science-project/output_112_1.png" style="height: 100%; width: 100%; object-fit: contain"> </div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">predict</span> <span class="o">=</span> <span class="n">disparities</span><span class="p">.</span><span class="nf">copy</span><span class="p">()</span>
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">disparities</span><span class="p">.</span><span class="nf">sort_values</span><span class="p">([</span><span class="sh">'</span><span class="s">num_hospitals_open</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">pcp_per_100k</span><span class="sh">'</span><span class="p">])[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">]</span>
</code></pre></div></div> <div> <style scoped="">.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</style> <table border="1" class="dataframe"> <thead> <tr style="text-align: right;"> <th></th> <th>year</th> <th>primary_sex</th> <th>primary_age</th> <th>primary_dual</th> <th>state</th> <th>primary_race</th> <th>primary_eligibility</th> <th>primary_denominator_well</th> <th>analysis_value_well</th> <th>primary_denominator_hosp</th> <th>...</th> <th>county</th> <th>primary_care_physicians</th> <th>population</th> <th>urban</th> <th>shadac_category</th> <th>pcp_per_100k</th> <th>num_hospitals</th> <th>num_hospitals_open</th> <th>mean_beds</th> <th>num_beds</th> </tr> <tr> <th>FIPS</th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> </tr> </thead> <tbody> <tr> <th>47033</th> <td>2019</td> <td>All</td> <td>All</td> <td>Dual &amp; non-dual</td> <td>TENNESSEE</td> <td>All</td> <td>All</td> <td>1,000-4,999</td> <td>25</td> <td>1,000-4,999</td> <td>...</td> <td>Crockett</td> <td>0.0</td> <td>14399</td> <td>Rural</td> <td>low inadequate</td> <td>0.0</td> <td>0.0</td> <td>0.0</td> <td>NaN</td> <td>0.0</td> </tr> </tbody> </table> <p>1 rows × 29 columns</p> </div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="k">def</span> <span class="nf">add_hospitals_weak_link</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">category</span><span class="p">,</span> <span class="n">num_hospitals</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="n">return_mean</span> <span class="o">=</span> <span class="bp">False</span><span class="p">,</span> <span class="n">print_bool</span> <span class="o">=</span> <span class="bp">True</span><span class="p">):</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">data</span><span class="p">.</span><span class="nf">copy</span><span class="p">()</span>
    <span class="n">sorted_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">.</span><span class="nf">sort_values</span><span class="p">([</span><span class="n">category</span><span class="p">,</span><span class="sh">'</span><span class="s">population</span><span class="sh">'</span><span class="p">],</span> <span class="n">ascending</span> <span class="o">=</span> <span class="p">[</span><span class="bp">True</span><span class="p">,</span> <span class="bp">False</span><span class="p">])</span>
    <span class="c1"># print(sorted_df.head(3))
</span>    <span class="n">worst</span> <span class="o">=</span> <span class="n">sorted_df</span><span class="p">.</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">df</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">worst</span><span class="p">,</span><span class="sh">'</span><span class="s">num_hospitals_open</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">num_hospitals</span>
    <span class="c1"># df['num_hospitals_open_per_100k'] = df.num_hospitals_open*100000/df.population
</span>    <span class="k">if</span> <span class="n">print_bool</span> <span class="o">==</span><span class="bp">True</span><span class="p">:</span>
        <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Baseline mean number of open hospitals per 100k before adding hospitals: </span><span class="sh">"</span><span class="o">+</span><span class="nf">str</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nf">round</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="sh">'</span><span class="s">num_hospitals_open</span><span class="sh">'</span><span class="p">].</span><span class="nf">mean</span><span class="p">(),</span><span class="mi">4</span><span class="p">)))</span>

        <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Mean number of open hospitals per 100k after adding </span><span class="si">{</span><span class="n">num_hospitals</span><span class="si">}</span><span class="s"> hospitals to </span><span class="si">{</span><span class="n">df</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">worst</span><span class="p">,</span><span class="sh">'</span><span class="s">county</span><span class="sh">'</span><span class="p">]</span><span class="si">}</span><span class="s"> County: </span><span class="sh">"</span>
          <span class="o">+</span><span class="nf">str</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nf">round</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">num_hospitals_open</span><span class="sh">'</span><span class="p">].</span><span class="nf">mean</span><span class="p">(),</span> <span class="mi">4</span><span class="p">)))</span>
    <span class="k">return</span> <span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">num_hospitals_open</span><span class="sh">'</span><span class="p">].</span><span class="nf">mean</span><span class="p">()</span> <span class="k">if</span> <span class="n">return_mean</span> <span class="o">==</span><span class="bp">True</span> <span class="k">else</span> <span class="bp">None</span>

<span class="nf">add_hospitals_weak_link</span><span class="p">(</span><span class="n">disparities</span><span class="p">,</span> <span class="n">category</span> <span class="o">=</span> <span class="sh">'</span><span class="s">pcp_per_100k</span><span class="sh">'</span><span class="p">)</span>
</code></pre></div></div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Baseline mean number of open hospitals per 100k before adding hospitals: 1.6421
Mean number of open hospitals per 100k after adding 5 hospitals to Crockett County: 1.6947
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="k">def</span> <span class="nf">add_hospitals_equitably</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">category</span><span class="p">,</span> <span class="n">num_hospitals</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="n">num_counties</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="n">copy</span> <span class="o">=</span> <span class="bp">False</span><span class="p">,</span> <span class="n">print_bool</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span> <span class="n">return_mean</span> <span class="o">=</span> <span class="bp">False</span><span class="p">):</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">data</span><span class="p">.</span><span class="nf">copy</span><span class="p">()</span>
    <span class="n">sorted_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">.</span><span class="nf">sort_values</span><span class="p">([</span><span class="n">category</span><span class="p">,</span><span class="sh">'</span><span class="s">population</span><span class="sh">'</span><span class="p">],</span> <span class="n">ascending</span> <span class="o">=</span> <span class="p">[</span><span class="bp">True</span><span class="p">,</span> <span class="bp">False</span><span class="p">])</span>
    <span class="c1"># print(sorted_df.head(3))
</span>    <span class="n">worst</span> <span class="o">=</span> <span class="n">sorted_df</span><span class="p">.</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">num_counties</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">worst</span><span class="p">:</span>
        <span class="n">df</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="sh">'</span><span class="s">num_hospitals_open</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">num_hospitals</span><span class="o">/</span><span class="n">num_counties</span>
    <span class="c1"># df['num_hospitals_open'] = df.num_hospitals_open*100000/df.population
</span>    <span class="k">if</span> <span class="n">print_bool</span> <span class="o">==</span> <span class="bp">True</span><span class="p">:</span>
        <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Baseline mean number of open hospitals per 100k before adding hospitals: </span><span class="sh">"</span><span class="o">+</span><span class="nf">str</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nf">round</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="sh">'</span><span class="s">num_hospitals_open</span><span class="sh">'</span><span class="p">].</span><span class="nf">mean</span><span class="p">(),</span> <span class="mi">4</span><span class="p">)))</span>

        <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Mean number of open hospitals per 100k after adding </span><span class="si">{</span><span class="n">num_hospitals</span><span class="si">}</span><span class="s"> hospitals to </span><span class="si">{</span><span class="n">df</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">worst</span><span class="p">,</span><span class="sh">'</span><span class="s">county</span><span class="sh">'</span><span class="p">].</span><span class="n">values</span><span class="si">}</span><span class="s"> Counties: </span><span class="sh">"</span>
          <span class="o">+</span><span class="nf">str</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nf">round</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">num_hospitals_open</span><span class="sh">'</span><span class="p">].</span><span class="nf">mean</span><span class="p">(),</span> <span class="mi">4</span><span class="p">)))</span>
    <span class="k">return</span> <span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">num_hospitals_open</span><span class="sh">'</span><span class="p">].</span><span class="nf">mean</span><span class="p">()</span> <span class="k">if</span> <span class="n">return_mean</span> <span class="o">==</span> <span class="bp">True</span> <span class="k">else</span> <span class="bp">None</span>

<span class="nf">add_hospitals_equitably</span><span class="p">(</span><span class="n">disparities</span><span class="p">,</span> <span class="n">category</span> <span class="o">=</span> <span class="sh">'</span><span class="s">pcp_per_100k</span><span class="sh">'</span><span class="p">)</span>
</code></pre></div></div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Baseline mean number of open hospitals per 100k before adding hospitals: 1.6421
Mean number of open hospitals per 100k after adding 5 hospitals to ['Crockett' 'Grundy' 'Lake' 'Van Buren' 'Bledsoe'] Counties: 1.6842
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">add_hospitals_weak_link</span><span class="p">(</span><span class="n">disparities</span><span class="p">,</span> <span class="n">category</span> <span class="o">=</span> <span class="sh">'</span><span class="s">pcp_per_100k</span><span class="sh">'</span><span class="p">,</span> <span class="n">num_hospitals</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="nf">add_hospitals_equitably</span><span class="p">(</span><span class="n">disparities</span><span class="p">,</span> <span class="n">category</span> <span class="o">=</span> <span class="sh">'</span><span class="s">pcp_per_100k</span><span class="sh">'</span><span class="p">,</span> <span class="n">num_hospitals</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</code></pre></div></div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Baseline mean number of open hospitals per 100k before adding hospitals: 1.6421
Mean number of open hospitals per 100k after adding 10 hospitals to Crockett County: 1.7474
Baseline mean number of open hospitals per 100k before adding hospitals: 1.6421
Mean number of open hospitals per 100k after adding 10 hospitals to ['Crockett' 'Grundy' 'Lake' 'Van Buren' 'Bledsoe'] Counties: 1.7368
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">means_weak</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">means_equit</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">20</span><span class="p">):</span>
    <span class="n">means_weak</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="nf">add_hospitals_weak_link</span><span class="p">(</span><span class="n">disparities</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="sh">'</span><span class="s">pcp_per_100k</span><span class="sh">'</span><span class="p">,</span> <span class="n">num_hospitals</span><span class="o">=</span><span class="n">i</span><span class="p">,</span> <span class="n">print_bool</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">return_mean</span> <span class="o">=</span> <span class="bp">True</span><span class="p">))</span>
    <span class="n">means_equit</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="nf">add_hospitals_equitably</span><span class="p">(</span><span class="n">disparities</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="sh">'</span><span class="s">pcp_per_100k</span><span class="sh">'</span><span class="p">,</span> <span class="n">num_hospitals</span><span class="o">=</span><span class="n">i</span><span class="p">,</span><span class="n">num_counties</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">print_bool</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">return_mean</span> <span class="o">=</span> <span class="bp">True</span><span class="p">))</span>

<span class="nf">print</span><span class="p">(</span><span class="n">means_weak</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="n">means_equit</span><span class="p">)</span>

</code></pre></div></div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[1.6421052631578947, 1.6526315789473685, 1.6631578947368422, 1.6736842105263159, 1.6842105263157894, 1.694736842105263, 1.7052631578947368, 1.7157894736842105, 1.7263157894736842, 1.736842105263158, 1.7473684210526317, 1.7578947368421052, 1.768421052631579, 1.7789473684210526, 1.7894736842105263, 1.8, 1.8105263157894738, 1.8210526315789475, 1.831578947368421, 1.8421052631578947]
[1.6421052631578947, 1.6526315789473685, 1.6631578947368422, 1.6736842105263159, 1.6842105263157894, 1.694736842105263, 1.7052631578947368, 1.7157894736842105, 1.7263157894736842, 1.736842105263158, 1.7473684210526317, 1.7578947368421052, 1.768421052631579, 1.7789473684210526, 1.7894736842105263, 1.8, 1.8105263157894738, 1.8210526315789475, 1.831578947368421, 1.8421052631578947]
</code></pre></div></div> <h1 id="question-2-what-is-the-relationship-between-areas-without-access-and-er-visits">Question 2: What is the relationship between areas without access and ER visits?</h1> <p>Do areas that lack access to healthcare tend to have higher rates of emergency department visits or hospitalizations? Is there an association between the percentage of beneficiaries who had an annual wellness visit and rate of hospitalizations or emergency department visits?</p> <p>Reordering <code class="language-plaintext highlighter-rouge">disparities</code> in order of least acess:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">disparities</span> <span class="o">=</span> <span class="n">disparities</span><span class="p">.</span><span class="nf">sort_values</span><span class="p">([</span><span class="sh">'</span><span class="s">pcp_per_100k</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">population</span><span class="sh">'</span><span class="p">],</span> <span class="n">ascending</span> <span class="o">=</span> <span class="p">[</span><span class="bp">True</span><span class="p">,</span><span class="bp">False</span><span class="p">]).</span><span class="nf">reset_index</span><span class="p">()</span>
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">disparities</span><span class="p">.</span><span class="n">columns</span>
</code></pre></div></div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Index(['FIPS', 'year', 'primary_sex', 'primary_age', 'primary_dual', 'state',
       'primary_race', 'primary_eligibility', 'primary_denominator_well',
       'analysis_value_well', 'primary_denominator_hosp',
       'analysis_value_hosp', 'primary_denominator_emer',
       'analysis_value_emer', 'laus_code', 'Name', 'Employed', 'Unemployed',
       'unemployment_rate', 'FIPS.1', 'county', 'primary_care_physicians',
       'population', 'urban', 'shadac_category', 'pcp_per_100k',
       'num_hospitals', 'num_hospitals_open', 'mean_beds', 'num_beds'],
      dtype='object')
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">imp</span> <span class="kn">import</span> <span class="nb">reload</span>
<span class="nf">reload</span><span class="p">(</span><span class="n">plt</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">figure</span><span class="p">()</span>
<span class="n">sns</span><span class="p">.</span><span class="nf">scatterplot</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">disparities</span><span class="p">.,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">disparities</span><span class="p">.</span><span class="n">analysis_value_well</span><span class="p">,</span> <span class="n">hue</span> <span class="o">=</span> <span class="n">disparities</span><span class="p">.</span><span class="n">shadac_category</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">ylabel</span><span class="p">(</span><span class="sh">"</span><span class="s">Emergency department visits per 100K</span><span class="sh">"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">xlabel</span><span class="p">(</span><span class="sh">"</span><span class="s">PCP per 100k</span><span class="sh">"</span><span class="p">)</span>

</code></pre></div></div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Text(0.5, 0, 'PCP per 100k')
</code></pre></div></div> <div class="img"> <img src="/assets/img/bb/data-science-project/output_123_1.png" style="height: 100%; width: 100%; object-fit: contain"> </div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plt</span><span class="p">.</span><span class="nf">figure</span><span class="p">()</span>
<span class="n">sns</span><span class="p">.</span><span class="nf">scatterplot</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">counties</span><span class="p">[</span><span class="sh">'</span><span class="s">Median Household Income</span><span class="sh">'</span><span class="p">],</span> <span class="n">y</span> <span class="o">=</span> <span class="n">counties</span><span class="p">.</span><span class="n">analysis_value_emer</span><span class="p">,</span> <span class="n">hue</span> <span class="o">=</span> <span class="n">disparities</span><span class="p">.</span><span class="n">shadac_category</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">ylabel</span><span class="p">(</span><span class="sh">"</span><span class="s">Emergency Visits per 1K</span><span class="sh">"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">xlabel</span><span class="p">(</span><span class="sh">"</span><span class="s">Median Household Income</span><span class="sh">"</span><span class="p">)</span>

</code></pre></div></div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Text(0.5, 0, 'Median Household Income')
</code></pre></div></div> <div class="img"> <img src="/assets/img/bb/data-science-project/output_124_1.png" style="height: 100%; width: 100%; object-fit: contain"> </div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sns</span><span class="p">.</span><span class="nf">boxplot</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">counties</span><span class="p">.</span><span class="n">urban</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">counties</span><span class="p">.</span><span class="n">analysis_value_emer</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">ylabel</span><span class="p">(</span><span class="sh">"</span><span class="s">Hospitalizations per 1K</span><span class="sh">"</span><span class="p">)</span>

</code></pre></div></div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Text(0, 0.5, 'Hospitalizations per 1K')
</code></pre></div></div> <div class="img"> <img src="/assets/img/bb/data-science-project/output_125_1.png" style="height: 100%; width: 100%; object-fit: contain"> </div> <h2 id="association-between-the-percentage-of-beneficiaries-who-had-an-annual-wellness-visit-and-rate-of-hospitalizations-or-emergency-department-visits">Association between the percentage of beneficiaries who had an annual wellness visit and rate of hospitalizations or emergency department visits</h2> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plt</span><span class="p">.</span><span class="nf">figure</span><span class="p">()</span>
<span class="n">sns</span><span class="p">.</span><span class="nf">lmplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span><span class="n">disparities</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="sh">"</span><span class="s">analysis_value_hosp</span><span class="sh">"</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="sh">"</span><span class="s">analysis_value_well</span><span class="sh">"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">ylabel</span><span class="p">(</span><span class="sh">"</span><span class="s">Hospitalizations per 100K</span><span class="sh">"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">xlabel</span><span class="p">(</span><span class="sh">"</span><span class="s">Percentage annual wellness visits</span><span class="sh">"</span><span class="p">)</span>

</code></pre></div></div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Text(0.5, 21.70625000000002, 'Percentage annual wellness visits')




&lt;Figure size 432x288 with 0 Axes&gt;
</code></pre></div></div> <div class="img"> <img src="/assets/img/bb/data-science-project/output_127_2.png" style="height: 100%; width: 100%; object-fit: contain"> </div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">emer_per_100k</span> <span class="o">=</span><span class="n">disparities</span><span class="p">.</span><span class="n">analysis_value_emer</span>
<span class="n">hosp_per_100k</span> <span class="o">=</span><span class="n">disparities</span><span class="p">.</span><span class="n">analysis_value_hosp</span>
<span class="n">well_rate</span> <span class="o">=</span> <span class="n">disparities</span><span class="p">.</span><span class="n">analysis_value_well</span>
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">rates</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nc">DataFrame</span><span class="p">([</span><span class="n">emer_per_100k</span><span class="p">,</span> <span class="n">hosp_per_100k</span><span class="p">,</span> <span class="n">well_rate</span><span class="p">,</span> <span class="n">disparities</span><span class="p">.</span><span class="n">pcp_per_100k</span><span class="p">,</span> <span class="n">disparities</span><span class="p">.</span><span class="n">shadac_category</span><span class="p">,</span><span class="n">counties</span><span class="p">[</span><span class="sh">'</span><span class="s">Median Household Income</span><span class="sh">'</span><span class="p">]],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="sh">'</span><span class="s">Emergency Visits</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">Hospitalizations</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">Wellness Visits</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">pcp</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">shadac</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Income</span><span class="sh">'</span><span class="p">]).</span><span class="n">T</span>
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sns</span><span class="p">.</span><span class="nf">pairplot</span><span class="p">(</span><span class="n">rates</span><span class="p">,</span> <span class="n">hue</span> <span class="o">=</span> <span class="sh">'</span><span class="s">shadac</span><span class="sh">'</span><span class="p">,</span> <span class="n">corner</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
</code></pre></div></div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;seaborn.axisgrid.PairGrid at 0x1a5eb4190&gt;
</code></pre></div></div> <div class="img"> <img src="/assets/img/bb/data-science-project/output_130_1.png" style="height: 100%; width: 100%; object-fit: contain"> </div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">rates</span><span class="p">[[</span><span class="sh">'</span><span class="s">emer</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">hosp</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">well</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">pcp</span><span class="sh">'</span><span class="p">]]</span> <span class="o">=</span> <span class="n">rates</span><span class="p">[[</span><span class="sh">'</span><span class="s">emer</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">hosp</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">well</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">pcp</span><span class="sh">'</span><span class="p">]].</span><span class="nf">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">rates</span><span class="p">.</span><span class="nf">drop</span><span class="p">(</span><span class="sh">'</span><span class="s">shadac</span><span class="sh">'</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
</code></pre></div></div> <div> <style scoped="">.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</style> <table border="1" class="dataframe"> <thead> <tr style="text-align: right;"> <th></th> <th>Emergency Visits</th> <th>Hospitalizations</th> <th>Wellness Visits</th> <th>pcp</th> <th>Income</th> </tr> </thead> <tbody> <tr> <th>0</th> <td>622</td> <td>289</td> <td>25</td> <td>0.0</td> <td>47508</td> </tr> <tr> <th>1</th> <td>651</td> <td>285</td> <td>34</td> <td>0.0</td> <td>38879</td> </tr> <tr> <th>2</th> <td>1000</td> <td>401</td> <td>20</td> <td>0.0</td> <td>60874</td> </tr> <tr> <th>3</th> <td>759</td> <td>304</td> <td>31</td> <td>0.0</td> <td>57196</td> </tr> <tr> <th>4</th> <td>750</td> <td>313</td> <td>19</td> <td>6.740361</td> <td>46565</td> </tr> <tr> <th>...</th> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> </tr> <tr> <th>90</th> <td>559</td> <td>234</td> <td>56</td> <td>112.772823</td> <td>39859</td> </tr> <tr> <th>91</th> <td>584</td> <td>261</td> <td>52</td> <td>126.711238</td> <td>50201</td> </tr> <tr> <th>92</th> <td>666</td> <td>255</td> <td>43</td> <td>132.138284</td> <td>50427</td> </tr> <tr> <th>93</th> <td>469</td> <td>201</td> <td>48</td> <td>149.962953</td> <td>50819</td> </tr> <tr> <th>94</th> <td>504</td> <td>256</td> <td>57</td> <td>176.831892</td> <td>41968</td> </tr> </tbody> </table> <p>95 rows × 5 columns</p> </div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">rates</span><span class="p">.</span><span class="nf">drop</span><span class="p">(</span><span class="sh">'</span><span class="s">shadac</span><span class="sh">'</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">).</span><span class="nf">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">).</span><span class="nf">corr</span><span class="p">().</span><span class="n">style</span><span class="p">.</span><span class="nf">background_gradient</span><span class="p">(</span><span class="sh">'</span><span class="s">coolwarm</span><span class="sh">'</span><span class="p">)</span>


</code></pre></div></div> <style type="text/css">#T_be3e4_row0_col0,#T_be3e4_row1_col1,#T_be3e4_row2_col2,#T_be3e4_row3_col3,#T_be3e4_row4_col4{background-color:#b40426;color:#f1f1f1}#T_be3e4_row0_col1,#T_be3e4_row1_col0{background-color:#f6a283;color:#000}#T_be3e4_row0_col2,#T_be3e4_row0_col3,#T_be3e4_row1_col2,#T_be3e4_row2_col0,#T_be3e4_row2_col1,#T_be3e4_row3_col4{background-color:#3b4cc0;color:#f1f1f1}#T_be3e4_row0_col4{background-color:#81a4fb;color:#f1f1f1}#T_be3e4_row1_col3{background-color:#4c66d6;color:#f1f1f1}#T_be3e4_row1_col4{background-color:#799cf8;color:#f1f1f1}#T_be3e4_row2_col3{background-color:#f5c1a9;color:#000}#T_be3e4_row2_col4{background-color:#3c4ec2;color:#f1f1f1}#T_be3e4_row3_col0{background-color:#4b64d5;color:#f1f1f1}#T_be3e4_row3_col1{background-color:#5e7de7;color:#f1f1f1}#T_be3e4_row3_col2{background-color:#f7bca1;color:#000}#T_be3e4_row4_col0{background-color:#c9d7f0;color:#000}#T_be3e4_row4_col1{background-color:#c4d5f3;color:#000}#T_be3e4_row4_col2{background-color:#96b7ff;color:#000}#T_be3e4_row4_col3{background-color:#84a7fc;color:#f1f1f1}</style> <table id="T_be3e4_"> <thead> <tr> <th class="blank level0"> </th> <th class="col_heading level0 col0">Emergency Visits</th> <th class="col_heading level0 col1">Hospitalizations</th> <th class="col_heading level0 col2">Wellness Visits</th> <th class="col_heading level0 col3">pcp</th> <th class="col_heading level0 col4">Income</th> </tr> </thead> <tbody> <tr> <th id="T_be3e4_level0_row0" class="row_heading level0 row0">Emergency Visits</th> <td id="T_be3e4_row0_col0" class="data row0 col0">1.000000</td> <td id="T_be3e4_row0_col1" class="data row0 col1">0.599412</td> <td id="T_be3e4_row0_col2" class="data row0 col2">-0.480607</td> <td id="T_be3e4_row0_col3" class="data row0 col3">-0.396181</td> <td id="T_be3e4_row0_col4" class="data row0 col4">0.153085</td> </tr> <tr> <th id="T_be3e4_level0_row1" class="row_heading level0 row1">Hospitalizations</th> <td id="T_be3e4_row1_col0" class="data row1 col0">0.599412</td> <td id="T_be3e4_row1_col1" class="data row1 col1">1.000000</td> <td id="T_be3e4_row1_col2" class="data row1 col2">-0.480732</td> <td id="T_be3e4_row1_col3" class="data row1 col3">-0.308934</td> <td id="T_be3e4_row1_col4" class="data row1 col4">0.126632</td> </tr> <tr> <th id="T_be3e4_level0_row2" class="row_heading level0 row2">Wellness Visits</th> <td id="T_be3e4_row2_col0" class="data row2 col0">-0.480607</td> <td id="T_be3e4_row2_col1" class="data row2 col1">-0.480732</td> <td id="T_be3e4_row2_col2" class="data row2 col2">1.000000</td> <td id="T_be3e4_row2_col3" class="data row2 col3">0.488941</td> <td id="T_be3e4_row2_col4" class="data row2 col4">-0.073377</td> </tr> <tr> <th id="T_be3e4_level0_row3" class="row_heading level0 row3">pcp</th> <td id="T_be3e4_row3_col0" class="data row3 col0">-0.396181</td> <td id="T_be3e4_row3_col1" class="data row3 col1">-0.308934</td> <td id="T_be3e4_row3_col2" class="data row3 col2">0.488941</td> <td id="T_be3e4_row3_col3" class="data row3 col3">1.000000</td> <td id="T_be3e4_row3_col4" class="data row3 col4">-0.080277</td> </tr> <tr> <th id="T_be3e4_level0_row4" class="row_heading level0 row4">Income</th> <td id="T_be3e4_row4_col0" class="data row4 col0">0.153085</td> <td id="T_be3e4_row4_col1" class="data row4 col1">0.126632</td> <td id="T_be3e4_row4_col2" class="data row4 col2">-0.073377</td> <td id="T_be3e4_row4_col3" class="data row4 col3">-0.080277</td> <td id="T_be3e4_row4_col4" class="data row4 col4">1.000000</td> </tr> </tbody> </table> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">counties</span><span class="p">.</span><span class="nf">to_csv</span><span class="p">(</span><span class="sh">'</span><span class="s">../data/counties_full.csv</span><span class="sh">'</span><span class="p">)</span>
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">disparities</span><span class="p">.</span><span class="nf">to_csv</span><span class="p">(</span><span class="sh">'</span><span class="s">../data/disparities.csv</span><span class="sh">'</span><span class="p">)</span>
</code></pre></div></div> <h1 id="question-3-which-subpopulations-need-more-attention">Question 3: Which subpopulations need more attention?</h1> <p>Finally, TN Med Helper is trying to identify specific subpopulations to focus more attention on. Using data from the Behavioral Risk Factor Surveillance System, build a model to predict whether an individual has not had a checkup in the last year. Apply this model to the counties you identified above to predict how likely it is that the average person from those counties has not had a checkup in the last year. Which groups within these counties might need to be focused on to maximize the impact of TN Med Helper’s efforts?</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="kn">import</span> <span class="n">geopandas</span> <span class="k">as</span> <span class="n">gpd</span>
<span class="kn">import</span> <span class="n">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">import</span> <span class="n">seaborn</span> <span class="k">as</span> <span class="n">sns</span>
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">disparities</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nf">read_csv</span><span class="p">(</span><span class="sh">'</span><span class="s">../data/disparities.csv</span><span class="sh">'</span><span class="p">,</span><span class="n">header</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">index_col</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">disparities</span><span class="p">.</span><span class="nf">head</span><span class="p">()</span>
</code></pre></div></div> <div> <style scoped="">.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</style> <table border="1" class="dataframe"> <thead> <tr style="text-align: right;"> <th></th> <th>FIPS</th> <th>year</th> <th>primary_sex</th> <th>primary_age</th> <th>primary_dual</th> <th>state</th> <th>primary_race</th> <th>primary_eligibility</th> <th>primary_denominator_well</th> <th>analysis_value_well</th> <th>...</th> <th>county</th> <th>primary_care_physicians</th> <th>population</th> <th>urban</th> <th>shadac_category</th> <th>pcp_per_100k</th> <th>num_hospitals</th> <th>num_hospitals_open</th> <th>mean_beds</th> <th>num_beds</th> </tr> </thead> <tbody> <tr> <th>0</th> <td>47033</td> <td>2019</td> <td>All</td> <td>All</td> <td>Dual &amp; non-dual</td> <td>TENNESSEE</td> <td>All</td> <td>All</td> <td>1,000-4,999</td> <td>25</td> <td>...</td> <td>Crockett</td> <td>0.0</td> <td>14399</td> <td>Rural</td> <td>low inadequate</td> <td>0.000000</td> <td>0.0</td> <td>0.0</td> <td>NaN</td> <td>0.0</td> </tr> <tr> <th>1</th> <td>47061</td> <td>2019</td> <td>All</td> <td>All</td> <td>Dual &amp; non-dual</td> <td>TENNESSEE</td> <td>All</td> <td>All</td> <td>1,000-4,999</td> <td>34</td> <td>...</td> <td>Grundy</td> <td>0.0</td> <td>13344</td> <td>Rural</td> <td>low inadequate</td> <td>0.000000</td> <td>0.0</td> <td>0.0</td> <td>NaN</td> <td>0.0</td> </tr> <tr> <th>2</th> <td>47095</td> <td>2019</td> <td>All</td> <td>All</td> <td>Dual &amp; non-dual</td> <td>TENNESSEE</td> <td>All</td> <td>All</td> <td>500-999</td> <td>20</td> <td>...</td> <td>Lake</td> <td>0.0</td> <td>7401</td> <td>Rural</td> <td>low inadequate</td> <td>0.000000</td> <td>0.0</td> <td>0.0</td> <td>NaN</td> <td>0.0</td> </tr> <tr> <th>3</th> <td>47175</td> <td>2019</td> <td>All</td> <td>All</td> <td>Dual &amp; non-dual</td> <td>TENNESSEE</td> <td>All</td> <td>All</td> <td>500-999</td> <td>31</td> <td>...</td> <td>Van Buren</td> <td>0.0</td> <td>5760</td> <td>Rural</td> <td>low inadequate</td> <td>0.000000</td> <td>0.0</td> <td>0.0</td> <td>NaN</td> <td>0.0</td> </tr> <tr> <th>4</th> <td>47007</td> <td>2019</td> <td>All</td> <td>All</td> <td>Dual &amp; non-dual</td> <td>TENNESSEE</td> <td>All</td> <td>All</td> <td>1,000-4,999</td> <td>19</td> <td>...</td> <td>Bledsoe</td> <td>1.0</td> <td>14836</td> <td>Rural</td> <td>low inadequate</td> <td>6.740361</td> <td>1.0</td> <td>1.0</td> <td>25.0</td> <td>25.0</td> </tr> </tbody> </table> <p>5 rows × 30 columns</p> </div> <p>The file brfss.csv contains a subset of the responses and variables from the <a href="https://www.cdc.gov/brfss/" target="_blank" rel="noopener noreferrer">2019 Behavioral Risk Factor Surveillance System (BRFSS)</a>. This dataset can be downloaded using this link: <a href="https://drive.google.com/file/d/1acJKmT2aFf2nZl_VYLE897yx0LPNajoY/view?usp=sharing" target="_blank" rel="noopener noreferrer">https://drive.google.com/file/d/1acJKmT2aFf2nZl_VYLE897yx0LPNajoY/view?usp=sharing</a>.</p> <p>A detailed Codebook can be found <a href="https://www.cdc.gov/brfss/annual_data/2019/pdf/codebook19_llcp-v2-508.HTML" target="_blank" rel="noopener noreferrer">here</a>.</p> <p>Our target variable is the CHECKUP1 column, which contains the responses to the question “About how long has it been since you last visited a doctor for a routine checkup? [A routine checkup is a general physical exam, not an exam for a specific injury, illness, or condition.]” Specifically, we want to try and predict if someone gives an answer besides “Within past year (anytime less than 12 months ago)”.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">brfss</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nf">read_csv</span><span class="p">(</span><span class="sh">'</span><span class="s">../data/brfss.csv</span><span class="sh">'</span><span class="p">,</span> <span class="n">header</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">brfss</span><span class="p">.</span><span class="nf">head</span><span class="p">()</span>
</code></pre></div></div> <div> <style scoped="">.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</style> <table border="1" class="dataframe"> <thead> <tr style="text-align: right;"> <th></th> <th>GENHLTH</th> <th>HLTHPLN1</th> <th>PERSDOC2</th> <th>MEDCOST</th> <th>CHECKUP1</th> <th>_RFHYPE5</th> <th>TOLDHI2</th> <th>CVDINFR4</th> <th>CVDCRHD4</th> <th>CVDSTRK3</th> <th>...</th> <th>EXERANY2</th> <th>_METSTAT</th> <th>_URBSTAT</th> <th>_IMPRACE</th> <th>_RFBMI5</th> <th>_RFSMOK3</th> <th>_RFBING5</th> <th>_RFDRHV7</th> <th>_TOTINDA</th> <th>target</th> </tr> </thead> <tbody> <tr> <th>0</th> <td>Good</td> <td>Yes</td> <td>Yes, only one</td> <td>No</td> <td>Within past year (anytime less than 12 months ...</td> <td>Yes</td> <td>Yes</td> <td>No</td> <td>No</td> <td>No</td> <td>...</td> <td>No</td> <td>Metropolitan counties (_URBNRRL = 1,2,3,4)</td> <td>Urban counties (_URBNRRL = 1,2,3,4,5)</td> <td>Black, Non-Hispanic</td> <td>Yes</td> <td>No</td> <td>No</td> <td>No</td> <td>No physical activity or exercise in last 30 days</td> <td>True</td> </tr> <tr> <th>1</th> <td>Fair</td> <td>Yes</td> <td>Yes, only one</td> <td>No</td> <td>Within past year (anytime less than 12 months ...</td> <td>No</td> <td>No</td> <td>No</td> <td>No</td> <td>No</td> <td>...</td> <td>Yes</td> <td>Metropolitan counties (_URBNRRL = 1,2,3,4)</td> <td>Urban counties (_URBNRRL = 1,2,3,4,5)</td> <td>White, Non-Hispanic</td> <td>No</td> <td>No</td> <td>No</td> <td>No</td> <td>Had physical activity or exercise</td> <td>True</td> </tr> <tr> <th>2</th> <td>Good</td> <td>Yes</td> <td>More than one</td> <td>No</td> <td>Within past year (anytime less than 12 months ...</td> <td>Yes</td> <td>No</td> <td>No</td> <td>No</td> <td>No</td> <td>...</td> <td>Yes</td> <td>Metropolitan counties (_URBNRRL = 1,2,3,4)</td> <td>Urban counties (_URBNRRL = 1,2,3,4,5)</td> <td>Black, Non-Hispanic</td> <td>Yes</td> <td>No</td> <td>No</td> <td>No</td> <td>Had physical activity or exercise</td> <td>True</td> </tr> <tr> <th>3</th> <td>Very good</td> <td>Yes</td> <td>Yes, only one</td> <td>No</td> <td>Within past year (anytime less than 12 months ...</td> <td>No</td> <td>No</td> <td>No</td> <td>No</td> <td>No</td> <td>...</td> <td>Yes</td> <td>Nonmetropolitan counties (_URBNRRL = 5,6)</td> <td>Rural counties (_URBNRRL = 6)</td> <td>White, Non-Hispanic</td> <td>Yes</td> <td>Yes</td> <td>No</td> <td>No</td> <td>Had physical activity or exercise</td> <td>True</td> </tr> <tr> <th>4</th> <td>Poor</td> <td>Yes</td> <td>Yes, only one</td> <td>No</td> <td>Within past year (anytime less than 12 months ...</td> <td>No</td> <td>Yes</td> <td>No</td> <td>No</td> <td>No</td> <td>...</td> <td>No</td> <td>Metropolitan counties (_URBNRRL = 1,2,3,4)</td> <td>Urban counties (_URBNRRL = 1,2,3,4,5)</td> <td>White, Non-Hispanic</td> <td>No</td> <td>No</td> <td>No</td> <td>No</td> <td>No physical activity or exercise in last 30 days</td> <td>True</td> </tr> </tbody> </table> <p>5 rows × 40 columns</p> </div> <p>First, create a new coumn, “target” by converting this to a binary outcome. After you do this, drop the CHECKUP1 column from your dataframe so that you don’t accidentally make predictions based off of it.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">set</span><span class="p">(</span><span class="n">brfss</span><span class="p">.</span><span class="n">CHECKUP1</span><span class="p">)</span>
</code></pre></div></div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{'5 or more years ago',
 'Never',
 'Within past 2 years (1 year but less than 2 years ago)',
 'Within past 5 years (2 years but less than 5 years ago)',
 'Within past year (anytime less than 12 months ago)'}
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">target</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">brfss</span><span class="p">.</span><span class="n">CHECKUP1</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="sh">'</span><span class="s">Within past year (anytime less than 12 months ago)</span><span class="sh">'</span><span class="p">:</span>
        <span class="n">target</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span> <span class="n">target</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">brfss</span><span class="p">[</span><span class="sh">'</span><span class="s">target</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">target</span>
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">brfss</span> <span class="o">=</span> <span class="n">brfss</span><span class="p">.</span><span class="nf">drop</span><span class="p">(</span><span class="sh">'</span><span class="s">CHECKUP1</span><span class="sh">'</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">brfss</span><span class="p">.</span><span class="n">target</span><span class="p">.</span><span class="nf">value_counts</span><span class="p">()</span>
</code></pre></div></div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>True     215875
False     46174
Name: target, dtype: int64
</code></pre></div></div> <h2 id="using-data-from-the-behavioral-risk-factor-surveillance-system-build-a-model-to-predict-whether-an-individual-has-not-had-a-checkup-in-the-last-year">Using data from the Behavioral Risk Factor Surveillance System, build a model to predict whether an individual has not had a checkup in the last year.</h2> <p>Then, experiment with making a logistic regression model to predict the target variable using one or more of the other columns. Note that you will need to convert the precictor columns into dummy variable prior to fitting a model. What do you find?</p> <ul> <li>GENHLTH: Would you say that in general your health is</li> <li>HLTHPLN1: Do you have any kind of health care coverage, including health insurance, prepaid plans such as HMOs, or government plans such as Medicare, or Indian Health Service?</li> <li>PERSDOC2: Do you have one person you think of as your personal doctor or health care provider?</li> <li>MEDCOST: Was there a time in the past 12 months when you needed to see a doctor but could not because of cost?</li> <li>_RFHYPE5: Adults who have been told they have high blood pressure by a doctor, nurse, or other health professional</li> <li>TOLDHI2: Have you ever been told by a doctor, nurse or other health professional that your blood cholesterol is high?</li> <li>CVDINFR4: (Ever told) you had a heart attack, also called a myocardial infarction?</li> <li>CVDCRHD4: (Ever told) you had angina or coronary heart disease?</li> <li>CVDSTRK3: (Ever told) you had a stroke.</li> <li>ASTHMA3: (Ever told) you had asthma?</li> <li>CHCSCNCR: (Ever told) you had skin cancer?</li> <li>CHCOCNCR: (Ever told) you had other cancer?</li> <li>CHCCOPD2: (Ever told) you had COPD?</li> <li>ADDEPEV3: (Ever told) (you had) a depressive disorder</li> <li>CHCKDNY2: were you ever told you had kidney disease?</li> <li>DIABETE4: (Ever told) diabetes?</li> <li>HAVARTH4: Arthritis</li> <li>MARITAL: Marital status</li> <li>EDUCA: What is the highest grade or year of school you completed?</li> <li>RENTHOM1: Own or rent home</li> <li>VETERAN3: Veteran?</li> <li>EMPLOY1: Employment</li> <li>INCOME2: Income categories</li> <li>DEAF</li> <li>BLIND</li> <li>DECIDE: Trouble concentrating/deciding</li> <li>DIFFWALK: Difficulty walking</li> <li>DIFFDRES: Difficulty dressing</li> <li>DIFFALON: Difficulty errands alone</li> <li>EXERANY2: Exercise in past month</li> <li>_METSTAT: Metropolitan Status</li> <li>_URBSTAT: Urban status</li> <li>_IMPRACE: Imputed race/ethnicity value</li> <li>_RFBMI5: Adults who have a body mass index greater than 25.00 (Overweight or Obese)</li> <li>_RFSMOK3: Adults who are current smokers</li> <li>_RFBING5: Binge drinkers</li> <li>_RFDRHV7: Heavy drinkers</li> <li>_TOTINDA: Adults who reported doing physical activity or exercise during the past 30 days other than their regular job</li> <li>target</li> </ul> <p>We only really want categorical variables that we know about counties, so we need to look at County Health Rankings to figure out which of these variables we have percentages on. For example, we can use _IMPRACE because we have percentages of races by TN county.</p> <p>In the County Health Rankings Data:</p> <ol> <li>GENHLTH == “Poor or fair health” (percentage)</li> <li>HLTHPLN1 == “% Uninsured”</li> <li>PERSDOC2 == ratio primary care physicians?</li> <li>DIABETES4 == “diabetes prevalence”</li> <li>_RFBING5 &amp; _RFDRHV7 == Binge and heavy drinkers == “Excessive drinking”</li> <li>RENTHOM1 == “Homeownership”</li> <li>_IMPRACE = race %</li> <li>_URBSTAT = ‘rural’</li> <li>MARITAL ~ % single-parent households</li> <li>EDUCA == “High school graduation rate, % some college</li> <li>EMPLOY1 = % unemployed</li> <li>INCOME2 = household income</li> <li>_TOTINDA ~ % physically inactive</li> <li>_RFBMI5 BMI &gt; 25, % adults with obesity == BMI &gt; 30…</li> <li>_RFSMOK3 == ‘% smokers</li> <li>ADDEPEV3 ~ frequent mental distress</li> </ol> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">categorical_variables</span> <span class="o">=</span> <span class="p">[</span><span class="sh">'</span><span class="s">GENHLTH</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">HLTHPLN1</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">PERSDOC2</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">DIABETE4</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">_RFBING5</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">_RFDRHV7</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">RENTHOM1</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">_IMPRACE</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">_URBSTAT</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">EDUCA</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">EMPLOY1</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">INCOME2</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">_TOTINDA</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">_RFSMOK3</span><span class="sh">'</span><span class="p">]</span>
<span class="n">predict</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nf">get_dummies</span><span class="p">(</span><span class="n">brfss</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="n">categorical_variables</span><span class="p">)</span>
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">predict</span><span class="p">.</span><span class="nf">head</span><span class="p">()</span>
</code></pre></div></div> <div> <style scoped="">.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</style> <table border="1" class="dataframe"> <thead> <tr style="text-align: right;"> <th></th> <th>MEDCOST</th> <th>_RFHYPE5</th> <th>TOLDHI2</th> <th>CVDINFR4</th> <th>CVDCRHD4</th> <th>CVDSTRK3</th> <th>ASTHMA3</th> <th>CHCSCNCR</th> <th>CHCOCNCR</th> <th>CHCCOPD2</th> <th>...</th> <th>INCOME2_Less than $15,000 ($10,000 to less than $15,000)</th> <th>INCOME2_Less than $20,000 ($15,000 to less than $20,000)</th> <th>INCOME2_Less than $25,000 ($20,000 to less than $25,000)</th> <th>INCOME2_Less than $35,000 ($25,000 to less than $35,000)</th> <th>INCOME2_Less than $50,000 ($35,000 to less than $50,000)</th> <th>INCOME2_Less than $75,000 ($50,000 to less than $75,000)</th> <th>_TOTINDA_Had physical activity or exercise</th> <th>_TOTINDA_No physical activity or exercise in last 30 days</th> <th>_RFSMOK3_No</th> <th>_RFSMOK3_Yes</th> </tr> </thead> <tbody> <tr> <th>0</th> <td>No</td> <td>Yes</td> <td>Yes</td> <td>No</td> <td>No</td> <td>No</td> <td>No</td> <td>No</td> <td>No</td> <td>No</td> <td>...</td> <td>0</td> <td>1</td> <td>0</td> <td>0</td> <td>0</td> <td>0</td> <td>0</td> <td>1</td> <td>1</td> <td>0</td> </tr> <tr> <th>1</th> <td>No</td> <td>No</td> <td>No</td> <td>No</td> <td>No</td> <td>No</td> <td>No</td> <td>No</td> <td>No</td> <td>No</td> <td>...</td> <td>0</td> <td>0</td> <td>0</td> <td>1</td> <td>0</td> <td>0</td> <td>1</td> <td>0</td> <td>1</td> <td>0</td> </tr> <tr> <th>2</th> <td>No</td> <td>Yes</td> <td>No</td> <td>No</td> <td>No</td> <td>No</td> <td>No</td> <td>No</td> <td>No</td> <td>No</td> <td>...</td> <td>0</td> <td>0</td> <td>0</td> <td>0</td> <td>0</td> <td>1</td> <td>1</td> <td>0</td> <td>1</td> <td>0</td> </tr> <tr> <th>3</th> <td>No</td> <td>No</td> <td>No</td> <td>No</td> <td>No</td> <td>No</td> <td>Yes</td> <td>No</td> <td>No</td> <td>Yes</td> <td>...</td> <td>0</td> <td>0</td> <td>0</td> <td>0</td> <td>0</td> <td>1</td> <td>1</td> <td>0</td> <td>0</td> <td>1</td> </tr> <tr> <th>4</th> <td>No</td> <td>No</td> <td>Yes</td> <td>No</td> <td>No</td> <td>No</td> <td>Yes</td> <td>No</td> <td>No</td> <td>Yes</td> <td>...</td> <td>0</td> <td>1</td> <td>0</td> <td>0</td> <td>0</td> <td>0</td> <td>0</td> <td>1</td> <td>1</td> <td>0</td> </tr> </tbody> </table> <p>5 rows × 80 columns</p> </div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">predict</span> <span class="o">=</span> <span class="n">predict</span><span class="p">.</span><span class="nf">drop</span><span class="p">(</span><span class="n">predict</span><span class="p">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">24</span><span class="p">],</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>

</code></pre></div></div> <p>First, we need to get these boolean values to match up with our county info, so when we use the model later we can use the same variables.</p> <ul> <li>GENHLTH: <ul> <li>Change GENHLTH columns to “GENHLTH_Poor_or_Fair”</li> <li>Matched county % poor or fair health in Ranked Measure data</li> </ul> </li> <li>HLTHPLN1 <ul> <li>Matches inverse of county % uninsured in Additional Measure data</li> </ul> </li> <li>DIABETE4 <ul> <li>Change DIABETE4 columns to combine Yes’s and No’s</li> <li>Matches % adults with diabetes in Additional Measure data</li> </ul> </li> <li>_RFBING5 and _RFDRHV7 <ul> <li>Combine so binge and heavy drinking are one category</li> <li>Matches excessive drinking in Ranked Measure data</li> </ul> </li> <li>RENTHOM1 <ul> <li>Own == 1, else == 0</li> <li>Matches % homeowners</li> </ul> </li> <li>_IMPRACE <ul> <li>Should be able to keep the same</li> <li>Matches demographic %s in Additional Measure Data</li> </ul> </li> <li>_URBSTAT <ul> <li>replace with Boolean for rural</li> <li>matches inverse of % rural</li> </ul> </li> <li>EDUCA <ul> <li>“Grade 12 or GED (High school graduate)”</li> <li>matches “High school graduation rate” in ranked measure data</li> <li>“College 1 year to 3 years (Some college or technical school)” or “College 4 years or more (College graduate)” == % some college</li> </ul> </li> <li>EMPLOY1 <ul> <li>“Out of work for 1 year or more” or “Out of work for less than 1 year” or “Unable to work” == % unemployment rate in Ranked measure data</li> </ul> </li> <li>INCOME2: <ul> <li>group “Household Income (AIAN)” into same groups as above</li> </ul> </li> <li>_TOTINDA <ul> <li>only “No physical activity…”</li> <li>% physically inactive</li> </ul> </li> <li>_RFSMOK3_Yes <ul> <li>% smokers</li> </ul> </li> </ul> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">X</span> <span class="o">=</span> <span class="n">predict</span><span class="p">.</span><span class="nf">copy</span><span class="p">()</span>
</code></pre></div></div> <h3 id="rural">Rural</h3> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">X</span><span class="p">[</span><span class="sh">'</span><span class="s">Rural</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[{</span> <span class="sh">"</span><span class="s">Urban counties (_URBNRRL = 1,2,3,4,5)</span><span class="sh">"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="sh">"</span><span class="s">Rural counties (_URBNRRL = 6)</span><span class="sh">"</span><span class="p">:</span><span class="mi">1</span><span class="p">}[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">brfss</span><span class="p">.</span><span class="n">_URBSTAT</span><span class="p">]</span>
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">X</span> <span class="o">=</span> <span class="n">X</span><span class="p">.</span><span class="nf">drop</span><span class="p">([</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">X</span><span class="p">.</span><span class="n">columns</span> <span class="k">if</span> <span class="sh">"</span><span class="s">URBSTAT</span><span class="sh">"</span> <span class="ow">in</span> <span class="nf">str</span><span class="p">(</span><span class="n">i</span><span class="p">)],</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
</code></pre></div></div> <h3 id="diabetes">Diabetes</h3> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">X</span><span class="p">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">X</span><span class="p">[</span><span class="sh">'</span><span class="s">DIABETE4_Yes, but female told only during pregnancy</span><span class="sh">'</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="o">|</span>
      <span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="sh">"</span><span class="s">DIABETE4_Yes</span><span class="sh">"</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">),</span> <span class="sh">'</span><span class="s">Diabetes</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">X</span><span class="p">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">X</span><span class="p">[</span><span class="sh">'</span><span class="s">DIABETE4_Yes, but female told only during pregnancy</span><span class="sh">'</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span>
      <span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="sh">"</span><span class="s">DIABETE4_Yes</span><span class="sh">"</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">),</span> <span class="sh">'</span><span class="s">Diabetes</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">X</span> <span class="o">=</span> <span class="n">X</span><span class="p">.</span><span class="nf">drop</span><span class="p">([</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">X</span><span class="p">.</span><span class="n">columns</span> <span class="k">if</span> <span class="sh">"</span><span class="s">DIABETE4</span><span class="sh">"</span> <span class="ow">in</span> <span class="nf">str</span><span class="p">(</span><span class="n">i</span><span class="p">)],</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
</code></pre></div></div> <h3 id="genhlth">GENHLTH</h3> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">X</span><span class="p">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">X</span><span class="p">[</span><span class="sh">'</span><span class="s">GENHLTH_Fair</span><span class="sh">'</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="o">|</span>
      <span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="sh">"</span><span class="s">GENHLTH_Poor</span><span class="sh">"</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">),</span> <span class="sh">'</span><span class="s">General_health</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">X</span><span class="p">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">X</span><span class="p">[</span><span class="sh">'</span><span class="s">GENHLTH_Fair</span><span class="sh">'</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span>
      <span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="sh">"</span><span class="s">GENHLTH_Poor</span><span class="sh">"</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">),</span> <span class="sh">'</span><span class="s">General_health</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">X</span> <span class="o">=</span> <span class="n">X</span><span class="p">.</span><span class="nf">drop</span><span class="p">([</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">X</span><span class="p">.</span><span class="n">columns</span> <span class="k">if</span> <span class="sh">"</span><span class="s">GENHLTH</span><span class="sh">"</span> <span class="ow">in</span> <span class="nf">str</span><span class="p">(</span><span class="n">i</span><span class="p">)],</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
</code></pre></div></div> <h3 id="hlthpln1">HLTHPLN1</h3> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">X</span><span class="p">[</span><span class="sh">'</span><span class="s">Health_plan</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">X</span><span class="p">.</span><span class="n">HLTHPLN1_Yes</span>
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">X</span> <span class="o">=</span> <span class="n">X</span><span class="p">.</span><span class="nf">drop</span><span class="p">([</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">X</span><span class="p">.</span><span class="n">columns</span> <span class="k">if</span> <span class="sh">"</span><span class="s">HLTHPLN1</span><span class="sh">"</span> <span class="ow">in</span> <span class="nf">str</span><span class="p">(</span><span class="n">i</span><span class="p">)],</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
</code></pre></div></div> <h3 id="_rfbing5-and-_rfdrhv7">_RFBING5 and _RFDRHV7</h3> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">X</span><span class="p">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">X</span><span class="p">.</span><span class="n">_RFDRHV7_Yes</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="o">|</span>
      <span class="p">(</span><span class="n">X</span><span class="p">.</span><span class="n">_RFBING5_Yes</span><span class="o">==</span><span class="mi">1</span><span class="p">),</span> <span class="sh">'</span><span class="s">Excessive_drinking</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">X</span><span class="p">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">X</span><span class="p">[</span><span class="sh">'</span><span class="s">_RFDRHV7_Yes</span><span class="sh">'</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span>
      <span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="sh">"</span><span class="s">_RFBING5_Yes</span><span class="sh">"</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">),</span> <span class="sh">'</span><span class="s">Excessive_drinking</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">X</span> <span class="o">=</span> <span class="n">X</span><span class="p">.</span><span class="nf">drop</span><span class="p">([</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">X</span><span class="p">.</span><span class="n">columns</span> <span class="k">if</span> <span class="sh">"</span><span class="s">_RFDRHV</span><span class="sh">"</span> <span class="ow">in</span> <span class="nf">str</span><span class="p">(</span><span class="n">i</span><span class="p">)],</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">X</span><span class="p">.</span><span class="nf">drop</span><span class="p">([</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">X</span><span class="p">.</span><span class="n">columns</span> <span class="k">if</span> <span class="sh">"</span><span class="s">_RFBING</span><span class="sh">"</span> <span class="ow">in</span> <span class="nf">str</span><span class="p">(</span><span class="n">i</span><span class="p">)],</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
</code></pre></div></div> <h3 id="renthom1">RENTHOM1</h3> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">X</span><span class="p">[</span><span class="sh">'</span><span class="s">Owns_home</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="sh">'</span><span class="s">RENTHOM1_Own</span><span class="sh">'</span><span class="p">]</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">X</span><span class="p">.</span><span class="nf">drop</span><span class="p">([</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">X</span><span class="p">.</span><span class="n">columns</span> <span class="k">if</span> <span class="sh">"</span><span class="s">RENTHOM1</span><span class="sh">"</span> <span class="ow">in</span> <span class="nf">str</span><span class="p">(</span><span class="n">i</span><span class="p">)],</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
</code></pre></div></div> <h3 id="educa">EDUCA</h3> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">X</span><span class="p">[</span><span class="sh">'</span><span class="s">High_school_grad</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="sh">'</span><span class="s">EDUCA_Grade 12 or GED (High school graduate)</span><span class="sh">'</span><span class="p">]</span>
<span class="n">X</span><span class="p">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">X</span><span class="p">[</span><span class="sh">'</span><span class="s">EDUCA_College 1 year to 3 years (Some college or technical school)</span><span class="sh">'</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="o">|</span>
      <span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="sh">'</span><span class="s">EDUCA_College 4 years or more (College graduate)</span><span class="sh">'</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">),</span> <span class="sh">'</span><span class="s">College</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">X</span><span class="p">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">X</span><span class="p">[</span><span class="sh">'</span><span class="s">EDUCA_College 1 year to 3 years (Some college or technical school)</span><span class="sh">'</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span>
      <span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="sh">"</span><span class="s">EDUCA_College 4 years or more (College graduate)</span><span class="sh">"</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">),</span> <span class="sh">'</span><span class="s">College</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">X</span> <span class="o">=</span> <span class="n">X</span><span class="p">.</span><span class="nf">drop</span><span class="p">([</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">X</span><span class="p">.</span><span class="n">columns</span> <span class="k">if</span> <span class="sh">"</span><span class="s">EDUCA</span><span class="sh">"</span> <span class="ow">in</span> <span class="nf">str</span><span class="p">(</span><span class="n">i</span><span class="p">)],</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
</code></pre></div></div> <h3 id="employ1">EMPLOY1</h3> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">X</span><span class="p">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">X</span><span class="p">[</span><span class="sh">'</span><span class="s">EMPLOY1_Out of work for 1 year or more</span><span class="sh">'</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="o">|</span>
      <span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="sh">'</span><span class="s">EMPLOY1_Out of work for less than 1 year</span><span class="sh">'</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="o">|</span>
      <span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="sh">'</span><span class="s">EMPLOY1_Unable to work</span><span class="sh">'</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">),</span> <span class="sh">'</span><span class="s">Unemployed</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">X</span><span class="p">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">X</span><span class="p">[</span><span class="sh">'</span><span class="s">EMPLOY1_Out of work for 1 year or more</span><span class="sh">'</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span>
      <span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="sh">'</span><span class="s">EMPLOY1_Out of work for less than 1 year</span><span class="sh">'</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span>
      <span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="sh">'</span><span class="s">EMPLOY1_Unable to work</span><span class="sh">'</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">),</span> <span class="sh">'</span><span class="s">Unemployed</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">X</span> <span class="o">=</span> <span class="n">X</span><span class="p">.</span><span class="nf">drop</span><span class="p">([</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">X</span><span class="p">.</span><span class="n">columns</span> <span class="k">if</span> <span class="sh">"</span><span class="s">EMPLOY1</span><span class="sh">"</span> <span class="ow">in</span> <span class="nf">str</span><span class="p">(</span><span class="n">i</span><span class="p">)],</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
</code></pre></div></div> <h3 id="_totinda">_TOTINDA</h3> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">X</span><span class="p">[</span><span class="sh">'</span><span class="s">Inactivity</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="sh">'</span><span class="s">_TOTINDA_No physical activity or exercise in last 30 days</span><span class="sh">'</span><span class="p">]</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">X</span><span class="p">.</span><span class="nf">drop</span><span class="p">([</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">X</span><span class="p">.</span><span class="n">columns</span> <span class="k">if</span> <span class="sh">"</span><span class="s">_TOTINDA</span><span class="sh">"</span> <span class="ow">in</span> <span class="nf">str</span><span class="p">(</span><span class="n">i</span><span class="p">)],</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
</code></pre></div></div> <h3 id="_rfsmok3_yes">_RFSMOK3_Yes</h3> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">X</span><span class="p">[</span><span class="sh">'</span><span class="s">Smoker</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">X</span><span class="p">.</span><span class="n">_RFSMOK3_Yes</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">X</span><span class="p">.</span><span class="nf">drop</span><span class="p">([</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">X</span><span class="p">.</span><span class="n">columns</span> <span class="k">if</span> <span class="sh">"</span><span class="s">_RFSMOK3</span><span class="sh">"</span> <span class="ow">in</span> <span class="nf">str</span><span class="p">(</span><span class="n">i</span><span class="p">)],</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">X</span> <span class="o">=</span> <span class="n">X</span><span class="p">.</span><span class="nf">drop</span><span class="p">([</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">X</span><span class="p">.</span><span class="n">columns</span> <span class="k">if</span> <span class="sh">"</span><span class="s">PERSDOC</span><span class="sh">"</span> <span class="ow">in</span> <span class="nf">str</span><span class="p">(</span><span class="n">i</span><span class="p">)],</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">X</span><span class="p">.</span><span class="nf">info</span><span class="p">()</span>
</code></pre></div></div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 262049 entries, 0 to 262048
Data columns (total 26 columns):
 #   Column                                                    Non-Null Count   Dtype  
---  ------                                                    --------------   -----  
 0   target                                                    262049 non-null  bool   
 1   _IMPRACE_American Indian/Alaskan Native, Non-Hispanic     262049 non-null  uint8  
 2   _IMPRACE_Asian, Non-Hispanic                              262049 non-null  uint8  
 3   _IMPRACE_Black, Non-Hispanic                              262049 non-null  uint8  
 4   _IMPRACE_Hispanic                                         262049 non-null  uint8  
 5   _IMPRACE_Other race, Non-Hispanic                         262049 non-null  uint8  
 6   _IMPRACE_White, Non-Hispanic                              262049 non-null  uint8  
 7   INCOME2_$75,000 or more                                   262049 non-null  uint8  
 8   INCOME2_Less than $10,000                                 262049 non-null  uint8  
 9   INCOME2_Less than $15,000 ($10,000 to less than $15,000)  262049 non-null  uint8  
 10  INCOME2_Less than $20,000 ($15,000 to less than $20,000)  262049 non-null  uint8  
 11  INCOME2_Less than $25,000 ($20,000 to less than $25,000)  262049 non-null  uint8  
 12  INCOME2_Less than $35,000 ($25,000 to less than $35,000)  262049 non-null  uint8  
 13  INCOME2_Less than $50,000 ($35,000 to less than $50,000)  262049 non-null  uint8  
 14  INCOME2_Less than $75,000 ($50,000 to less than $75,000)  262049 non-null  uint8  
 15  Rural                                                     262049 non-null  int64  
 16  Diabetes                                                  262049 non-null  float64
 17  General_health                                            262049 non-null  float64
 18  Health_plan                                               262049 non-null  uint8  
 19  Excessive_drinking                                        262049 non-null  float64
 20  Owns_home                                                 262049 non-null  uint8  
 21  High_school_grad                                          262049 non-null  uint8  
 22  College                                                   262049 non-null  float64
 23  Unemployed                                                262049 non-null  float64
 24  Inactivity                                                262049 non-null  uint8  
 25  Smoker                                                    262049 non-null  uint8  
dtypes: bool(1), float64(5), int64(1), uint8(19)
memory usage: 17.0 MB
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">X</span><span class="p">.</span><span class="nf">to_csv</span><span class="p">(</span><span class="sh">"</span><span class="s">../data/predictors.csv</span><span class="sh">"</span><span class="p">)</span>
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">y</span> <span class="o">=</span> <span class="n">X</span><span class="p">.</span><span class="nf">pop</span><span class="p">(</span><span class="sh">'</span><span class="s">target</span><span class="sh">'</span><span class="p">)</span>
</code></pre></div></div> <p>The main objective is to have a model which makes good predictions on <em>unseen</em> data. Therefore, in order to evaluate how good a model is, it is necessary to set aside some data as a test set for evaulation purposes. This can be accomplished using the <code class="language-plaintext highlighter-rouge">train_test_split</code> function.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="nf">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span>
                                                    <span class="n">stratify</span> <span class="o">=</span> <span class="n">y</span><span class="p">,</span>     <span class="c1"># Keep the same proportions of the target in the training and test data
</span>                                                    <span class="n">test_size</span> <span class="o">=</span> <span class="mf">0.25</span><span class="p">,</span>
                                                    <span class="n">random_state</span> <span class="o">=</span> <span class="mi">321</span><span class="p">)</span>
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LogisticRegression</span>
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">logreg</span> <span class="o">=</span> <span class="nc">LogisticRegression</span><span class="p">()</span>         <span class="c1"># Create a logistic regression model
</span><span class="n">logreg</span><span class="p">.</span><span class="nf">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>          <span class="c1"># Fit it to the training data
</span></code></pre></div></div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>LogisticRegression()
</code></pre></div></div> <p>To understand the model, we can look at its coefficients.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">logreg</span><span class="p">.</span><span class="n">intercept_</span>
</code></pre></div></div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>array([-0.06956167])
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">logreg</span><span class="p">.</span><span class="n">coef_</span>
</code></pre></div></div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>array([[-0.15000703, -0.12631886,  0.53903011, -0.1734734 , -0.12965132,
        -0.02906713, -0.17897394,  0.02512163,  0.13639016,  0.09111363,
         0.06724727, -0.03598943, -0.04823376, -0.12616319, -0.09815453,
         1.19410076,  0.44202482,  1.4508977 , -0.35476091,  0.4756881 ,
         0.01472026, -0.00793255,  0.15622678, -0.04213603, -0.36442622]])
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">y_pred_prob</span> <span class="o">=</span> <span class="n">logreg</span><span class="p">.</span><span class="nf">predict_proba</span><span class="p">(</span><span class="n">X_test</span><span class="p">)[:,</span><span class="mi">1</span><span class="p">]</span>
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">i</span> <span class="o">=</span> <span class="mi">120</span>

<span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="s">Patient Information:</span><span class="se">\n</span><span class="s">{}</span><span class="sh">'</span><span class="p">.</span><span class="nf">format</span><span class="p">(</span><span class="n">X_test</span><span class="p">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="s">---------------------------------</span><span class="sh">'</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="s">Predicted Probability of Checkup in Last Year: {}</span><span class="sh">'</span><span class="p">.</span><span class="nf">format</span><span class="p">(</span><span class="n">y_pred_prob</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="s">Actual: {}</span><span class="sh">'</span><span class="p">.</span><span class="nf">format</span><span class="p">(</span><span class="n">y_test</span><span class="p">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
</code></pre></div></div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Patient Information:
_IMPRACE_American Indian/Alaskan Native, Non-Hispanic       0.0
_IMPRACE_Asian, Non-Hispanic                                0.0
_IMPRACE_Black, Non-Hispanic                                0.0
_IMPRACE_Hispanic                                           0.0
_IMPRACE_Other race, Non-Hispanic                           0.0
_IMPRACE_White, Non-Hispanic                                1.0
INCOME2_$75,000 or more                                     1.0
INCOME2_Less than $10,000                                   0.0
INCOME2_Less than $15,000 ($10,000 to less than $15,000)    0.0
INCOME2_Less than $20,000 ($15,000 to less than $20,000)    0.0
INCOME2_Less than $25,000 ($20,000 to less than $25,000)    0.0
INCOME2_Less than $35,000 ($25,000 to less than $35,000)    0.0
INCOME2_Less than $50,000 ($35,000 to less than $50,000)    0.0
INCOME2_Less than $75,000 ($50,000 to less than $75,000)    0.0
Rural                                                       0.0
Diabetes                                                    0.0
General_health                                              0.0
Health_plan                                                 1.0
Excessive_drinking                                          0.0
Owns_home                                                   1.0
High_school_grad                                            0.0
College                                                     1.0
Unemployed                                                  1.0
Inactivity                                                  0.0
Smoker                                                      0.0
Name: 232982, dtype: float64
---------------------------------
Predicted Probability of Checkup in Last Year: 0.857817177035579
Actual: True
</code></pre></div></div> <p>One way to analyze your model is to look at the receiver operating characteristic (ROC) curve. This shows how the true positive rate and false positive rate change as the prediction threshold changes.</p> <p>This value can be interpreted as how likely the model is to assign a higher probability to a positive observation compared to a negative one.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">sklearn.metrics</span> <span class="kn">import</span> <span class="n">roc_auc_score</span><span class="p">,</span> <span class="n">roc_curve</span>
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">fp_rate</span><span class="p">,</span> <span class="n">tp_rate</span><span class="p">,</span> <span class="n">thresholds</span> <span class="o">=</span> <span class="nf">roc_curve</span><span class="p">(</span><span class="n">y_test</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="n">y_pred_prob</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">fp_rate</span><span class="p">,</span> <span class="n">tp_rate</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">xlim</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">ylim</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">title</span><span class="p">(</span><span class="sh">'</span><span class="s">ROC curve for Heart Disease Prediction</span><span class="sh">'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">xlabel</span><span class="p">(</span><span class="sh">'</span><span class="s">False Positive Rate (1 - Specificity)</span><span class="sh">'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">ylabel</span><span class="p">(</span><span class="sh">'</span><span class="s">True Positive Rate (Sensitivity)</span><span class="sh">'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">grid</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
</code></pre></div></div> <div class="img"> <img src="/assets/img/bb/data-science-project/output_198_0.png" style="height: 100%; width: 100%; object-fit: contain"> </div> <h3 id="auc---percentage-of-the-roc-plot-that-is-under-the-curve">AUC - percentage of the ROC plot that is under the curve</h3> <p>A perfect model would have AUC = 1.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">roc_auc_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_prob</span><span class="p">)</span>
</code></pre></div></div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>0.6789666785879891
</code></pre></div></div> <h2 id="analyzing-predictions">Analyzing Predictions</h2> <p>To generate predictions, you can use the <code class="language-plaintext highlighter-rouge">predict</code> method of your model.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">sklearn.metrics</span> <span class="kn">import</span> <span class="n">confusion_matrix</span><span class="p">,</span> <span class="n">classification_report</span>
<span class="kn">from</span> <span class="n">cm</span> <span class="kn">import</span> <span class="n">plot_confusion_matrix</span>
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">y_pred</span> <span class="o">=</span> <span class="n">logreg</span><span class="p">.</span><span class="nf">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">confusion_matrix</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
</code></pre></div></div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>array([[ 1052, 10492],
       [  772, 53197]])
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">print</span><span class="p">(</span><span class="nf">classification_report</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">))</span>
</code></pre></div></div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>              precision    recall  f1-score   support

       False       0.58      0.09      0.16     11544
        True       0.84      0.99      0.90     53969

    accuracy                           0.83     65513
   macro avg       0.71      0.54      0.53     65513
weighted avg       0.79      0.83      0.77     65513
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">plot_confusion_matrix</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="sh">'</span><span class="s">No</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Yes</span><span class="sh">'</span><span class="p">])</span>
</code></pre></div></div> <div class="img"> <img src="/assets/img/bb/data-science-project/output_206_0.png" style="height: 100%; width: 100%; object-fit: contain"> </div> <p>There are a number of metrics you can use to evalute your model.</p> <p><strong>Accuracy:</strong> the total proportion of predictions which are correct.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">plot_confusion_matrix</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="sh">'</span><span class="s">No</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Yes</span><span class="sh">'</span><span class="p">],</span> <span class="n">metric</span> <span class="o">=</span> <span class="sh">'</span><span class="s">accuracy</span><span class="sh">'</span><span class="p">)</span>
</code></pre></div></div> <div class="img"> <img src="/assets/img/bb/data-science-project/output_208_0.png" style="height: 100%; width: 100%; object-fit: contain"> </div> <p><strong>Sensitivity/True Positive Rate:</strong> The proportion of true positives (in our case, people who survived) that are identified as such.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">plot_confusion_matrix</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="sh">'</span><span class="s">No</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Yes</span><span class="sh">'</span><span class="p">],</span> <span class="n">metric</span> <span class="o">=</span> <span class="sh">'</span><span class="s">sensitivity</span><span class="sh">'</span><span class="p">)</span>
</code></pre></div></div> <div class="img"> <img src="/assets/img/bb/data-science-project/output_210_0.png" style="height: 100%; width: 100%; object-fit: contain"> </div> <p><strong>Specificity/True Negative Rate:</strong> The proportion of true negatives (in our case, people who died) that are identified as such.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">plot_confusion_matrix</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="sh">'</span><span class="s">No</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Yes</span><span class="sh">'</span><span class="p">],</span> <span class="n">metric</span> <span class="o">=</span> <span class="sh">'</span><span class="s">specificity</span><span class="sh">'</span><span class="p">)</span>
</code></pre></div></div> <div class="img"> <img src="/assets/img/bb/data-science-project/output_212_0.png" style="height: 100%; width: 100%; object-fit: contain"> </div> <p><strong>Precision:</strong> The proportion of predicted positives that are actually positive (survived).</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">plot_confusion_matrix</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="sh">'</span><span class="s">No</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Yes</span><span class="sh">'</span><span class="p">],</span> <span class="n">metric</span> <span class="o">=</span> <span class="sh">'</span><span class="s">precision</span><span class="sh">'</span><span class="p">)</span>
</code></pre></div></div> <div class="img"> <img src="/assets/img/bb/data-science-project/output_214_0.png" style="height: 100%; width: 100%; object-fit: contain"> </div> <p>We have only used a single predictor in the above model. Let’s see if we can improve our model by using the rest of the predictors.</p> <p>With so many predictors, it takes longer for the coefficients to converge. Let’s increase the number of iterations.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">logreg</span> <span class="o">=</span> <span class="nc">LogisticRegression</span><span class="p">(</span><span class="n">max_iter</span> <span class="o">=</span> <span class="mi">10000</span><span class="p">)</span>
<span class="n">logreg</span><span class="p">.</span><span class="nf">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</code></pre></div></div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>LogisticRegression(max_iter=10000)
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">y_test</span>
</code></pre></div></div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>149338     True
201150     True
63901      True
17995     False
192704     True
          ...  
218617     True
181851     True
54798      True
177920    False
22276      True
Name: target, Length: 65513, dtype: bool
</code></pre></div></div> <p>Let’s take a look at the coefficients.</p> <p><strong>Caution:</strong> Our variables are on vastly different scales, so do not interpret the value of a coefficient as the importance.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">coefficients</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nc">DataFrame</span><span class="p">({</span>
    <span class="sh">'</span><span class="s">variable</span><span class="sh">'</span><span class="p">:</span> <span class="n">X</span><span class="p">.</span><span class="n">columns</span><span class="p">,</span>
    <span class="sh">'</span><span class="s">coefficient</span><span class="sh">'</span><span class="p">:</span> <span class="n">logreg</span><span class="p">.</span><span class="n">coef_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="p">})</span>
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">importances</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nc">DataFrame</span><span class="p">({</span><span class="sh">'</span><span class="s">variable</span><span class="sh">'</span><span class="p">:</span> <span class="n">coefficients</span><span class="p">.</span><span class="n">variable</span><span class="p">,</span>
                           <span class="sh">'</span><span class="s">importance</span><span class="sh">'</span><span class="p">:</span> <span class="n">coefficients</span><span class="p">.</span><span class="n">coefficient</span><span class="p">}).</span><span class="nf">sort_values</span><span class="p">(</span><span class="sh">'</span><span class="s">importance</span><span class="sh">'</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="bp">False</span><span class="p">)</span>


<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">subplots</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">sns</span><span class="p">.</span><span class="nf">barplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">importances</span><span class="p">,</span>
            <span class="n">x</span> <span class="o">=</span> <span class="sh">'</span><span class="s">importance</span><span class="sh">'</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="sh">'</span><span class="s">variable</span><span class="sh">'</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="sh">'</span><span class="s">black</span><span class="sh">'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">title</span><span class="p">(</span><span class="sh">'</span><span class="s">Logistic Regression Coefficients</span><span class="sh">'</span><span class="p">);</span>
</code></pre></div></div> <div class="img"> <img src="/assets/img/bb/data-science-project/output_221_0.png" style="height: 100%; width: 100%; object-fit: contain"> </div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">subplots</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">sns</span><span class="p">.</span><span class="nf">barplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">coefficients</span><span class="p">,</span>
            <span class="n">x</span> <span class="o">=</span> <span class="sh">'</span><span class="s">coefficient</span><span class="sh">'</span><span class="p">,</span> 
            <span class="n">y</span> <span class="o">=</span> <span class="sh">'</span><span class="s">variable</span><span class="sh">'</span><span class="p">,</span> 
            <span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span><span class="p">,</span> 
            <span class="n">edgecolor</span> <span class="o">=</span> <span class="sh">'</span><span class="s">black</span><span class="sh">'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">title</span><span class="p">(</span><span class="sh">'</span><span class="s">Logistic Regression Coefficients</span><span class="sh">'</span><span class="p">)</span>

<span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">ylim</span><span class="p">()</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">vlines</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">ymin</span> <span class="o">=</span> <span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span> <span class="o">=</span> <span class="n">ymax</span><span class="p">);</span>
</code></pre></div></div> <div class="img"> <img src="/assets/img/bb/data-science-project/output_222_0.png" style="height: 100%; width: 100%; object-fit: contain"> </div> <p>Try using regularization or a tree-based model to improve your model’s performance on the BRFSS dataset.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">sklearn.tree</span> <span class="kn">import</span> <span class="n">DecisionTreeClassifier</span>
</code></pre></div></div> <p>A decision tree model is fit in much the same way as a logistic regression model.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">tree</span> <span class="o">=</span> <span class="nc">DecisionTreeClassifier</span><span class="p">(</span><span class="n">random_state</span> <span class="o">=</span> <span class="mi">321</span><span class="p">).</span><span class="nf">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</code></pre></div></div> <p>First, let’s see how it does on the training data.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">y_pred</span> <span class="o">=</span> <span class="n">tree</span><span class="p">.</span><span class="nf">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="nf">plot_confusion_matrix</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">tree</span><span class="p">.</span><span class="nf">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">),</span> <span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="sh">'</span><span class="s">No</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Yes</span><span class="sh">'</span><span class="p">],</span> <span class="n">metric</span> <span class="o">=</span> <span class="sh">'</span><span class="s">accuracy</span><span class="sh">'</span><span class="p">)</span>
</code></pre></div></div> <div class="img"> <img src="/assets/img/bb/data-science-project/output_229_0.png" style="height: 100%; width: 100%; object-fit: contain"> </div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">y_train</span><span class="p">.</span><span class="nf">value_counts</span><span class="p">()</span>
</code></pre></div></div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>True     161906
False     34630
Name: target, dtype: int64
</code></pre></div></div> <p>Since decision trees are so flexible, they will often perfectly predict the training data. Remember though, that what we care about is how well the model generalizes.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">y_pred</span> <span class="o">=</span> <span class="n">tree</span><span class="p">.</span><span class="nf">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="nf">plot_confusion_matrix</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="sh">'</span><span class="s">No</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Yes</span><span class="sh">'</span><span class="p">],</span> <span class="n">metric</span> <span class="o">=</span> <span class="sh">'</span><span class="s">accuracy</span><span class="sh">'</span><span class="p">)</span>
</code></pre></div></div> <div class="img"> <img src="/assets/img/bb/data-science-project/output_232_0.png" style="height: 100%; width: 100%; object-fit: contain"> </div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">roc_auc_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">tree</span><span class="p">.</span><span class="nf">predict_proba</span><span class="p">(</span><span class="n">X_test</span><span class="p">)[:,</span><span class="mi">1</span><span class="p">])</span>
</code></pre></div></div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>0.6345258214120431
</code></pre></div></div> <p>We do see a drop in model performance on the test data. This is a sign of overfitting.</p> <p>To correct for this problem, we can take an ensemble approach, which means that we will build many decision trees on subsets of the features and data and then average the predictions of all of the trees. This will force our model to try and find more general patterns that will work on the test set.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestClassifier</span>
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">forest</span> <span class="o">=</span> <span class="nc">RandomForestClassifier</span><span class="p">(</span><span class="n">random_state</span> <span class="o">=</span> <span class="mi">321</span><span class="p">)</span>
<span class="n">forest</span><span class="p">.</span><span class="nf">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</code></pre></div></div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>RandomForestClassifier(random_state=321)
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">y_pred</span> <span class="o">=</span> <span class="n">forest</span><span class="p">.</span><span class="nf">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="nf">plot_confusion_matrix</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="sh">'</span><span class="s">No</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Yes</span><span class="sh">'</span><span class="p">],</span> <span class="n">metric</span> <span class="o">=</span> <span class="sh">'</span><span class="s">accuracy</span><span class="sh">'</span><span class="p">)</span>
</code></pre></div></div> <div class="img"> <img src="/assets/img/bb/data-science-project/output_237_0.png" style="height: 100%; width: 100%; object-fit: contain"> </div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">roc_auc_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">forest</span><span class="p">.</span><span class="nf">predict_proba</span><span class="p">(</span><span class="n">X_test</span><span class="p">)[:,</span><span class="mi">1</span><span class="p">])</span>
</code></pre></div></div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>0.6501432873215749
</code></pre></div></div> <p>We see some improvement over using a single tree, but we could do better. Random forests have a lot of hyperparameters that can be tuned to improve out model. Here are a few of these parameters:</p> <ul> <li> <strong>n_estimators:</strong> Number of decision trees to train. Default is 10. More trees = less variance, but slower to train and predict</li> <li> <strong>max_depth:</strong> Maximum depth (number of splits). By default, there is no max depth.</li> <li> <strong>min_samples_leaf:</strong> Minimum number of samples per leaf. Setting this higher keeps the decision trees from paying too much attention to any single data point.</li> </ul> <p>These parameters can be tuned to try to improve the model that you get, and there are ways to automatically tune these parameters. See, for example, sklearn’s GridSearchCV or RandomSearchCV.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">forest</span> <span class="o">=</span> <span class="nc">RandomForestClassifier</span><span class="p">(</span><span class="n">n_estimators</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">,</span> <span class="n">max_depth</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="n">min_samples_leaf</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="n">random_state</span> <span class="o">=</span> <span class="mi">321</span><span class="p">)</span>
<span class="n">forest</span><span class="p">.</span><span class="nf">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</code></pre></div></div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>RandomForestClassifier(max_depth=5, min_samples_leaf=5, n_estimators=1000,
                       random_state=321)
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">y_pred</span> <span class="o">=</span> <span class="n">forest</span><span class="p">.</span><span class="nf">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="nf">plot_confusion_matrix</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="sh">'</span><span class="s">No</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Yes</span><span class="sh">'</span><span class="p">],</span> <span class="n">metric</span> <span class="o">=</span> <span class="sh">'</span><span class="s">accuracy</span><span class="sh">'</span><span class="p">)</span>
</code></pre></div></div> <div class="img"> <img src="/assets/img/bb/data-science-project/output_241_0.png" style="height: 100%; width: 100%; object-fit: contain"> </div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">plot_confusion_matrix</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="sh">'</span><span class="s">No</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Yes</span><span class="sh">'</span><span class="p">],</span> <span class="n">metric</span> <span class="o">=</span> <span class="sh">'</span><span class="s">sensitivity</span><span class="sh">'</span><span class="p">)</span>
</code></pre></div></div> <div class="img"> <img src="/assets/img/bb/data-science-project/output_243_0.png" style="height: 100%; width: 100%; object-fit: contain"> </div> <p><strong>Specificity/True Negative Rate:</strong> The proportion of true negatives (in our case, people who died) that are identified as such.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">plot_confusion_matrix</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="sh">'</span><span class="s">No</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Yes</span><span class="sh">'</span><span class="p">],</span> <span class="n">metric</span> <span class="o">=</span> <span class="sh">'</span><span class="s">specificity</span><span class="sh">'</span><span class="p">)</span>
</code></pre></div></div> <div class="img"> <img src="/assets/img/bb/data-science-project/output_245_0.png" style="height: 100%; width: 100%; object-fit: contain"> </div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">roc_auc_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">forest</span><span class="p">.</span><span class="nf">predict_proba</span><span class="p">(</span><span class="n">X_test</span><span class="p">)[:,</span><span class="mi">1</span><span class="p">])</span>
</code></pre></div></div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>0.678213761501158
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">fp_rate</span><span class="p">,</span> <span class="n">tp_rate</span><span class="p">,</span> <span class="n">thresholds</span> <span class="o">=</span> <span class="nf">roc_curve</span><span class="p">(</span><span class="n">y_test</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="n">forest</span><span class="p">.</span><span class="nf">predict_proba</span><span class="p">(</span><span class="n">X_test</span><span class="p">)[:,</span><span class="mi">1</span><span class="p">])</span>

<span class="n">plt</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">fp_rate</span><span class="p">,</span> <span class="n">tp_rate</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">xlim</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">ylim</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">title</span><span class="p">(</span><span class="sh">'</span><span class="s">ROC curve for Heart Disease Prediction</span><span class="sh">'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">xlabel</span><span class="p">(</span><span class="sh">'</span><span class="s">False Positive Rate (1 - Specificity)</span><span class="sh">'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">ylabel</span><span class="p">(</span><span class="sh">'</span><span class="s">True Positive Rate (Sensitivity)</span><span class="sh">'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">grid</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
</code></pre></div></div> <div class="img"> <img src="/assets/img/bb/data-science-project/output_247_0.png" style="height: 100%; width: 100%; object-fit: contain"> </div> <p>A nice perk of using random forest models is that we can see which features are the most important in making predictions.</p> <p><strong>Caution:</strong> Feature importances tell which features the model is using, but not <em>how</em> it is using those features.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">importances</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nc">DataFrame</span><span class="p">({</span><span class="sh">'</span><span class="s">variable</span><span class="sh">'</span><span class="p">:</span> <span class="n">X</span><span class="p">.</span><span class="n">columns</span><span class="p">,</span>
                           <span class="sh">'</span><span class="s">importance</span><span class="sh">'</span><span class="p">:</span> <span class="n">forest</span><span class="p">.</span><span class="n">feature_importances_</span><span class="p">}).</span><span class="nf">sort_values</span><span class="p">(</span><span class="sh">'</span><span class="s">importance</span><span class="sh">'</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="bp">False</span><span class="p">)</span>


<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">subplots</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">sns</span><span class="p">.</span><span class="nf">barplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">importances</span><span class="p">,</span>
            <span class="n">x</span> <span class="o">=</span> <span class="sh">'</span><span class="s">importance</span><span class="sh">'</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="sh">'</span><span class="s">variable</span><span class="sh">'</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="sh">'</span><span class="s">black</span><span class="sh">'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">title</span><span class="p">(</span><span class="sh">'</span><span class="s">Random Forest Feature Importance</span><span class="sh">'</span><span class="p">);</span>
</code></pre></div></div> <div class="img"> <img src="/assets/img/bb/data-science-project/output_249_0.png" style="height: 100%; width: 100%; object-fit: contain"> </div> <h2 id="apply-this-model-to-the-counties-you-identified-above-to-predict-how-likely-it-is-that-the-average-person-from-those-counties-has-not-had-a-checkup-in-the-last-year">Apply this model to the counties you identified above to predict how likely it is that the average person from those counties has not had a checkup in the last year.</h2> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df1</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nf">read_csv</span><span class="p">(</span><span class="sh">'</span><span class="s">../data/County_Health_Rankings/Ranked_measure_data_TN.csv</span><span class="sh">'</span><span class="p">,</span> <span class="n">header</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">index_col</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">df1</span><span class="p">.</span><span class="nf">head</span><span class="p">()</span>
</code></pre></div></div> <div> <style scoped="">.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</style> <table border="1" class="dataframe"> <thead> <tr style="text-align: right;"> <th></th> <th>State</th> <th>County</th> <th>Deaths</th> <th>Years of Potential Life Lost Rate</th> <th>95% CI - Low</th> <th>95% CI - High</th> <th>Quartile</th> <th>YPLL Rate (AIAN)</th> <th>YPLL Rate (AIAN) 95% CI - Low</th> <th>YPLL Rate (AIAN) 95% CI - High</th> <th>...</th> <th>% Drive Alone (Hispanic) 95% CI - Low</th> <th>% Drive Alone (Hispanic) 95% CI - High</th> <th>% Drive Alone (White)</th> <th>% Drive Alone (White) 95% CI - Low</th> <th>% Drive Alone (White) 95% CI - High</th> <th># Workers who Drive Alone</th> <th>% Long Commute - Drives Alone</th> <th>95% CI - Low.18</th> <th>95% CI - High.18</th> <th>Quartile.34</th> </tr> <tr> <th>FIPS</th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> </tr> </thead> <tbody> <tr> <th>47000</th> <td>Tennessee</td> <td>NaN</td> <td>106691</td> <td>9285</td> <td>9202</td> <td>9368</td> <td>NaN</td> <td>NaN</td> <td>NaN</td> <td>NaN</td> <td>...</td> <td>NaN</td> <td>NaN</td> <td>NaN</td> <td>NaN</td> <td>NaN</td> <td>3003226</td> <td>35</td> <td>34</td> <td>35</td> <td>NaN</td> </tr> <tr> <th>47001</th> <td>Tennessee</td> <td>Anderson</td> <td>1369</td> <td>10009</td> <td>9172</td> <td>10846</td> <td>2.0</td> <td>NaN</td> <td>NaN</td> <td>NaN</td> <td>...</td> <td>63.0</td> <td>96.0</td> <td>90.0</td> <td>89.0</td> <td>92.0</td> <td>32206</td> <td>36</td> <td>32</td> <td>39</td> <td>2.0</td> </tr> <tr> <th>47003</th> <td>Tennessee</td> <td>Bedford</td> <td>859</td> <td>10294</td> <td>9268</td> <td>11319</td> <td>2.0</td> <td>NaN</td> <td>NaN</td> <td>NaN</td> <td>...</td> <td>54.0</td> <td>74.0</td> <td>80.0</td> <td>76.0</td> <td>84.0</td> <td>21250</td> <td>35</td> <td>31</td> <td>38</td> <td>2.0</td> </tr> <tr> <th>47005</th> <td>Tennessee</td> <td>Benton</td> <td>428</td> <td>14479</td> <td>12233</td> <td>16726</td> <td>4.0</td> <td>NaN</td> <td>NaN</td> <td>NaN</td> <td>...</td> <td>NaN</td> <td>NaN</td> <td>NaN</td> <td>NaN</td> <td>NaN</td> <td>5448</td> <td>28</td> <td>23</td> <td>33</td> <td>1.0</td> </tr> <tr> <th>47007</th> <td>Tennessee</td> <td>Bledsoe</td> <td>229</td> <td>8126</td> <td>6427</td> <td>9824</td> <td>1.0</td> <td>NaN</td> <td>NaN</td> <td>NaN</td> <td>...</td> <td>NaN</td> <td>NaN</td> <td>NaN</td> <td>NaN</td> <td>NaN</td> <td>5603</td> <td>53</td> <td>43</td> <td>62</td> <td>4.0</td> </tr> </tbody> </table> <p>5 rows × 239 columns</p> </div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nf">read_csv</span><span class="p">(</span><span class="sh">'</span><span class="s">../data/County_Health_Rankings/Addition_measure_data_TN.csv</span><span class="sh">'</span><span class="p">,</span> <span class="n">header</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">index_col</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">df2</span><span class="p">.</span><span class="nf">head</span><span class="p">()</span>
</code></pre></div></div> <div> <style scoped="">.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</style> <table border="1" class="dataframe"> <thead> <tr style="text-align: right;"> <th></th> <th>State</th> <th>County</th> <th>Life Expectancy</th> <th>95% CI - Low</th> <th>95% CI - High</th> <th>Life Expectancy (AIAN)</th> <th>Life Expectancy (AIAN) 95% CI - Low</th> <th>Life Expectancy (AIAN) 95% CI - High</th> <th>Life Expectancy (Asian)</th> <th>Life Expectancy (Asian) 95% CI - Low</th> <th>...</th> <th>% Hispanic</th> <th># Non-Hispanic White</th> <th>% Non-Hispanic White</th> <th># Not Proficient in English</th> <th>% Not Proficient in English</th> <th>95% CI - Low.19</th> <th>95% CI - High.19</th> <th>% Female</th> <th># Rural</th> <th>% Rural</th> </tr> <tr> <th>FIPS</th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> </tr> </thead> <tbody> <tr> <th>47000</th> <td>Tennessee</td> <td>NaN</td> <td>76.0</td> <td>75.9</td> <td>76.1</td> <td>NaN</td> <td>NaN</td> <td>NaN</td> <td>NaN</td> <td>NaN</td> <td>...</td> <td>5.6</td> <td>4989758</td> <td>73.7</td> <td>94554</td> <td>2</td> <td>1.0</td> <td>2.0</td> <td>51.2</td> <td>2132860</td> <td>33.6</td> </tr> <tr> <th>47001</th> <td>Tennessee</td> <td>Anderson</td> <td>75.5</td> <td>74.9</td> <td>76.2</td> <td>NaN</td> <td>NaN</td> <td>NaN</td> <td>NaN</td> <td>NaN</td> <td>...</td> <td>3.1</td> <td>68116</td> <td>89.1</td> <td>619</td> <td>1</td> <td>0.0</td> <td>1.0</td> <td>51.3</td> <td>26041</td> <td>34.7</td> </tr> <tr> <th>47003</th> <td>Tennessee</td> <td>Bedford</td> <td>74.3</td> <td>73.5</td> <td>75.1</td> <td>NaN</td> <td>NaN</td> <td>NaN</td> <td>NaN</td> <td>NaN</td> <td>...</td> <td>12.6</td> <td>37556</td> <td>76.6</td> <td>1474</td> <td>3</td> <td>2.0</td> <td>4.0</td> <td>50.9</td> <td>25053</td> <td>55.6</td> </tr> <tr> <th>47005</th> <td>Tennessee</td> <td>Benton</td> <td>71.7</td> <td>70.2</td> <td>73.2</td> <td>NaN</td> <td>NaN</td> <td>NaN</td> <td>NaN</td> <td>NaN</td> <td>...</td> <td>2.5</td> <td>14970</td> <td>92.5</td> <td>25</td> <td>0</td> <td>0.0</td> <td>1.0</td> <td>51.0</td> <td>12937</td> <td>78.5</td> </tr> <tr> <th>47007</th> <td>Tennessee</td> <td>Bledsoe</td> <td>78.0</td> <td>76.4</td> <td>79.6</td> <td>NaN</td> <td>NaN</td> <td>NaN</td> <td>NaN</td> <td>NaN</td> <td>...</td> <td>2.5</td> <td>13038</td> <td>88.4</td> <td>245</td> <td>2</td> <td>0.0</td> <td>3.0</td> <td>41.1</td> <td>12876</td> <td>100.0</td> </tr> </tbody> </table> <p>5 rows × 269 columns</p> </div> <p>First, we need to get these boolean values to match up with our county info, so when we use the model later we can use the same variables.</p> <ul> <li>GENHLTH: <ul> <li>Matched county % poor or fair health in Ranked Measure data</li> </ul> </li> <li>HLTHPLN1 <ul> <li>Matches inverse of county % uninsured in Additional Measure data</li> </ul> </li> <li>DIABETE4 <ul> <li>Matches % adults with diabetes in Additional Measure data</li> </ul> </li> <li>_RFBING5 and _RFDRHV7 <ul> <li>Matches excessive drinking in Ranked Measure data</li> </ul> </li> <li>RENTHOM1 <ul> <li>Matches % homeowners in Additional</li> </ul> </li> <li>_IMPRACE <ul> <li>Matches demographic %s in Additional Measure Data</li> </ul> </li> <li>_URBSTAT <ul> <li>matches inverse of % rural in additional</li> </ul> </li> <li>EDUCA <ul> <li>“Grade 12 or GED (High school graduate)”</li> <li>matches “High school graduation rate” in ranked measure data</li> <li>“College 1 year to 3 years (Some college or technical school)” or “College 4 years or more (College graduate)” == % some college</li> </ul> </li> <li>EMPLOY1 <ul> <li>“Out of work for 1 year or more” or “Out of work for less than 1 year” or “Unable to work” == % unemployment rate in Ranked measure data</li> </ul> </li> <li>INCOME2: <ul> <li>group “Household Income (AIAN)” into same groups as above in additional</li> </ul> </li> <li>_TOTINDA <ul> <li>% physically inactive in ranked data</li> </ul> </li> <li>_RFSMOK3_Yes <ul> <li>% smokers in ranked</li> </ul> </li> </ul> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># [print(i) for i in df2 if "%" in str(i)]
</span></code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df1</span> <span class="o">=</span> <span class="n">df1</span><span class="p">[[</span><span class="sh">'</span><span class="s">% Fair or Poor Health</span><span class="sh">'</span><span class="p">,</span> <span class="sh">"</span><span class="s">% Excessive Drinking</span><span class="sh">"</span><span class="p">,</span><span class="sh">"</span><span class="s">High School Graduation Rate</span><span class="sh">"</span><span class="p">,</span><span class="sh">"</span><span class="s">% Some College</span><span class="sh">"</span><span class="p">,</span><span class="sh">"</span><span class="s">% Unemployed</span><span class="sh">"</span><span class="p">,</span><span class="sh">"</span><span class="s">% Physically Inactive</span><span class="sh">"</span><span class="p">,</span><span class="sh">"</span><span class="s">% Smokers</span><span class="sh">"</span><span class="p">]]</span>
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df2</span> <span class="o">=</span> <span class="n">df2</span><span class="p">[[</span><span class="sh">"</span><span class="s">% Uninsured</span><span class="sh">"</span><span class="p">,</span><span class="sh">"</span><span class="s">% Adults with Diabetes</span><span class="sh">"</span><span class="p">,</span><span class="sh">"</span><span class="s">% Homeowners</span><span class="sh">"</span><span class="p">,</span><span class="sh">"</span><span class="s">% Rural</span><span class="sh">"</span><span class="p">,</span><span class="sh">"</span><span class="s">Median Household Income</span><span class="sh">"</span><span class="p">,</span>
     <span class="sh">"</span><span class="s">% Non-Hispanic White</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">% Black</span><span class="sh">"</span><span class="p">,</span><span class="sh">"</span><span class="s">% American Indian &amp; Alaska Native</span><span class="sh">"</span><span class="p">,</span><span class="sh">"</span><span class="s">% Asian</span><span class="sh">"</span><span class="p">,</span><span class="sh">"</span><span class="s">% Native Hawaiian/Other Pacific Islander</span><span class="sh">"</span><span class="p">,</span><span class="sh">"</span><span class="s">% Hispanic</span><span class="sh">"</span><span class="p">]]</span>
</code></pre></div></div> <p>We now need to convert these columns to the ones in X.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">county_demo</span> <span class="o">=</span> <span class="n">df1</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="n">df2</span><span class="p">)</span>
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#everything is a percentage except Income, so divide by 100 and then fix income column
</span><span class="n">county_demo</span> <span class="o">=</span> <span class="n">county_demo</span><span class="o">/</span><span class="mi">100</span>
<span class="n">county_demo</span><span class="p">[</span><span class="sh">'</span><span class="s">Median Household Income</span><span class="sh">'</span><span class="p">]</span> <span class="o">*=</span><span class="mi">100</span> 
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">county_demo</span>
</code></pre></div></div> <div> <style scoped="">.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</style> <table border="1" class="dataframe"> <thead> <tr style="text-align: right;"> <th></th> <th>% Fair or Poor Health</th> <th>% Excessive Drinking</th> <th>High School Graduation Rate</th> <th>% Some College</th> <th>% Unemployed</th> <th>% Physically Inactive</th> <th>% Smokers</th> <th>% Uninsured</th> <th>% Adults with Diabetes</th> <th>% Homeowners</th> <th>% Rural</th> <th>Median Household Income</th> <th>% Non-Hispanic White</th> <th>% Black</th> <th>% American Indian &amp; Alaska Native</th> <th>% Asian</th> <th>% Native Hawaiian/Other Pacific Islander</th> <th>% Hispanic</th> </tr> <tr> <th>FIPS</th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> </tr> </thead> <tbody> <tr> <th>47000</th> <td>0.20</td> <td>0.14</td> <td>0.90</td> <td>0.61</td> <td>0.035</td> <td>0.27</td> <td>0.23</td> <td>0.14</td> <td>0.13</td> <td>0.66</td> <td>0.336</td> <td>52366.0</td> <td>0.737</td> <td>0.167</td> <td>0.005</td> <td>0.019</td> <td>0.001</td> <td>0.056</td> </tr> <tr> <th>47001</th> <td>0.19</td> <td>0.14</td> <td>0.92</td> <td>0.58</td> <td>0.038</td> <td>0.26</td> <td>0.21</td> <td>0.13</td> <td>0.11</td> <td>0.68</td> <td>0.347</td> <td>50672.0</td> <td>0.891</td> <td>0.039</td> <td>0.005</td> <td>0.015</td> <td>0.001</td> <td>0.031</td> </tr> <tr> <th>47003</th> <td>0.22</td> <td>0.16</td> <td>0.91</td> <td>0.41</td> <td>0.037</td> <td>0.32</td> <td>0.23</td> <td>0.18</td> <td>0.11</td> <td>0.68</td> <td>0.556</td> <td>49860.0</td> <td>0.766</td> <td>0.076</td> <td>0.011</td> <td>0.011</td> <td>0.002</td> <td>0.126</td> </tr> <tr> <th>47005</th> <td>0.23</td> <td>0.12</td> <td>0.96</td> <td>0.47</td> <td>0.049</td> <td>0.29</td> <td>0.24</td> <td>0.15</td> <td>0.14</td> <td>0.76</td> <td>0.785</td> <td>38940.0</td> <td>0.925</td> <td>0.024</td> <td>0.006</td> <td>0.006</td> <td>0.000</td> <td>0.025</td> </tr> <tr> <th>47007</th> <td>0.23</td> <td>0.15</td> <td>0.85</td> <td>0.38</td> <td>0.058</td> <td>0.26</td> <td>0.25</td> <td>0.18</td> <td>0.10</td> <td>0.74</td> <td>1.000</td> <td>40195.0</td> <td>0.884</td> <td>0.071</td> <td>0.006</td> <td>0.003</td> <td>0.000</td> <td>0.025</td> </tr> <tr> <th>...</th> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> </tr> <tr> <th>47181</th> <td>0.24</td> <td>0.14</td> <td>0.96</td> <td>0.40</td> <td>0.049</td> <td>0.41</td> <td>0.25</td> <td>0.14</td> <td>0.15</td> <td>0.81</td> <td>1.000</td> <td>38879.0</td> <td>0.899</td> <td>0.063</td> <td>0.004</td> <td>0.003</td> <td>0.000</td> <td>0.021</td> </tr> <tr> <th>47183</th> <td>0.22</td> <td>0.14</td> <td>0.92</td> <td>0.56</td> <td>0.042</td> <td>0.34</td> <td>0.22</td> <td>0.12</td> <td>0.11</td> <td>0.66</td> <td>0.670</td> <td>42351.0</td> <td>0.868</td> <td>0.075</td> <td>0.004</td> <td>0.012</td> <td>0.000</td> <td>0.027</td> </tr> <tr> <th>47185</th> <td>0.25</td> <td>0.13</td> <td>0.94</td> <td>0.49</td> <td>0.037</td> <td>0.23</td> <td>0.23</td> <td>0.14</td> <td>0.22</td> <td>0.81</td> <td>0.782</td> <td>42603.0</td> <td>0.930</td> <td>0.018</td> <td>0.005</td> <td>0.004</td> <td>0.001</td> <td>0.028</td> </tr> <tr> <th>47187</th> <td>0.14</td> <td>0.16</td> <td>0.96</td> <td>0.87</td> <td>0.025</td> <td>0.18</td> <td>0.15</td> <td>0.08</td> <td>0.08</td> <td>0.81</td> <td>0.194</td> <td>115930.0</td> <td>0.843</td> <td>0.043</td> <td>0.003</td> <td>0.047</td> <td>0.001</td> <td>0.049</td> </tr> <tr> <th>47189</th> <td>0.17</td> <td>0.17</td> <td>0.96</td> <td>0.69</td> <td>0.028</td> <td>0.21</td> <td>0.18</td> <td>0.10</td> <td>0.11</td> <td>0.77</td> <td>0.385</td> <td>76507.0</td> <td>0.847</td> <td>0.071</td> <td>0.005</td> <td>0.017</td> <td>0.001</td> <td>0.045</td> </tr> </tbody> </table> <p>96 rows × 18 columns</p> </div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">county_demo</span><span class="p">.</span><span class="n">columns</span>
</code></pre></div></div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Index(['% Fair or Poor Health', '% Excessive Drinking',
       'High School Graduation Rate', '% Some College', '% Unemployed',
       '% Physically Inactive', '% Smokers', '% Uninsured',
       '% Adults with Diabetes', '% Homeowners', '% Rural',
       'Median Household Income', '% Non-Hispanic White', '% Black',
       '% American Indian &amp; Alaska Native', '% Asian',
       '% Native Hawaiian/Other Pacific Islander', '% Hispanic'],
      dtype='object')
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">X</span><span class="p">.</span><span class="n">columns</span>
</code></pre></div></div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Index(['_IMPRACE_American Indian/Alaskan Native, Non-Hispanic',
       '_IMPRACE_Asian, Non-Hispanic', '_IMPRACE_Black, Non-Hispanic',
       '_IMPRACE_Hispanic', '_IMPRACE_Other race, Non-Hispanic',
       '_IMPRACE_White, Non-Hispanic', 'INCOME2_$75,000 or more',
       'INCOME2_Less than $10,000',
       'INCOME2_Less than $15,000 ($10,000 to less than $15,000)',
       'INCOME2_Less than $20,000 ($15,000 to less than $20,000)',
       'INCOME2_Less than $25,000 ($20,000 to less than $25,000)',
       'INCOME2_Less than $35,000 ($25,000 to less than $35,000)',
       'INCOME2_Less than $50,000 ($35,000 to less than $50,000)',
       'INCOME2_Less than $75,000 ($50,000 to less than $75,000)', 'Rural',
       'Diabetes', 'General_health', 'Health_plan', 'Excessive_drinking',
       'Owns_home', 'High_school_grad', 'College', 'Unemployed', 'Inactivity',
       'Smoker'],
      dtype='object')
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">column_dict</span> <span class="o">=</span> <span class="p">{</span><span class="sh">'</span><span class="s">% Fair or Poor Health</span><span class="sh">'</span><span class="p">:</span><span class="sh">"</span><span class="s">General_health</span><span class="sh">"</span><span class="p">,</span> <span class="sh">'</span><span class="s">% Excessive Drinking</span><span class="sh">'</span><span class="p">:</span><span class="sh">"</span><span class="s">Excessive_drinking</span><span class="sh">"</span><span class="p">,</span>
<span class="sh">'</span><span class="s">High School Graduation Rate</span><span class="sh">'</span><span class="p">:</span><span class="sh">"</span><span class="s">High_school_grad</span><span class="sh">"</span><span class="p">,</span> <span class="sh">'</span><span class="s">% Some College</span><span class="sh">'</span><span class="p">:</span><span class="sh">"</span><span class="s">College</span><span class="sh">"</span><span class="p">,</span> <span class="sh">'</span><span class="s">% Unemployed</span><span class="sh">'</span><span class="p">:</span><span class="sh">"</span><span class="s">Unemployed</span><span class="sh">"</span><span class="p">,</span>
<span class="sh">'</span><span class="s">% Physically Inactive</span><span class="sh">'</span><span class="p">:</span><span class="sh">"</span><span class="s">Inactivity</span><span class="sh">"</span><span class="p">,</span> <span class="sh">'</span><span class="s">% Smokers</span><span class="sh">'</span><span class="p">:</span><span class="sh">"</span><span class="s">Smoker</span><span class="sh">"</span><span class="p">,</span> <span class="sh">'</span><span class="s">% Uninsured</span><span class="sh">'</span><span class="p">:</span><span class="sh">"</span><span class="s">Health_plan</span><span class="sh">"</span><span class="p">,</span>
<span class="sh">'</span><span class="s">% Adults with Diabetes</span><span class="sh">'</span><span class="p">:</span><span class="sh">"</span><span class="s">Diabetes</span><span class="sh">"</span><span class="p">,</span> <span class="sh">'</span><span class="s">% Homeowners</span><span class="sh">'</span><span class="p">:</span><span class="sh">"</span><span class="s">Owns_home</span><span class="sh">"</span><span class="p">,</span> <span class="sh">'</span><span class="s">% Rural</span><span class="sh">'</span><span class="p">:</span><span class="sh">"</span><span class="s">Rural</span><span class="sh">"</span><span class="p">,</span>
<span class="sh">'</span><span class="s">% Non-Hispanic White</span><span class="sh">'</span><span class="p">:</span><span class="sh">"</span><span class="s">_IMPRACE_White, Non-Hispanic</span><span class="sh">"</span><span class="p">,</span> 
<span class="sh">'</span><span class="s">% Black</span><span class="sh">'</span><span class="p">:</span><span class="sh">'</span><span class="s">_IMPRACE_Black, Non-Hispanic</span><span class="sh">'</span><span class="p">,</span>
<span class="sh">'</span><span class="s">% American Indian &amp; Alaska Native</span><span class="sh">'</span><span class="p">:</span><span class="sh">'</span><span class="s">_IMPRACE_American Indian/Alaskan Native, Non-Hispanic</span><span class="sh">'</span><span class="p">,</span> 
<span class="sh">'</span><span class="s">% Asian</span><span class="sh">'</span><span class="p">:</span><span class="sh">"</span><span class="s">_IMPRACE_Asian, Non-Hispanic</span><span class="sh">"</span><span class="p">,</span>
<span class="sh">'</span><span class="s">% Native Hawaiian/Other Pacific Islander</span><span class="sh">'</span><span class="p">:</span><span class="sh">"</span><span class="s">_IMPRACE_Other race, Non-Hispanic</span><span class="sh">"</span><span class="p">,</span> 
<span class="sh">'</span><span class="s">% Hispanic</span><span class="sh">'</span><span class="p">:</span><span class="sh">"</span><span class="s">_IMPRACE_Hispanic</span><span class="sh">"</span><span class="p">}</span>
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">column_dict</span><span class="p">:</span>
    <span class="n">county_demo</span><span class="p">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">county_demo</span><span class="p">.</span><span class="n">columns</span><span class="p">.</span><span class="nb">str</span><span class="p">.</span><span class="nf">replace</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">column_dict</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">county_demo</span>
</code></pre></div></div> <div> <style scoped="">.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</style> <table border="1" class="dataframe"> <thead> <tr style="text-align: right;"> <th></th> <th>General_health</th> <th>Excessive_drinking</th> <th>High_school_grad</th> <th>College</th> <th>Unemployed</th> <th>Inactivity</th> <th>Smoker</th> <th>Health_plan</th> <th>Diabetes</th> <th>Owns_home</th> <th>Rural</th> <th>Median Household Income</th> <th>_IMPRACE_White, Non-Hispanic</th> <th>_IMPRACE_Black, Non-Hispanic</th> <th>_IMPRACE_American Indian/Alaskan Native, Non-Hispanic</th> <th>_IMPRACE_Asian, Non-Hispanic</th> <th>_IMPRACE_Other race, Non-Hispanic</th> <th>_IMPRACE_Hispanic</th> </tr> <tr> <th>FIPS</th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> </tr> </thead> <tbody> <tr> <th>47000</th> <td>0.20</td> <td>0.14</td> <td>0.90</td> <td>0.61</td> <td>0.035</td> <td>0.27</td> <td>0.23</td> <td>0.14</td> <td>0.13</td> <td>0.66</td> <td>0.336</td> <td>52366.0</td> <td>0.737</td> <td>0.167</td> <td>0.005</td> <td>0.019</td> <td>0.001</td> <td>0.056</td> </tr> <tr> <th>47001</th> <td>0.19</td> <td>0.14</td> <td>0.92</td> <td>0.58</td> <td>0.038</td> <td>0.26</td> <td>0.21</td> <td>0.13</td> <td>0.11</td> <td>0.68</td> <td>0.347</td> <td>50672.0</td> <td>0.891</td> <td>0.039</td> <td>0.005</td> <td>0.015</td> <td>0.001</td> <td>0.031</td> </tr> <tr> <th>47003</th> <td>0.22</td> <td>0.16</td> <td>0.91</td> <td>0.41</td> <td>0.037</td> <td>0.32</td> <td>0.23</td> <td>0.18</td> <td>0.11</td> <td>0.68</td> <td>0.556</td> <td>49860.0</td> <td>0.766</td> <td>0.076</td> <td>0.011</td> <td>0.011</td> <td>0.002</td> <td>0.126</td> </tr> <tr> <th>47005</th> <td>0.23</td> <td>0.12</td> <td>0.96</td> <td>0.47</td> <td>0.049</td> <td>0.29</td> <td>0.24</td> <td>0.15</td> <td>0.14</td> <td>0.76</td> <td>0.785</td> <td>38940.0</td> <td>0.925</td> <td>0.024</td> <td>0.006</td> <td>0.006</td> <td>0.000</td> <td>0.025</td> </tr> <tr> <th>47007</th> <td>0.23</td> <td>0.15</td> <td>0.85</td> <td>0.38</td> <td>0.058</td> <td>0.26</td> <td>0.25</td> <td>0.18</td> <td>0.10</td> <td>0.74</td> <td>1.000</td> <td>40195.0</td> <td>0.884</td> <td>0.071</td> <td>0.006</td> <td>0.003</td> <td>0.000</td> <td>0.025</td> </tr> <tr> <th>...</th> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> </tr> <tr> <th>47181</th> <td>0.24</td> <td>0.14</td> <td>0.96</td> <td>0.40</td> <td>0.049</td> <td>0.41</td> <td>0.25</td> <td>0.14</td> <td>0.15</td> <td>0.81</td> <td>1.000</td> <td>38879.0</td> <td>0.899</td> <td>0.063</td> <td>0.004</td> <td>0.003</td> <td>0.000</td> <td>0.021</td> </tr> <tr> <th>47183</th> <td>0.22</td> <td>0.14</td> <td>0.92</td> <td>0.56</td> <td>0.042</td> <td>0.34</td> <td>0.22</td> <td>0.12</td> <td>0.11</td> <td>0.66</td> <td>0.670</td> <td>42351.0</td> <td>0.868</td> <td>0.075</td> <td>0.004</td> <td>0.012</td> <td>0.000</td> <td>0.027</td> </tr> <tr> <th>47185</th> <td>0.25</td> <td>0.13</td> <td>0.94</td> <td>0.49</td> <td>0.037</td> <td>0.23</td> <td>0.23</td> <td>0.14</td> <td>0.22</td> <td>0.81</td> <td>0.782</td> <td>42603.0</td> <td>0.930</td> <td>0.018</td> <td>0.005</td> <td>0.004</td> <td>0.001</td> <td>0.028</td> </tr> <tr> <th>47187</th> <td>0.14</td> <td>0.16</td> <td>0.96</td> <td>0.87</td> <td>0.025</td> <td>0.18</td> <td>0.15</td> <td>0.08</td> <td>0.08</td> <td>0.81</td> <td>0.194</td> <td>115930.0</td> <td>0.843</td> <td>0.043</td> <td>0.003</td> <td>0.047</td> <td>0.001</td> <td>0.049</td> </tr> <tr> <th>47189</th> <td>0.17</td> <td>0.17</td> <td>0.96</td> <td>0.69</td> <td>0.028</td> <td>0.21</td> <td>0.18</td> <td>0.10</td> <td>0.11</td> <td>0.77</td> <td>0.385</td> <td>76507.0</td> <td>0.847</td> <td>0.071</td> <td>0.005</td> <td>0.017</td> <td>0.001</td> <td>0.045</td> </tr> </tbody> </table> <p>96 rows × 18 columns</p> </div> <p>Don’t forget, we need 1-Health Plan (% Uninsured –&gt; Health plan). All others should already be accounted for if “negative,” such as physical inactivity, unemployed, etc. i.e. TRUE for Unemployed truly means unemployed.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">county_demo</span><span class="p">[</span><span class="sh">'</span><span class="s">Health_plan</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="o">-</span> <span class="n">county_demo</span><span class="p">[</span><span class="sh">'</span><span class="s">Health_plan</span><span class="sh">'</span><span class="p">]</span>
</code></pre></div></div> <p>Now we work on income categories.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">income_categories</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">county_demo</span><span class="p">[</span><span class="sh">'</span><span class="s">Median Household Income</span><span class="sh">'</span><span class="p">]:</span>
    <span class="k">if</span> <span class="nf">float</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">10000</span><span class="p">:</span>
        <span class="n">income_categories</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="sh">'</span><span class="s">INCOME2_Less than $10,000</span><span class="sh">'</span><span class="p">)</span>
    <span class="nf">elif </span><span class="p">(</span><span class="n">i</span> <span class="o">&gt;=</span> <span class="mi">10000</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">i</span> <span class="o">&lt;</span> <span class="mi">15000</span><span class="p">):</span>
        <span class="n">income_categories</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="sh">'</span><span class="s">INCOME2_Less than $15,000 ($10,000 to less than $15,000)</span><span class="sh">'</span><span class="p">)</span>
    <span class="nf">elif </span><span class="p">(</span><span class="n">i</span> <span class="o">&gt;=</span> <span class="mi">15000</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">i</span> <span class="o">&lt;</span> <span class="mi">20000</span><span class="p">):</span>
        <span class="n">income_categories</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="sh">'</span><span class="s">INCOME2_Less than $20,000 ($15,000 to less than $20,000)</span><span class="sh">'</span><span class="p">)</span>
    <span class="nf">elif </span><span class="p">(</span><span class="n">i</span> <span class="o">&gt;=</span> <span class="mi">20000</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">i</span> <span class="o">&lt;</span> <span class="mi">25000</span><span class="p">):</span>
        <span class="n">income_categories</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="sh">'</span><span class="s">INCOME2_Less than $25,000 ($20,000 to less than $25,000)</span><span class="sh">'</span><span class="p">)</span>
    <span class="nf">elif </span><span class="p">(</span><span class="n">i</span> <span class="o">&gt;=</span> <span class="mi">25000</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">i</span> <span class="o">&lt;</span> <span class="mi">35000</span><span class="p">):</span>
        <span class="n">income_categories</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="sh">'</span><span class="s">INCOME2_Less than $35,000 ($25,000 to less than $35,000)</span><span class="sh">'</span><span class="p">)</span>
    <span class="nf">elif </span><span class="p">(</span><span class="n">i</span> <span class="o">&gt;=</span> <span class="mi">35000</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">i</span> <span class="o">&lt;</span> <span class="mi">50000</span><span class="p">):</span>
        <span class="n">income_categories</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="sh">'</span><span class="s">INCOME2_Less than $50,000 ($35,000 to less than $50,000)</span><span class="sh">'</span><span class="p">)</span>
    <span class="nf">elif </span><span class="p">(</span><span class="n">i</span> <span class="o">&gt;=</span> <span class="mi">50000</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">i</span> <span class="o">&lt;</span> <span class="mi">75000</span><span class="p">):</span>
        <span class="n">income_categories</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="sh">'</span><span class="s">INCOME2_Less than $75,000 ($50,000 to less than $75,000)</span><span class="sh">'</span><span class="p">)</span>
    <span class="nf">elif </span><span class="p">(</span><span class="n">i</span> <span class="o">&gt;=</span> <span class="mi">75000</span><span class="p">):</span>
        <span class="n">income_categories</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="sh">'</span><span class="s">INCOME2_$75,000 or more</span><span class="sh">'</span><span class="p">)</span>
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">county_demo</span><span class="p">[</span><span class="sh">'</span><span class="s">income_categories</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">income_categories</span>
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">county_demo</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nf">get_dummies</span><span class="p">(</span><span class="n">county_demo</span><span class="p">,</span> <span class="sh">'</span><span class="s">income_categories</span><span class="sh">'</span><span class="p">)</span>
<span class="n">county_demo</span> <span class="o">=</span> <span class="n">county_demo</span><span class="p">.</span><span class="nf">drop</span><span class="p">(</span><span class="sh">'</span><span class="s">Median Household Income</span><span class="sh">'</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">county_demo</span><span class="p">[</span><span class="sh">'</span><span class="s">INCOME2_Less than $25,000 ($20,000 to less than $25,000)</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">county_demo</span><span class="p">[</span><span class="sh">'</span><span class="s">INCOME2_Less than $20,000 ($15,000 to less than $20,000)</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">county_demo</span><span class="p">[</span><span class="sh">'</span><span class="s">INCOME2_Less than $15,000 ($10,000 to less than $15,000)</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">county_demo</span><span class="p">[</span><span class="sh">'</span><span class="s">INCOME2_Less than $10,000</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">county_demo</span><span class="p">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">county_demo</span><span class="p">.</span><span class="n">columns</span><span class="p">.</span><span class="nb">str</span><span class="p">.</span><span class="nf">replace</span><span class="p">(</span><span class="sh">"</span><span class="s">income_categories_</span><span class="sh">"</span><span class="p">,</span> <span class="sh">""</span><span class="p">)</span>
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">county_demo</span>
</code></pre></div></div> <div> <style scoped="">.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</style> <table border="1" class="dataframe"> <thead> <tr style="text-align: right;"> <th></th> <th>General_health</th> <th>Excessive_drinking</th> <th>High_school_grad</th> <th>College</th> <th>Unemployed</th> <th>Inactivity</th> <th>Smoker</th> <th>Health_plan</th> <th>Diabetes</th> <th>Owns_home</th> <th>...</th> <th>_IMPRACE_Other race, Non-Hispanic</th> <th>_IMPRACE_Hispanic</th> <th>INCOME2_$75,000 or more</th> <th>INCOME2_Less than $35,000 ($25,000 to less than $35,000)</th> <th>INCOME2_Less than $50,000 ($35,000 to less than $50,000)</th> <th>INCOME2_Less than $75,000 ($50,000 to less than $75,000)</th> <th>INCOME2_Less than $25,000 ($20,000 to less than $25,000)</th> <th>INCOME2_Less than $20,000 ($15,000 to less than $20,000)</th> <th>INCOME2_Less than $15,000 ($10,000 to less than $15,000)</th> <th>INCOME2_Less than $10,000</th> </tr> <tr> <th>FIPS</th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> </tr> </thead> <tbody> <tr> <th>47000</th> <td>0.20</td> <td>0.14</td> <td>0.90</td> <td>0.61</td> <td>0.035</td> <td>0.27</td> <td>0.23</td> <td>0.86</td> <td>0.13</td> <td>0.66</td> <td>...</td> <td>0.001</td> <td>0.056</td> <td>0</td> <td>0</td> <td>0</td> <td>1</td> <td>0</td> <td>0</td> <td>0</td> <td>0</td> </tr> <tr> <th>47001</th> <td>0.19</td> <td>0.14</td> <td>0.92</td> <td>0.58</td> <td>0.038</td> <td>0.26</td> <td>0.21</td> <td>0.87</td> <td>0.11</td> <td>0.68</td> <td>...</td> <td>0.001</td> <td>0.031</td> <td>0</td> <td>0</td> <td>0</td> <td>1</td> <td>0</td> <td>0</td> <td>0</td> <td>0</td> </tr> <tr> <th>47003</th> <td>0.22</td> <td>0.16</td> <td>0.91</td> <td>0.41</td> <td>0.037</td> <td>0.32</td> <td>0.23</td> <td>0.82</td> <td>0.11</td> <td>0.68</td> <td>...</td> <td>0.002</td> <td>0.126</td> <td>0</td> <td>0</td> <td>1</td> <td>0</td> <td>0</td> <td>0</td> <td>0</td> <td>0</td> </tr> <tr> <th>47005</th> <td>0.23</td> <td>0.12</td> <td>0.96</td> <td>0.47</td> <td>0.049</td> <td>0.29</td> <td>0.24</td> <td>0.85</td> <td>0.14</td> <td>0.76</td> <td>...</td> <td>0.000</td> <td>0.025</td> <td>0</td> <td>0</td> <td>1</td> <td>0</td> <td>0</td> <td>0</td> <td>0</td> <td>0</td> </tr> <tr> <th>47007</th> <td>0.23</td> <td>0.15</td> <td>0.85</td> <td>0.38</td> <td>0.058</td> <td>0.26</td> <td>0.25</td> <td>0.82</td> <td>0.10</td> <td>0.74</td> <td>...</td> <td>0.000</td> <td>0.025</td> <td>0</td> <td>0</td> <td>1</td> <td>0</td> <td>0</td> <td>0</td> <td>0</td> <td>0</td> </tr> <tr> <th>...</th> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> </tr> <tr> <th>47181</th> <td>0.24</td> <td>0.14</td> <td>0.96</td> <td>0.40</td> <td>0.049</td> <td>0.41</td> <td>0.25</td> <td>0.86</td> <td>0.15</td> <td>0.81</td> <td>...</td> <td>0.000</td> <td>0.021</td> <td>0</td> <td>0</td> <td>1</td> <td>0</td> <td>0</td> <td>0</td> <td>0</td> <td>0</td> </tr> <tr> <th>47183</th> <td>0.22</td> <td>0.14</td> <td>0.92</td> <td>0.56</td> <td>0.042</td> <td>0.34</td> <td>0.22</td> <td>0.88</td> <td>0.11</td> <td>0.66</td> <td>...</td> <td>0.000</td> <td>0.027</td> <td>0</td> <td>0</td> <td>1</td> <td>0</td> <td>0</td> <td>0</td> <td>0</td> <td>0</td> </tr> <tr> <th>47185</th> <td>0.25</td> <td>0.13</td> <td>0.94</td> <td>0.49</td> <td>0.037</td> <td>0.23</td> <td>0.23</td> <td>0.86</td> <td>0.22</td> <td>0.81</td> <td>...</td> <td>0.001</td> <td>0.028</td> <td>0</td> <td>0</td> <td>1</td> <td>0</td> <td>0</td> <td>0</td> <td>0</td> <td>0</td> </tr> <tr> <th>47187</th> <td>0.14</td> <td>0.16</td> <td>0.96</td> <td>0.87</td> <td>0.025</td> <td>0.18</td> <td>0.15</td> <td>0.92</td> <td>0.08</td> <td>0.81</td> <td>...</td> <td>0.001</td> <td>0.049</td> <td>1</td> <td>0</td> <td>0</td> <td>0</td> <td>0</td> <td>0</td> <td>0</td> <td>0</td> </tr> <tr> <th>47189</th> <td>0.17</td> <td>0.17</td> <td>0.96</td> <td>0.69</td> <td>0.028</td> <td>0.21</td> <td>0.18</td> <td>0.90</td> <td>0.11</td> <td>0.77</td> <td>...</td> <td>0.001</td> <td>0.045</td> <td>1</td> <td>0</td> <td>0</td> <td>0</td> <td>0</td> <td>0</td> <td>0</td> <td>0</td> </tr> </tbody> </table> <p>96 rows × 25 columns</p> </div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">county_pred</span> <span class="o">=</span> <span class="n">tree</span><span class="p">.</span><span class="nf">predict</span><span class="p">(</span><span class="n">county_demo</span><span class="p">)</span>

</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">county_pred_prob</span> <span class="o">=</span> <span class="n">forest</span><span class="p">.</span><span class="nf">predict_proba</span><span class="p">(</span><span class="n">county_demo</span><span class="p">)[:,</span><span class="mi">1</span><span class="p">]</span>
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">county_demo</span><span class="p">[</span><span class="sh">'</span><span class="s">predict_prob</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">county_pred_prob</span>
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">county_demo</span>
</code></pre></div></div> <div> <style scoped="">.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</style> <table border="1" class="dataframe"> <thead> <tr style="text-align: right;"> <th></th> <th>General_health</th> <th>Excessive_drinking</th> <th>High_school_grad</th> <th>College</th> <th>Unemployed</th> <th>Inactivity</th> <th>Smoker</th> <th>Health_plan</th> <th>Diabetes</th> <th>Owns_home</th> <th>...</th> <th>_IMPRACE_Hispanic</th> <th>INCOME2_$75,000 or more</th> <th>INCOME2_Less than $35,000 ($25,000 to less than $35,000)</th> <th>INCOME2_Less than $50,000 ($35,000 to less than $50,000)</th> <th>INCOME2_Less than $75,000 ($50,000 to less than $75,000)</th> <th>INCOME2_Less than $25,000 ($20,000 to less than $25,000)</th> <th>INCOME2_Less than $20,000 ($15,000 to less than $20,000)</th> <th>INCOME2_Less than $15,000 ($10,000 to less than $15,000)</th> <th>INCOME2_Less than $10,000</th> <th>predict_prob</th> </tr> <tr> <th>FIPS</th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> </tr> </thead> <tbody> <tr> <th>47000</th> <td>0.20</td> <td>0.14</td> <td>0.90</td> <td>0.61</td> <td>0.035</td> <td>0.27</td> <td>0.23</td> <td>0.86</td> <td>0.13</td> <td>0.66</td> <td>...</td> <td>0.056</td> <td>0</td> <td>0</td> <td>0</td> <td>1</td> <td>0</td> <td>0</td> <td>0</td> <td>0</td> <td>0.640059</td> </tr> <tr> <th>47001</th> <td>0.19</td> <td>0.14</td> <td>0.92</td> <td>0.58</td> <td>0.038</td> <td>0.26</td> <td>0.21</td> <td>0.87</td> <td>0.11</td> <td>0.68</td> <td>...</td> <td>0.031</td> <td>0</td> <td>0</td> <td>0</td> <td>1</td> <td>0</td> <td>0</td> <td>0</td> <td>0</td> <td>0.640059</td> </tr> <tr> <th>47003</th> <td>0.22</td> <td>0.16</td> <td>0.91</td> <td>0.41</td> <td>0.037</td> <td>0.32</td> <td>0.23</td> <td>0.82</td> <td>0.11</td> <td>0.68</td> <td>...</td> <td>0.126</td> <td>0</td> <td>0</td> <td>1</td> <td>0</td> <td>0</td> <td>0</td> <td>0</td> <td>0</td> <td>0.687877</td> </tr> <tr> <th>47005</th> <td>0.23</td> <td>0.12</td> <td>0.96</td> <td>0.47</td> <td>0.049</td> <td>0.29</td> <td>0.24</td> <td>0.85</td> <td>0.14</td> <td>0.76</td> <td>...</td> <td>0.025</td> <td>0</td> <td>0</td> <td>1</td> <td>0</td> <td>0</td> <td>0</td> <td>0</td> <td>0</td> <td>0.687877</td> </tr> <tr> <th>47007</th> <td>0.23</td> <td>0.15</td> <td>0.85</td> <td>0.38</td> <td>0.058</td> <td>0.26</td> <td>0.25</td> <td>0.82</td> <td>0.10</td> <td>0.74</td> <td>...</td> <td>0.025</td> <td>0</td> <td>0</td> <td>1</td> <td>0</td> <td>0</td> <td>0</td> <td>0</td> <td>0</td> <td>0.687877</td> </tr> <tr> <th>...</th> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> </tr> <tr> <th>47181</th> <td>0.24</td> <td>0.14</td> <td>0.96</td> <td>0.40</td> <td>0.049</td> <td>0.41</td> <td>0.25</td> <td>0.86</td> <td>0.15</td> <td>0.81</td> <td>...</td> <td>0.021</td> <td>0</td> <td>0</td> <td>1</td> <td>0</td> <td>0</td> <td>0</td> <td>0</td> <td>0</td> <td>0.687877</td> </tr> <tr> <th>47183</th> <td>0.22</td> <td>0.14</td> <td>0.92</td> <td>0.56</td> <td>0.042</td> <td>0.34</td> <td>0.22</td> <td>0.88</td> <td>0.11</td> <td>0.66</td> <td>...</td> <td>0.027</td> <td>0</td> <td>0</td> <td>1</td> <td>0</td> <td>0</td> <td>0</td> <td>0</td> <td>0</td> <td>0.667665</td> </tr> <tr> <th>47185</th> <td>0.25</td> <td>0.13</td> <td>0.94</td> <td>0.49</td> <td>0.037</td> <td>0.23</td> <td>0.23</td> <td>0.86</td> <td>0.22</td> <td>0.81</td> <td>...</td> <td>0.028</td> <td>0</td> <td>0</td> <td>1</td> <td>0</td> <td>0</td> <td>0</td> <td>0</td> <td>0</td> <td>0.687877</td> </tr> <tr> <th>47187</th> <td>0.14</td> <td>0.16</td> <td>0.96</td> <td>0.87</td> <td>0.025</td> <td>0.18</td> <td>0.15</td> <td>0.92</td> <td>0.08</td> <td>0.81</td> <td>...</td> <td>0.049</td> <td>1</td> <td>0</td> <td>0</td> <td>0</td> <td>0</td> <td>0</td> <td>0</td> <td>0</td> <td>0.812499</td> </tr> <tr> <th>47189</th> <td>0.17</td> <td>0.17</td> <td>0.96</td> <td>0.69</td> <td>0.028</td> <td>0.21</td> <td>0.18</td> <td>0.90</td> <td>0.11</td> <td>0.77</td> <td>...</td> <td>0.045</td> <td>1</td> <td>0</td> <td>0</td> <td>0</td> <td>0</td> <td>0</td> <td>0</td> <td>0</td> <td>0.812499</td> </tr> </tbody> </table> <p>96 rows × 26 columns</p> </div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">disparities</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nf">read_csv</span><span class="p">(</span><span class="sh">'</span><span class="s">../data/disparities.csv</span><span class="sh">'</span><span class="p">,</span> <span class="n">header</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">index_col</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">disparities</span><span class="p">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">disparities</span><span class="p">.</span><span class="n">FIPS</span>
<span class="n">disparities</span>
</code></pre></div></div> <div> <style scoped="">.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</style> <table border="1" class="dataframe"> <thead> <tr style="text-align: right;"> <th></th> <th>FIPS</th> <th>year</th> <th>primary_sex</th> <th>primary_age</th> <th>primary_dual</th> <th>state</th> <th>primary_race</th> <th>primary_eligibility</th> <th>primary_denominator_well</th> <th>analysis_value_well</th> <th>...</th> <th>county</th> <th>primary_care_physicians</th> <th>population</th> <th>urban</th> <th>shadac_category</th> <th>pcp_per_100k</th> <th>num_hospitals</th> <th>num_hospitals_open</th> <th>mean_beds</th> <th>num_beds</th> </tr> <tr> <th>FIPS</th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> </tr> </thead> <tbody> <tr> <th>47033</th> <td>47033</td> <td>2019</td> <td>All</td> <td>All</td> <td>Dual &amp; non-dual</td> <td>TENNESSEE</td> <td>All</td> <td>All</td> <td>1,000-4,999</td> <td>25</td> <td>...</td> <td>Crockett</td> <td>0.0</td> <td>14399</td> <td>Rural</td> <td>low inadequate</td> <td>0.000000</td> <td>0.0</td> <td>0.0</td> <td>NaN</td> <td>0.0</td> </tr> <tr> <th>47061</th> <td>47061</td> <td>2019</td> <td>All</td> <td>All</td> <td>Dual &amp; non-dual</td> <td>TENNESSEE</td> <td>All</td> <td>All</td> <td>1,000-4,999</td> <td>34</td> <td>...</td> <td>Grundy</td> <td>0.0</td> <td>13344</td> <td>Rural</td> <td>low inadequate</td> <td>0.000000</td> <td>0.0</td> <td>0.0</td> <td>NaN</td> <td>0.0</td> </tr> <tr> <th>47095</th> <td>47095</td> <td>2019</td> <td>All</td> <td>All</td> <td>Dual &amp; non-dual</td> <td>TENNESSEE</td> <td>All</td> <td>All</td> <td>500-999</td> <td>20</td> <td>...</td> <td>Lake</td> <td>0.0</td> <td>7401</td> <td>Rural</td> <td>low inadequate</td> <td>0.000000</td> <td>0.0</td> <td>0.0</td> <td>NaN</td> <td>0.0</td> </tr> <tr> <th>47175</th> <td>47175</td> <td>2019</td> <td>All</td> <td>All</td> <td>Dual &amp; non-dual</td> <td>TENNESSEE</td> <td>All</td> <td>All</td> <td>500-999</td> <td>31</td> <td>...</td> <td>Van Buren</td> <td>0.0</td> <td>5760</td> <td>Rural</td> <td>low inadequate</td> <td>0.000000</td> <td>0.0</td> <td>0.0</td> <td>NaN</td> <td>0.0</td> </tr> <tr> <th>47007</th> <td>47007</td> <td>2019</td> <td>All</td> <td>All</td> <td>Dual &amp; non-dual</td> <td>TENNESSEE</td> <td>All</td> <td>All</td> <td>1,000-4,999</td> <td>19</td> <td>...</td> <td>Bledsoe</td> <td>1.0</td> <td>14836</td> <td>Rural</td> <td>low inadequate</td> <td>6.740361</td> <td>1.0</td> <td>1.0</td> <td>25.000000</td> <td>25.0</td> </tr> <tr> <th>...</th> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> </tr> <tr> <th>47093</th> <td>47093</td> <td>2019</td> <td>All</td> <td>All</td> <td>Dual &amp; non-dual</td> <td>TENNESSEE</td> <td>All</td> <td>All</td> <td>10,000+</td> <td>56</td> <td>...</td> <td>Knox</td> <td>520.0</td> <td>461104</td> <td>Urban</td> <td>adequate</td> <td>112.772823</td> <td>11.0</td> <td>10.0</td> <td>306.600000</td> <td>3066.0</td> </tr> <tr> <th>47163</th> <td>47163</td> <td>2019</td> <td>All</td> <td>All</td> <td>Dual &amp; non-dual</td> <td>TENNESSEE</td> <td>All</td> <td>All</td> <td>10,000+</td> <td>52</td> <td>...</td> <td>Sullivan</td> <td>199.0</td> <td>157050</td> <td>Urban</td> <td>adequate</td> <td>126.711238</td> <td>5.0</td> <td>5.0</td> <td>235.000000</td> <td>1175.0</td> </tr> <tr> <th>47113</th> <td>47113</td> <td>2019</td> <td>All</td> <td>All</td> <td>Dual &amp; non-dual</td> <td>TENNESSEE</td> <td>All</td> <td>All</td> <td>10,000+</td> <td>43</td> <td>...</td> <td>Madison</td> <td>129.0</td> <td>97625</td> <td>Urban</td> <td>adequate</td> <td>132.138284</td> <td>3.0</td> <td>3.0</td> <td>330.666667</td> <td>992.0</td> </tr> <tr> <th>47187</th> <td>47187</td> <td>2019</td> <td>All</td> <td>All</td> <td>Dual &amp; non-dual</td> <td>TENNESSEE</td> <td>All</td> <td>All</td> <td>10,000+</td> <td>48</td> <td>...</td> <td>Williamson</td> <td>338.0</td> <td>225389</td> <td>Urban</td> <td>adequate</td> <td>149.962953</td> <td>2.0</td> <td>2.0</td> <td>112.500000</td> <td>225.0</td> </tr> <tr> <th>47179</th> <td>47179</td> <td>2019</td> <td>All</td> <td>All</td> <td>Dual &amp; non-dual</td> <td>TENNESSEE</td> <td>All</td> <td>All</td> <td>10,000+</td> <td>57</td> <td>...</td> <td>Washington</td> <td>226.0</td> <td>127805</td> <td>Urban</td> <td>adequate</td> <td>176.831892</td> <td>7.0</td> <td>6.0</td> <td>167.000000</td> <td>1002.0</td> </tr> </tbody> </table> <p>95 rows × 30 columns</p> </div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">full_df</span> <span class="o">=</span> <span class="n">disparities</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="n">county_demo</span><span class="p">,</span> <span class="n">lsuffix</span> <span class="o">=</span> <span class="sh">'</span><span class="s">disp</span><span class="sh">'</span><span class="p">,</span> <span class="n">rsuffix</span> <span class="o">=</span> <span class="sh">'</span><span class="s">demo</span><span class="sh">'</span><span class="p">)</span>
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">full_df</span><span class="p">.</span><span class="nf">sort_values</span><span class="p">(</span><span class="sh">'</span><span class="s">predict_prob</span><span class="sh">'</span><span class="p">)[[</span><span class="sh">'</span><span class="s">county</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">predict_prob</span><span class="sh">'</span><span class="p">]]</span>
</code></pre></div></div> <div> <style scoped="">.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</style> <table border="1" class="dataframe"> <thead> <tr style="text-align: right;"> <th></th> <th>county</th> <th>predict_prob</th> </tr> <tr> <th>FIPS</th> <th></th> <th></th> </tr> </thead> <tbody> <tr> <th>47027</th> <td>Clay</td> <td>0.615584</td> </tr> <tr> <th>47095</th> <td>Lake</td> <td>0.615584</td> </tr> <tr> <th>47067</th> <td>Hancock</td> <td>0.615584</td> </tr> <tr> <th>47149</th> <td>Rutherford</td> <td>0.640059</td> </tr> <tr> <th>47125</th> <td>Montgomery</td> <td>0.640059</td> </tr> <tr> <th>...</th> <td>...</td> <td>...</td> </tr> <tr> <th>47091</th> <td>Johnson</td> <td>0.687877</td> </tr> <tr> <th>47055</th> <td>Giles</td> <td>0.687877</td> </tr> <tr> <th>47075</th> <td>Haywood</td> <td>0.692379</td> </tr> <tr> <th>47189</th> <td>Wilson</td> <td>0.812499</td> </tr> <tr> <th>47187</th> <td>Williamson</td> <td>0.812499</td> </tr> </tbody> </table> <p>95 rows × 2 columns</p> </div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">full_df</span><span class="p">.</span><span class="n">columns</span>
</code></pre></div></div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Index(['FIPS', 'year', 'primary_sex', 'primary_age', 'primary_dual', 'state',
       'primary_race', 'primary_eligibility', 'primary_denominator_well',
       'analysis_value_well', 'primary_denominator_hosp',
       'analysis_value_hosp', 'primary_denominator_emer',
       'analysis_value_emer', 'laus_code', 'Name', 'Employed',
       'Unemployeddisp', 'unemployment_rate', 'FIPS.1', 'county',
       'primary_care_physicians', 'population', 'urban', 'shadac_category',
       'pcp_per_100k', 'num_hospitals', 'num_hospitals_open', 'mean_beds',
       'num_beds', 'General_health', 'Excessive_drinking', 'High_school_grad',
       'College', 'Unemployeddemo', 'Inactivity', 'Smoker', 'Health_plan',
       'Diabetes', 'Owns_home', 'Rural', '_IMPRACE_White, Non-Hispanic',
       '_IMPRACE_Black, Non-Hispanic',
       '_IMPRACE_American Indian/Alaskan Native, Non-Hispanic',
       '_IMPRACE_Asian, Non-Hispanic', '_IMPRACE_Other race, Non-Hispanic',
       '_IMPRACE_Hispanic', 'INCOME2_$75,000 or more',
       'INCOME2_Less than $35,000 ($25,000 to less than $35,000)',
       'INCOME2_Less than $50,000 ($35,000 to less than $50,000)',
       'INCOME2_Less than $75,000 ($50,000 to less than $75,000)',
       'INCOME2_Less than $25,000 ($20,000 to less than $25,000)',
       'INCOME2_Less than $20,000 ($15,000 to less than $20,000)',
       'INCOME2_Less than $15,000 ($10,000 to less than $15,000)',
       'INCOME2_Less than $10,000', 'predict_prob'],
      dtype='object')
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sns</span><span class="p">.</span><span class="nf">scatterplot</span><span class="p">(</span><span class="n">full_df</span><span class="p">[</span><span class="sh">'</span><span class="s">Health_plan</span><span class="sh">'</span><span class="p">]</span> <span class="p">,</span> <span class="n">full_df</span><span class="p">.</span><span class="n">predict_prob</span><span class="p">)</span>
</code></pre></div></div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/Users/smgroves/Documents/anaconda3/envs/geo_dse/lib/python3.9/site-packages/seaborn/_decorators.py:36: FutureWarning: Pass the following variables as keyword args: x, y. From version 0.12, the only valid positional argument will be `data`, and passing other arguments without an explicit keyword will result in an error or misinterpretation.
  warnings.warn(





&lt;AxesSubplot:xlabel='Health_plan', ylabel='predict_prob'&gt;
</code></pre></div></div> <div class="img"> <img src="/assets/img/bb/data-science-project/output_283_2.png" style="height: 100%; width: 100%; object-fit: contain"> </div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">(</span><span class="n">county_demo</span><span class="p">).</span><span class="nf">plot</span><span class="p">(</span><span class="n">kind</span> <span class="o">=</span> <span class="sh">'</span><span class="s">box</span><span class="sh">'</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">xticks</span><span class="p">(</span><span class="n">rotation</span> <span class="o">=</span> <span class="mi">90</span><span class="p">)</span>
</code></pre></div></div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(array([ 1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
        18, 19, 20, 21, 22, 23, 24, 25, 26]),
 [Text(1, 0, 'General_health'),
  Text(2, 0, 'Excessive_drinking'),
  Text(3, 0, 'High_school_grad'),
  Text(4, 0, 'College'),
  Text(5, 0, 'Unemployed'),
  Text(6, 0, 'Inactivity'),
  Text(7, 0, 'Smoker'),
  Text(8, 0, 'Health_plan'),
  Text(9, 0, 'Diabetes'),
  Text(10, 0, 'Owns_home'),
  Text(11, 0, 'Rural'),
  Text(12, 0, '_IMPRACE_White, Non-Hispanic'),
  Text(13, 0, '_IMPRACE_Black, Non-Hispanic'),
  Text(14, 0, '_IMPRACE_American Indian/Alaskan Native, Non-Hispanic'),
  Text(15, 0, '_IMPRACE_Asian, Non-Hispanic'),
  Text(16, 0, '_IMPRACE_Other race, Non-Hispanic'),
  Text(17, 0, '_IMPRACE_Hispanic'),
  Text(18, 0, 'INCOME2_$75,000 or more'),
  Text(19, 0, 'INCOME2_Less than $35,000 ($25,000 to less than $35,000)'),
  Text(20, 0, 'INCOME2_Less than $50,000 ($35,000 to less than $50,000)'),
  Text(21, 0, 'INCOME2_Less than $75,000 ($50,000 to less than $75,000)'),
  Text(22, 0, 'INCOME2_Less than $25,000 ($20,000 to less than $25,000)'),
  Text(23, 0, 'INCOME2_Less than $20,000 ($15,000 to less than $20,000)'),
  Text(24, 0, 'INCOME2_Less than $15,000 ($10,000 to less than $15,000)'),
  Text(25, 0, 'INCOME2_Less than $10,000'),
  Text(26, 0, 'predict_prob')])
</code></pre></div></div> <div class="img"> <img src="/assets/img/bb/data-science-project/output_284_1.png" style="height: 100%; width: 100%; object-fit: contain"> </div> <h2 id="which-groups-within-these-counties-might-need-to-be-focused-on-to-maximize-the-impact-of-tn-med-helpers-efforts">Which groups within these counties might need to be focused on to maximize the impact of TN Med Helper’s efforts?</h2> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">counties</span> <span class="o">=</span> <span class="n">gpd</span><span class="p">.</span><span class="nf">read_file</span><span class="p">(</span><span class="sh">'</span><span class="s">../data/county/tncounty.shp</span><span class="sh">'</span><span class="p">)</span>
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">counties</span>
</code></pre></div></div> <div> <style scoped="">.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</style> <table border="1" class="dataframe"> <thead> <tr style="text-align: right;"> <th></th> <th>OBJECTID</th> <th>NAME</th> <th>KEY</th> <th>SHAPE_AREA</th> <th>SHAPE_LEN</th> <th>geometry</th> </tr> </thead> <tbody> <tr> <th>0</th> <td>76</td> <td>Chester</td> <td>47023</td> <td>8.049024e+09</td> <td>520461.080124</td> <td>POLYGON ((1137985.762 344601.643, 1137965.070 ...</td> </tr> <tr> <th>1</th> <td>77</td> <td>Wayne</td> <td>47181</td> <td>2.050741e+10</td> <td>666520.678598</td> <td>POLYGON ((1365052.057 391716.806, 1365746.554 ...</td> </tr> <tr> <th>2</th> <td>78</td> <td>Tipton</td> <td>47167</td> <td>1.319125e+10</td> <td>865093.887634</td> <td>MULTIPOLYGON (((886814.330 400456.525, 886774....</td> </tr> <tr> <th>3</th> <td>79</td> <td>Hamilton</td> <td>47065</td> <td>1.604776e+10</td> <td>652926.001078</td> <td>POLYGON ((2274954.438 239788.911, 2274090.610 ...</td> </tr> <tr> <th>4</th> <td>80</td> <td>Stewart</td> <td>47161</td> <td>1.375003e+10</td> <td>490090.336180</td> <td>POLYGON ((1382472.783 743972.302, 1382445.171 ...</td> </tr> <tr> <th>...</th> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> <td>...</td> </tr> <tr> <th>90</th> <td>91</td> <td>McNairy</td> <td>47109</td> <td>1.563586e+10</td> <td>566369.132062</td> <td>POLYGON ((1137985.762 344601.643, 1139350.519 ...</td> </tr> <tr> <th>91</th> <td>92</td> <td>Franklin</td> <td>47051</td> <td>1.605093e+10</td> <td>621176.096919</td> <td>POLYGON ((1873015.265 239618.144, 1872957.848 ...</td> </tr> <tr> <th>92</th> <td>93</td> <td>Bradley</td> <td>47011</td> <td>9.241234e+09</td> <td>457372.233476</td> <td>POLYGON ((2274954.438 239788.911, 2275552.803 ...</td> </tr> <tr> <th>93</th> <td>94</td> <td>Marion</td> <td>47115</td> <td>1.428734e+10</td> <td>529431.591556</td> <td>POLYGON ((2126056.390 236919.771, 2122873.509 ...</td> </tr> <tr> <th>94</th> <td>95</td> <td>Polk</td> <td>47139</td> <td>1.233228e+10</td> <td>479994.126988</td> <td>POLYGON ((2355580.184 332970.851, 2355673.384 ...</td> </tr> </tbody> </table> <p>95 rows × 6 columns</p> </div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">full_df</span><span class="p">.</span><span class="n">county</span>
</code></pre></div></div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>FIPS
47033      Crockett
47061        Grundy
47095          Lake
47175     Van Buren
47007       Bledsoe
            ...    
47093          Knox
47163      Sullivan
47113       Madison
47187    Williamson
47179    Washington
Name: county, Length: 95, dtype: object
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">counties</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nf">merge</span><span class="p">(</span><span class="n">left</span> <span class="o">=</span> <span class="n">counties</span><span class="p">,</span><span class="n">left_on</span> <span class="o">=</span> <span class="sh">'</span><span class="s">NAME</span><span class="sh">'</span><span class="p">,</span>
                    <span class="n">right</span> <span class="o">=</span> <span class="n">full_df</span><span class="p">[[</span><span class="sh">'</span><span class="s">county</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">predict_prob</span><span class="sh">'</span><span class="p">]],</span> <span class="n">right_on</span> <span class="o">=</span> <span class="sh">'</span><span class="s">county</span><span class="sh">'</span><span class="p">)</span>
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">counties</span><span class="p">[</span><span class="sh">'</span><span class="s">no_checkup</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="o">-</span> <span class="n">counties</span><span class="p">.</span><span class="n">predict_prob</span>
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">matplotlib.lines</span> <span class="kn">import</span> <span class="n">Line2D</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>

<span class="n">counties</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">column</span> <span class="o">=</span> <span class="sh">'</span><span class="s">no_checkup</span><span class="sh">'</span><span class="p">,</span> 
              <span class="n">edgecolor</span> <span class="o">=</span> <span class="sh">'</span><span class="s">black</span><span class="sh">'</span><span class="p">,</span>
              <span class="n">legend</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span>
              <span class="n">cmap</span> <span class="o">=</span> <span class="sh">'</span><span class="s">viridis</span><span class="sh">'</span><span class="p">,</span>
              <span class="c1"># scheme="NaturalBreaks",
</span>              <span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span><span class="p">)</span>



<span class="c1"># Adjust the marker appearance
# Extract the old markers and then modify by setting the edgecolor and edgewidth
# markers = []
# for line in leg.get_lines():
#     marker = Line2D([0],[0], marker = 'o', 
#                     markersize = line.get_markersize(), 
#                     color = line.get_markerfacecolor(),
#                     linestyle = 'None',
#                     markeredgecolor = 'black',
#                     markeredgewidth = 1)
#     markers.append(marker)
</span>
<span class="c1"># Redraw the legend with the new labels and markers
</span><span class="n">plt</span><span class="p">.</span><span class="nf">legend</span><span class="p">(</span><span class="n">markers</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">leg</span> <span class="o">=</span> <span class="n">ax</span><span class="p">.</span><span class="nf">get_legend</span><span class="p">()</span>
<span class="n">leg</span><span class="p">.</span><span class="nf">set_bbox_to_anchor</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">))</span>
    
<span class="n">plt</span><span class="p">.</span><span class="nf">title</span><span class="p">(</span><span class="sh">'</span><span class="s">Predicted No Checkup in the Last Year for Average Resident</span><span class="sh">'</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">18</span><span class="p">)</span>

<span class="n">ax</span><span class="p">.</span><span class="nf">axis</span><span class="p">(</span><span class="sh">'</span><span class="s">off</span><span class="sh">'</span><span class="p">);</span>
</code></pre></div></div> <div class="img"> <img src="/assets/img/bb/data-science-project/output_292_0.png" style="height: 100%; width: 100%; object-fit: contain"> </div> </article> </div> </div> <footer class="fixed-bottom"> <div class="container mt-0"> © Copyright 2025 Sarah M. Groves. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="noopener noreferrer">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" target="_blank" rel="noopener noreferrer">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="noopener noreferrer">GitHub Pages</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js" integrity="sha256-EdPgYcPk/IIrw7FYeuJQexva49pVRZNmt3LculEr7zM=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js"></script> <script defer src="/assets/js/common.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> </body> </html>